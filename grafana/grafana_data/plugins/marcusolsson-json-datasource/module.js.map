{"version":3,"file":"module.js","mappings":"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","sources":["webpack:///../node_modules/dayjs/dayjs.min.js","webpack:///../node_modules/jsonata/jsonata.js","webpack:///../node_modules/lodash/_Symbol.js","webpack:///../node_modules/lodash/_apply.js","webpack:///../node_modules/lodash/_arrayLikeKeys.js","webpack:///../node_modules/lodash/_baseGetTag.js","webpack:///../node_modules/lodash/_baseIsArguments.js","webpack:///../node_modules/lodash/_baseIsNative.js","webpack:///../node_modules/lodash/_baseIsTypedArray.js","webpack:///../node_modules/lodash/_baseKeysIn.js","webpack:///../node_modules/lodash/_baseRest.js","webpack:///../node_modules/lodash/_baseSetToString.js","webpack:///../node_modules/lodash/_baseTimes.js","webpack:///../node_modules/lodash/_baseUnary.js","webpack:///../node_modules/lodash/_coreJsData.js","webpack:///../node_modules/lodash/_defineProperty.js","webpack:///../node_modules/lodash/_freeGlobal.js","webpack:///../node_modules/lodash/_getNative.js","webpack:///../node_modules/lodash/_getRawTag.js","webpack:///../node_modules/lodash/_getValue.js","webpack:///../node_modules/lodash/_isIndex.js","webpack:///../node_modules/lodash/_isIterateeCall.js","webpack:///../node_modules/lodash/_isMasked.js","webpack:///../node_modules/lodash/_isPrototype.js","webpack:///../node_modules/lodash/_nativeKeysIn.js","webpack:///../node_modules/lodash/_nodeUtil.js","webpack:///../node_modules/lodash/_objectToString.js","webpack:///../node_modules/lodash/_overRest.js","webpack:///../node_modules/lodash/_root.js","webpack:///../node_modules/lodash/_setToString.js","webpack:///../node_modules/lodash/_shortOut.js","webpack:///../node_modules/lodash/_toSource.js","webpack:///../node_modules/lodash/constant.js","webpack:///../node_modules/lodash/defaults.js","webpack:///../node_modules/lodash/eq.js","webpack:///../node_modules/lodash/identity.js","webpack:///../node_modules/lodash/isArguments.js","webpack:///../node_modules/lodash/isArray.js","webpack:///../node_modules/lodash/isArrayLike.js","webpack:///../node_modules/lodash/isBuffer.js","webpack:///../node_modules/lodash/isFunction.js","webpack:///../node_modules/lodash/isLength.js","webpack:///../node_modules/lodash/isObject.js","webpack:///../node_modules/lodash/isObjectLike.js","webpack:///../node_modules/lodash/isTypedArray.js","webpack:///../node_modules/lodash/keysIn.js","webpack:///../node_modules/lodash/stubFalse.js","webpack:///../node_modules/memory-cache/index.js","webpack:///external amd \"@emotion/css\"","webpack:///external amd \"@grafana/data\"","webpack:///external amd \"@grafana/runtime\"","webpack:///external amd \"@grafana/ui\"","webpack:///external amd \"lodash\"","webpack:///external amd \"moment\"","webpack:///external amd \"react\"","webpack:///webpack/bootstrap","webpack:///webpack/runtime/compat get default export","webpack:///webpack/runtime/define property getters","webpack:///webpack/runtime/global","webpack:///webpack/runtime/hasOwnProperty shorthand","webpack:///webpack/runtime/make namespace object","webpack:///webpack/runtime/node module decorator","webpack:///../node_modules/@grafana/experimental/dist/esm/ConfigEditor/DataSourceDescription.js","webpack:///../node_modules/@grafana/experimental/dist/esm/ConfigEditor/ConfigSection/GenericConfigSection.js","webpack:///../node_modules/@grafana/experimental/dist/esm/ConfigEditor/ConfigSection/ConfigSection.js","webpack:///../node_modules/@grafana/experimental/dist/esm/ConfigEditor/Connection/ConnectionSettings.js","webpack:///../node_modules/@grafana/experimental/dist/esm/ConfigEditor/Auth/common/SecretInput.js","webpack:///../node_modules/@grafana/experimental/dist/esm/ConfigEditor/Auth/styles.js","webpack:///../node_modules/@grafana/experimental/dist/esm/ConfigEditor/Auth/auth-method/BasicAuth.js","webpack:///../node_modules/@grafana/experimental/dist/esm/ConfigEditor/ConfigSection/ConfigSubSection.js","webpack:///../node_modules/@grafana/experimental/dist/esm/ConfigEditor/Auth/types.js","webpack:///../node_modules/@grafana/experimental/dist/esm/ConfigEditor/Auth/auth-method/AuthMethodSettings.js","webpack:///../node_modules/@grafana/experimental/dist/esm/ConfigEditor/Auth/common/SecretTextarea.js","webpack:///../node_modules/@grafana/experimental/dist/esm/ConfigEditor/Auth/tls/TLSSettingsSection.js","webpack:///../node_modules/@grafana/experimental/dist/esm/ConfigEditor/Auth/tls/SelfSignedCertificate.js","webpack:///../node_modules/@grafana/experimental/dist/esm/ConfigEditor/Auth/tls/TLSClientAuth.js","webpack:///../node_modules/@grafana/experimental/dist/esm/ConfigEditor/Auth/tls/SkipTLSVerification.js","webpack:///../node_modules/@grafana/experimental/dist/esm/ConfigEditor/Auth/tls/TLSSettings.js","webpack:///../node_modules/@grafana/experimental/dist/esm/ConfigEditor/Auth/custom-headers/CustomHeader.js","webpack:///../node_modules/@grafana/experimental/dist/esm/ConfigEditor/Auth/custom-headers/CustomHeaders.js","webpack:///../node_modules/@grafana/experimental/dist/esm/ConfigEditor/Auth/Auth.js","webpack:///../node_modules/@grafana/experimental/dist/esm/ConfigEditor/Auth/utils.js","webpack:///../node_modules/@grafana/experimental/dist/esm/ConfigEditor/AdvancedSettings/AdvancedHttpSettings.js","webpack:///./components/Divider.tsx","webpack:///./components/ConfigEditor.tsx","webpack:///../node_modules/jsonpath-plus/dist/index-browser-esm.js","webpack:///./components/ExperimentalEditor.tsx","webpack:///./components/JsonataQueryField.tsx","webpack:///./jsonpath.ts","webpack:///./suggestions.ts","webpack:///./components/JsonPathQueryField.tsx","webpack:///./components/FieldEditor.tsx","webpack:///../node_modules/react-virtualized-auto-sizer/dist/react-virtualized-auto-sizer.esm.js","webpack:///./types.ts","webpack:///./components/KeyValueEditor.tsx","webpack:///./components/PathEditor.tsx","webpack:///./components/TabbedQueryEditor.tsx","webpack:///./components/QueryEditor.tsx","webpack:///./api.ts","webpack:///./detectFieldType.ts","webpack:///./datasource.ts","webpack:///./tracking.ts","webpack:///./parseValues.ts","webpack:///./module.ts","webpack:///./components/VariableQueryEditor.tsx"],"sourcesContent":["!function(t,e){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=e():\"function\"==typeof define&&define.amd?define(e):(t=\"undefined\"!=typeof globalThis?globalThis:t||self).dayjs=e()}(this,(function(){\"use strict\";var t=1e3,e=6e4,n=36e5,r=\"millisecond\",i=\"second\",s=\"minute\",u=\"hour\",a=\"day\",o=\"week\",c=\"month\",f=\"quarter\",h=\"year\",d=\"date\",l=\"Invalid Date\",$=/^(\\d{4})[-/]?(\\d{1,2})?[-/]?(\\d{0,2})[Tt\\s]*(\\d{1,2})?:?(\\d{1,2})?:?(\\d{1,2})?[.:]?(\\d+)?$/,y=/\\[([^\\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,M={name:\"en\",weekdays:\"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday\".split(\"_\"),months:\"January_February_March_April_May_June_July_August_September_October_November_December\".split(\"_\"),ordinal:function(t){var e=[\"th\",\"st\",\"nd\",\"rd\"],n=t%100;return\"[\"+t+(e[(n-20)%10]||e[n]||e[0])+\"]\"}},m=function(t,e,n){var r=String(t);return!r||r.length>=e?t:\"\"+Array(e+1-r.length).join(n)+t},v={s:m,z:function(t){var e=-t.utcOffset(),n=Math.abs(e),r=Math.floor(n/60),i=n%60;return(e<=0?\"+\":\"-\")+m(r,2,\"0\")+\":\"+m(i,2,\"0\")},m:function t(e,n){if(e.date()<n.date())return-t(n,e);var r=12*(n.year()-e.year())+(n.month()-e.month()),i=e.clone().add(r,c),s=n-i<0,u=e.clone().add(r+(s?-1:1),c);return+(-(r+(n-i)/(s?i-u:u-i))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(t){return{M:c,y:h,w:o,d:a,D:d,h:u,m:s,s:i,ms:r,Q:f}[t]||String(t||\"\").toLowerCase().replace(/s$/,\"\")},u:function(t){return void 0===t}},g=\"en\",D={};D[g]=M;var p=\"$isDayjsObject\",S=function(t){return t instanceof _||!(!t||!t[p])},w=function t(e,n,r){var i;if(!e)return g;if(\"string\"==typeof e){var s=e.toLowerCase();D[s]&&(i=s),n&&(D[s]=n,i=s);var u=e.split(\"-\");if(!i&&u.length>1)return t(u[0])}else{var a=e.name;D[a]=e,i=a}return!r&&i&&(g=i),i||!r&&g},O=function(t,e){if(S(t))return t.clone();var n=\"object\"==typeof e?e:{};return n.date=t,n.args=arguments,new _(n)},b=v;b.l=w,b.i=S,b.w=function(t,e){return O(t,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})};var _=function(){function M(t){this.$L=w(t.locale,null,!0),this.parse(t),this.$x=this.$x||t.x||{},this[p]=!0}var m=M.prototype;return m.parse=function(t){this.$d=function(t){var e=t.date,n=t.utc;if(null===e)return new Date(NaN);if(b.u(e))return new Date;if(e instanceof Date)return new Date(e);if(\"string\"==typeof e&&!/Z$/i.test(e)){var r=e.match($);if(r){var i=r[2]-1||0,s=(r[7]||\"0\").substring(0,3);return n?new Date(Date.UTC(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,s)):new Date(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,s)}}return new Date(e)}(t),this.init()},m.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},m.$utils=function(){return b},m.isValid=function(){return!(this.$d.toString()===l)},m.isSame=function(t,e){var n=O(t);return this.startOf(e)<=n&&n<=this.endOf(e)},m.isAfter=function(t,e){return O(t)<this.startOf(e)},m.isBefore=function(t,e){return this.endOf(e)<O(t)},m.$g=function(t,e,n){return b.u(t)?this[e]:this.set(n,t)},m.unix=function(){return Math.floor(this.valueOf()/1e3)},m.valueOf=function(){return this.$d.getTime()},m.startOf=function(t,e){var n=this,r=!!b.u(e)||e,f=b.p(t),l=function(t,e){var i=b.w(n.$u?Date.UTC(n.$y,e,t):new Date(n.$y,e,t),n);return r?i:i.endOf(a)},$=function(t,e){return b.w(n.toDate()[t].apply(n.toDate(\"s\"),(r?[0,0,0,0]:[23,59,59,999]).slice(e)),n)},y=this.$W,M=this.$M,m=this.$D,v=\"set\"+(this.$u?\"UTC\":\"\");switch(f){case h:return r?l(1,0):l(31,11);case c:return r?l(1,M):l(0,M+1);case o:var g=this.$locale().weekStart||0,D=(y<g?y+7:y)-g;return l(r?m-D:m+(6-D),M);case a:case d:return $(v+\"Hours\",0);case u:return $(v+\"Minutes\",1);case s:return $(v+\"Seconds\",2);case i:return $(v+\"Milliseconds\",3);default:return this.clone()}},m.endOf=function(t){return this.startOf(t,!1)},m.$set=function(t,e){var n,o=b.p(t),f=\"set\"+(this.$u?\"UTC\":\"\"),l=(n={},n[a]=f+\"Date\",n[d]=f+\"Date\",n[c]=f+\"Month\",n[h]=f+\"FullYear\",n[u]=f+\"Hours\",n[s]=f+\"Minutes\",n[i]=f+\"Seconds\",n[r]=f+\"Milliseconds\",n)[o],$=o===a?this.$D+(e-this.$W):e;if(o===c||o===h){var y=this.clone().set(d,1);y.$d[l]($),y.init(),this.$d=y.set(d,Math.min(this.$D,y.daysInMonth())).$d}else l&&this.$d[l]($);return this.init(),this},m.set=function(t,e){return this.clone().$set(t,e)},m.get=function(t){return this[b.p(t)]()},m.add=function(r,f){var d,l=this;r=Number(r);var $=b.p(f),y=function(t){var e=O(l);return b.w(e.date(e.date()+Math.round(t*r)),l)};if($===c)return this.set(c,this.$M+r);if($===h)return this.set(h,this.$y+r);if($===a)return y(1);if($===o)return y(7);var M=(d={},d[s]=e,d[u]=n,d[i]=t,d)[$]||1,m=this.$d.getTime()+r*M;return b.w(m,this)},m.subtract=function(t,e){return this.add(-1*t,e)},m.format=function(t){var e=this,n=this.$locale();if(!this.isValid())return n.invalidDate||l;var r=t||\"YYYY-MM-DDTHH:mm:ssZ\",i=b.z(this),s=this.$H,u=this.$m,a=this.$M,o=n.weekdays,c=n.months,f=n.meridiem,h=function(t,n,i,s){return t&&(t[n]||t(e,r))||i[n].slice(0,s)},d=function(t){return b.s(s%12||12,t,\"0\")},$=f||function(t,e,n){var r=t<12?\"AM\":\"PM\";return n?r.toLowerCase():r};return r.replace(y,(function(t,r){return r||function(t){switch(t){case\"YY\":return String(e.$y).slice(-2);case\"YYYY\":return b.s(e.$y,4,\"0\");case\"M\":return a+1;case\"MM\":return b.s(a+1,2,\"0\");case\"MMM\":return h(n.monthsShort,a,c,3);case\"MMMM\":return h(c,a);case\"D\":return e.$D;case\"DD\":return b.s(e.$D,2,\"0\");case\"d\":return String(e.$W);case\"dd\":return h(n.weekdaysMin,e.$W,o,2);case\"ddd\":return h(n.weekdaysShort,e.$W,o,3);case\"dddd\":return o[e.$W];case\"H\":return String(s);case\"HH\":return b.s(s,2,\"0\");case\"h\":return d(1);case\"hh\":return d(2);case\"a\":return $(s,u,!0);case\"A\":return $(s,u,!1);case\"m\":return String(u);case\"mm\":return b.s(u,2,\"0\");case\"s\":return String(e.$s);case\"ss\":return b.s(e.$s,2,\"0\");case\"SSS\":return b.s(e.$ms,3,\"0\");case\"Z\":return i}return null}(t)||i.replace(\":\",\"\")}))},m.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},m.diff=function(r,d,l){var $,y=this,M=b.p(d),m=O(r),v=(m.utcOffset()-this.utcOffset())*e,g=this-m,D=function(){return b.m(y,m)};switch(M){case h:$=D()/12;break;case c:$=D();break;case f:$=D()/3;break;case o:$=(g-v)/6048e5;break;case a:$=(g-v)/864e5;break;case u:$=g/n;break;case s:$=g/e;break;case i:$=g/t;break;default:$=g}return l?$:b.a($)},m.daysInMonth=function(){return this.endOf(c).$D},m.$locale=function(){return D[this.$L]},m.locale=function(t,e){if(!t)return this.$L;var n=this.clone(),r=w(t,e,!0);return r&&(n.$L=r),n},m.clone=function(){return b.w(this.$d,this)},m.toDate=function(){return new Date(this.valueOf())},m.toJSON=function(){return this.isValid()?this.toISOString():null},m.toISOString=function(){return this.$d.toISOString()},m.toString=function(){return this.$d.toUTCString()},M}(),k=_.prototype;return O.prototype=k,[[\"$ms\",r],[\"$s\",i],[\"$m\",s],[\"$H\",u],[\"$W\",a],[\"$M\",c],[\"$y\",h],[\"$D\",d]].forEach((function(t){k[t[1]]=function(e){return this.$g(e,t[0],t[1])}})),O.extend=function(t,e){return t.$i||(t(e,_,O),t.$i=!0),O},O.locale=w,O.isDayjs=S,O.unix=function(t){return O(1e3*t)},O.en=D[g],O.Ls=D,O.p={},O}));","(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.jsonata = f()}})(function(){var define,module,exports;return (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n/**\n * © Copyright IBM Corp. 2018 All Rights Reserved\n *   Project name: JSONata\n *   This project is licensed under the MIT License, see LICENSE\n */\n\nconst utils = require('./utils');\n\n/**\n * DateTime formatting and parsing functions\n * Implements the xpath-functions format-date-time specification\n * @type {{formatInteger, formatDateTime, parseInteger, parseDateTime}}\n */\nconst dateTime = (function () {\n    'use strict';\n\n    const stringToArray = utils.stringToArray;\n\n    const few = ['Zero', 'One', 'Two', 'Three', 'Four', 'Five', 'Six', 'Seven', 'Eight', 'Nine', 'Ten',\n        'Eleven', 'Twelve', 'Thirteen', 'Fourteen', 'Fifteen', 'Sixteen', 'Seventeen', 'Eighteen', 'Nineteen'];\n    const ordinals = ['Zeroth', 'First', 'Second', 'Third', 'Fourth', 'Fifth', 'Sixth', 'Seventh', 'Eighth', 'Ninth', 'Tenth',\n        'Eleventh', 'Twelfth', 'Thirteenth', 'Fourteenth', 'Fifteenth', 'Sixteenth', 'Seventeenth', 'Eighteenth', 'Nineteenth'];\n    const decades = ['Twenty', 'Thirty', 'Forty', 'Fifty', 'Sixty', 'Seventy', 'Eighty', 'Ninety', 'Hundred'];\n    const magnitudes = ['Thousand', 'Million', 'Billion', 'Trillion'];\n\n    /**\n     * converts a number into english words\n     * @param {string} value - the value to format\n     * @param {boolean} ordinal - ordinal or cardinal form\n     * @returns {string} - representation in words\n     */\n    function numberToWords(value, ordinal) {\n        var lookup = function (num, prev, ord) {\n            var words = '';\n            if (num <= 19) {\n                words = (prev ? ' and ' : '') + (ord ? ordinals[num] : few[num]);\n            } else if (num < 100) {\n                const tens = Math.floor(num / 10);\n                const remainder = num % 10;\n                words = (prev ? ' and ' : '') + decades[tens - 2];\n                if (remainder > 0) {\n                    words += '-' + lookup(remainder, false, ord);\n                } else if (ord) {\n                    words = words.substring(0, words.length - 1) + 'ieth';\n                }\n            } else if (num < 1000) {\n                const hundreds = Math.floor(num / 100);\n                const remainder = num % 100;\n                words = (prev ? ', ' : '') + few[hundreds] + ' Hundred';\n                if (remainder > 0) {\n                    words += lookup(remainder, true, ord);\n                } else if (ord) {\n                    words += 'th';\n                }\n            } else {\n                var mag = Math.floor(Math.log10(num) / 3);\n                if (mag > magnitudes.length) {\n                    mag = magnitudes.length; // the largest word\n                }\n                const factor = Math.pow(10, mag * 3);\n                const mant = Math.floor(num / factor);\n                const remainder = num - mant * factor;\n                words = (prev ? ', ' : '') + lookup(mant, false, false) + ' ' + magnitudes[mag - 1];\n                if (remainder > 0) {\n                    words += lookup(remainder, true, ord);\n                } else if (ord) {\n                    words += 'th';\n                }\n            }\n            return words;\n        };\n\n        var words = lookup(value, false, ordinal);\n        return words;\n    }\n\n    const wordValues = {};\n    few.forEach(function (word, index) {\n        wordValues[word.toLowerCase()] = index;\n    });\n    ordinals.forEach(function (word, index) {\n        wordValues[word.toLowerCase()] = index;\n    });\n    decades.forEach(function (word, index) {\n        const lword = word.toLowerCase();\n        wordValues[lword] = (index + 2) * 10;\n        wordValues[lword.substring(0, word.length - 1) + 'ieth'] = wordValues[lword];\n    });\n    wordValues.hundredth = 100;\n    magnitudes.forEach(function (word, index) {\n        const lword = word.toLowerCase();\n        const val = Math.pow(10, (index + 1) * 3);\n        wordValues[lword] = val;\n        wordValues[lword + 'th'] = val;\n    });\n\n    /**\n     * Converts a number in english words to numeric value\n     * @param {string} text - the number in words\n     * @returns {number} - the numeric value\n     */\n    function wordsToNumber(text) {\n        const parts = text.split(/,\\s|\\sand\\s|[\\s\\\\-]/);\n        const values = parts.map(part => wordValues[part]);\n        let segs = [0];\n        values.forEach(value => {\n            if (value < 100) {\n                let top = segs.pop();\n                if (top >= 1000) {\n                    segs.push(top);\n                    top = 0;\n                }\n                segs.push(top + value);\n            } else {\n                segs.push(segs.pop() * value);\n            }\n        });\n        const result = segs.reduce((a, b) => a + b, 0);\n        return result;\n    }\n\n    const romanNumerals = [\n        [1000, 'm'],\n        [900, 'cm'],\n        [500, 'd'],\n        [400, 'cd'],\n        [100, 'c'],\n        [90, 'xc'],\n        [50, 'l'],\n        [40, 'xl'],\n        [10, 'x'],\n        [9, 'ix'],\n        [5, 'v'],\n        [4, 'iv'],\n        [1, 'i']\n    ];\n\n    const romanValues = {'M': 1000, 'D': 500, 'C': 100, 'L': 50, 'X': 10, 'V': 5, 'I': 1};\n\n    /**\n     * converts a number to roman numerals\n     * @param {number} value - the number\n     * @returns {string} - the number in roman numerals\n     */\n    function decimalToRoman(value) {\n        for (var index = 0; index < romanNumerals.length; index++) {\n            const numeral = romanNumerals[index];\n            if (value >= numeral[0]) {\n                return numeral[1] + decimalToRoman(value - numeral[0]);\n            }\n        }\n        return '';\n    }\n\n    /**\n     * converts roman numerals to a number\n     * @param {string} roman - roman number\n     * @returns {number} - the numeric value\n     */\n    function romanToDecimal(roman) {\n        var decimal = 0;\n        var max = 1;\n        for (var i = roman.length - 1; i >= 0; i--) {\n            const digit = roman[i];\n            const value = romanValues[digit];\n            if (value < max) {\n                decimal -= value;\n            } else {\n                max = value;\n                decimal += value;\n            }\n        }\n        return decimal;\n    }\n\n    /**\n     * converts a number to spreadsheet style letters\n     * @param {number} value - the number\n     * @param {string} aChar - the character representing the start of the sequence, e.g. 'A'\n     * @returns {string} - the letters\n     */\n    function decimalToLetters(value, aChar) {\n        var letters = [];\n        var aCode = aChar.charCodeAt(0);\n        while (value > 0) {\n            letters.unshift(String.fromCharCode((value - 1) % 26 + aCode));\n            value = Math.floor((value - 1) / 26);\n        }\n        return letters.join('');\n    }\n\n    /**\n     * converts spreadsheet style letters to a number\n     * @param {string} letters - the letters\n     * @param {string} aChar - the character representing the start of the sequence, e.g. 'A'\n     * @returns {number} - the numeric value\n     */\n    function lettersToDecimal(letters, aChar) {\n        var aCode = aChar.charCodeAt(0);\n        var decimal = 0;\n        for (var i = 0; i < letters.length; i++) {\n            decimal += (letters.charCodeAt(letters.length - i - 1) - aCode + 1) * Math.pow(26, i);\n        }\n        return decimal;\n    }\n\n    /**\n     * Formats an integer as specified by the XPath fn:format-integer function\n     * See https://www.w3.org/TR/xpath-functions-31/#func-format-integer\n     * @param {number} value - the number to be formatted\n     * @param {string} picture - the picture string that specifies the format\n     * @returns {string} - the formatted number\n     */\n    function formatInteger(value, picture) {\n        if (typeof value === 'undefined') {\n            return undefined;\n        }\n\n        value = Math.floor(value);\n\n        const format = analyseIntegerPicture(picture);\n        return _formatInteger(value, format);\n    }\n\n    const formats = {\n        DECIMAL: 'decimal',\n        LETTERS: 'letters',\n        ROMAN: 'roman',\n        WORDS: 'words',\n        SEQUENCE: 'sequence'\n    };\n\n    const tcase = {\n        UPPER: 'upper',\n        LOWER: 'lower',\n        TITLE: 'title'\n    };\n\n    /**\n     * formats an integer using a preprocessed representation of the picture string\n     * @param {number} value - the number to be formatted\n     * @param {object} format - the preprocessed representation of the pucture string\n     * @returns {string} - the formatted number\n     * @private\n     */\n    function _formatInteger(value, format) {\n        let formattedInteger;\n        const negative = value < 0;\n        value = Math.abs(value);\n        switch (format.primary) {\n            case formats.LETTERS:\n                formattedInteger = decimalToLetters(value, format.case === tcase.UPPER ? 'A' : 'a');\n                break;\n            case formats.ROMAN:\n                formattedInteger = decimalToRoman(value);\n                if (format.case === tcase.UPPER) {\n                    formattedInteger = formattedInteger.toUpperCase();\n                }\n                break;\n            case formats.WORDS:\n                formattedInteger = numberToWords(value, format.ordinal);\n                if (format.case === tcase.UPPER) {\n                    formattedInteger = formattedInteger.toUpperCase();\n                } else if (format.case === tcase.LOWER) {\n                    formattedInteger = formattedInteger.toLowerCase();\n                }\n                break;\n            case formats.DECIMAL:\n                formattedInteger = '' + value;\n                // TODO use functionPad\n                var padLength = format.mandatoryDigits - formattedInteger.length;\n                if (padLength > 0) {\n                    var padding = (new Array(padLength + 1)).join('0');\n                    formattedInteger = padding + formattedInteger;\n                }\n                if (format.zeroCode !== 0x30) {\n                    formattedInteger = stringToArray(formattedInteger).map(code => {\n                        return String.fromCodePoint(code.codePointAt(0) + format.zeroCode - 0x30);\n                    }).join('');\n                }\n                // insert the grouping-separator-signs, if any\n                if (format.regular) {\n                    const n = Math.floor((formattedInteger.length - 1) / format.groupingSeparators.position);\n                    for (let ii = n; ii > 0; ii--) {\n                        const pos = formattedInteger.length - ii * format.groupingSeparators.position;\n                        formattedInteger = formattedInteger.substr(0, pos) + format.groupingSeparators.character + formattedInteger.substr(pos);\n                    }\n                } else {\n                    format.groupingSeparators.reverse().forEach(separator => {\n                        const pos = formattedInteger.length - separator.position;\n                        formattedInteger = formattedInteger.substr(0, pos) + separator.character + formattedInteger.substr(pos);\n                    });\n                }\n\n                if (format.ordinal) {\n                    var suffix123 = {'1': 'st', '2': 'nd', '3': 'rd'};\n                    var lastDigit = formattedInteger[formattedInteger.length - 1];\n                    var suffix = suffix123[lastDigit];\n                    if (!suffix || (formattedInteger.length > 1 && formattedInteger[formattedInteger.length - 2] === '1')) {\n                        suffix = 'th';\n                    }\n                    formattedInteger = formattedInteger + suffix;\n                }\n                break;\n            case formats.SEQUENCE:\n                throw {\n                    code: 'D3130',\n                    value: format.token\n                };\n        }\n        if (negative) {\n            formattedInteger = '-' + formattedInteger;\n        }\n\n        return formattedInteger;\n    }\n\n    //TODO what about decimal groups in the unicode supplementary planes (surrogate pairs) ???\n    const decimalGroups = [0x30, 0x0660, 0x06F0, 0x07C0, 0x0966, 0x09E6, 0x0A66, 0x0AE6, 0x0B66, 0x0BE6, 0x0C66, 0x0CE6, 0x0D66, 0x0DE6, 0x0E50, 0x0ED0, 0x0F20, 0x1040, 0x1090, 0x17E0, 0x1810, 0x1946, 0x19D0, 0x1A80, 0x1A90, 0x1B50, 0x1BB0, 0x1C40, 0x1C50, 0xA620, 0xA8D0, 0xA900, 0xA9D0, 0xA9F0, 0xAA50, 0xABF0, 0xFF10];\n\n    /**\n     * preprocesses the picture string\n     * @param {string} picture - picture string\n     * @returns {{type: string, primary: string, case: string, ordinal: boolean}} - analysed picture\n     */\n    function analyseIntegerPicture(picture) {\n        const format = {\n            type: 'integer',\n            primary: formats.DECIMAL,\n            case: tcase.LOWER,\n            ordinal: false\n        };\n\n        let primaryFormat, formatModifier;\n        const semicolon = picture.lastIndexOf(';');\n        if (semicolon === -1) {\n            primaryFormat = picture;\n        } else {\n            primaryFormat = picture.substring(0, semicolon);\n            formatModifier = picture.substring(semicolon + 1);\n            if (formatModifier[0] === 'o') {\n                format.ordinal = true;\n            }\n        }\n\n        /* eslnt-disable-next no-fallthrough */\n        switch (primaryFormat) {\n            case 'A':\n                format.case = tcase.UPPER;\n            /* eslnt-disable-next-line no-fallthrough */\n            case 'a':\n                format.primary = formats.LETTERS;\n                break;\n            case 'I':\n                format.case = tcase.UPPER;\n            /* eslnt-disable-next-line no-fallthrough */\n            case 'i':\n                format.primary = formats.ROMAN;\n                break;\n            case 'W':\n                format.case = tcase.UPPER;\n                format.primary = formats.WORDS;\n                break;\n            case 'Ww':\n                format.case = tcase.TITLE;\n                format.primary = formats.WORDS;\n                break;\n            case 'w':\n                format.primary = formats.WORDS;\n                break;\n            default: {\n                // this is a decimal-digit-pattern if it contains a decimal digit (from any unicode decimal digit group)\n                let zeroCode = null;\n                let mandatoryDigits = 0;\n                let optionalDigits = 0;\n                let groupingSeparators = [];\n                let separatorPosition = 0;\n                const formatCodepoints = stringToArray(primaryFormat).map(c => c.codePointAt(0)).reverse(); // reverse the array to determine positions of grouping-separator-signs\n                formatCodepoints.forEach((codePoint) => {\n                    // step though each char in the picture to determine the digit group\n                    let digit = false;\n                    for (let ii = 0; ii < decimalGroups.length; ii++) {\n                        const group = decimalGroups[ii];\n                        if (codePoint >= group && codePoint <= group + 9) {\n                            // codepoint is part of this decimal group\n                            digit = true;\n                            mandatoryDigits++;\n                            separatorPosition++;\n                            if (zeroCode === null) {\n                                zeroCode = group;\n                            } else if (group !== zeroCode) {\n                                // error! different decimal groups in the same pattern\n                                throw {\n                                    code: 'D3131'\n                                };\n                            }\n                            break;\n                        }\n                    }\n                    if (!digit) {\n                        if (codePoint === 0x23) { // # - optional-digit-sign\n                            separatorPosition++;\n                            optionalDigits++;\n                        } else {\n                            // neither a decimal-digit-sign ot optional-digit-sign, assume it is a grouping-separator-sign\n                            groupingSeparators.push({\n                                position: separatorPosition,\n                                character: String.fromCodePoint(codePoint)\n                            });\n                        }\n                    }\n                });\n                if (mandatoryDigits > 0) {\n                    format.primary = formats.DECIMAL;\n                    // TODO validate decimal-digit-pattern\n\n                    // the decimal digit family (codepoint offset)\n                    format.zeroCode = zeroCode;\n                    // the number of mandatory digits\n                    format.mandatoryDigits = mandatoryDigits;\n                    // the number of optional digits\n                    format.optionalDigits = optionalDigits;\n                    // grouping separator template\n                    // are the grouping-separator-signs 'regular'?\n                    const regularRepeat = function (separators) {\n                        // are the grouping positions regular? i.e. same interval between each of them\n                        // is there at least one separator?\n                        if (separators.length === 0) {\n                            return 0;\n                        }\n                        // are all the characters the same?\n                        const sepChar = separators[0].character;\n                        for (let ii = 1; ii < separators.length; ii++) {\n                            if (separators[ii].character !== sepChar) {\n                                return 0;\n                            }\n                        }\n                        // are they equally spaced?\n                        const indexes = separators.map(separator => separator.position);\n                        const gcd = function (a, b) {\n                            return b === 0 ? a : gcd(b, a % b);\n                        };\n                        // find the greatest common divisor of all the positions\n                        const factor = indexes.reduce(gcd);\n                        // is every position separated by this divisor? If so, it's regular\n                        for (let index = 1; index <= indexes.length; index++) {\n                            if (indexes.indexOf(index * factor) === -1) {\n                                return 0;\n                            }\n                        }\n                        return factor;\n                    };\n\n                    const regular = regularRepeat(groupingSeparators);\n                    if (regular > 0) {\n                        format.regular = true;\n                        format.groupingSeparators = {\n                            position: regular,\n                            character: groupingSeparators[0].character\n                        };\n                    } else {\n                        format.regular = false;\n                        format.groupingSeparators = groupingSeparators;\n                    }\n\n                } else {\n                    // this is a 'numbering sequence' which the spec says is implementation-defined\n                    // this implementation doesn't support any numbering sequences at the moment.\n                    format.primary = formats.SEQUENCE;\n                    format.token = primaryFormat;\n                }\n            }\n        }\n\n        return format;\n    }\n\n    const defaultPresentationModifiers = {\n        Y: '1', M: '1', D: '1', d: '1', F: 'n', W: '1', w: '1', X: '1', x: '1', H: '1', h: '1',\n        P: 'n', m: '01', s: '01', f: '1', Z: '01:01', z: '01:01', C: 'n', E: 'n'\n    };\n\n    // §9.8.4.1 the format specifier is an array of string literals and variable markers\n    /**\n     * analyse the date-time picture string\n     * @param {string} picture - picture string\n     * @returns {{type: string, parts: Array}} - the analysed string\n     */\n    function analyseDateTimePicture(picture) {\n        var spec = [];\n        const format = {\n            type: 'datetime',\n            parts: spec\n        };\n        const addLiteral = function (start, end) {\n            if (end > start) {\n                let literal = picture.substring(start, end);\n                // replace any doubled ]] with single ]\n                // what if there are instances of single ']' ? - the spec doesn't say\n                literal = literal.split(']]').join(']');\n                spec.push({type: 'literal', value: literal});\n            }\n        };\n\n        var start = 0, pos = 0;\n        while (pos < picture.length) {\n            if (picture.charAt(pos) === '[') {\n                // check it's not a doubled [[\n                if (picture.charAt(pos + 1) === '[') {\n                    // literal [\n                    addLiteral(start, pos);\n                    spec.push({type: 'literal', value: '['});\n                    pos += 2;\n                    start = pos;\n                    continue;\n                }\n                // start of variable marker\n                // push the string literal (if there is one) onto the array\n                addLiteral(start, pos);\n                start = pos;\n                // search forward to closing ]\n                pos = picture.indexOf(']', start);\n                // TODO handle error case if pos === -1\n                if(pos === -1) {\n                    // error - no closing bracket\n                    throw {\n                        code: 'D3135'\n                    };\n                }\n                let marker = picture.substring(start + 1, pos);\n                // whitespace within a variable marker is ignored (i.e. remove it)\n                marker = marker.split(/\\s+/).join('');\n                var def = {\n                    type: 'marker',\n                    component: marker.charAt(0)  // 1. The component specifier is always present and is always a single letter.\n                };\n                var comma = marker.lastIndexOf(','); // 2. The width modifier may be recognized by the presence of a comma\n                var presMod; // the presentation modifiers\n                if (comma !== -1) {\n                    // §9.8.4.2 The Width Modifier\n                    const widthMod = marker.substring(comma + 1);\n                    const dash = widthMod.indexOf('-');\n                    let min, max;\n                    const parseWidth = function (wm) {\n                        if (typeof wm === 'undefined' || wm === '*') {\n                            return undefined;\n                        } else {\n                            // TODO validate wm is an unsigned int\n                            return parseInt(wm);\n                        }\n                    };\n                    if (dash === -1) {\n                        min = widthMod;\n                    } else {\n                        min = widthMod.substring(0, dash);\n                        max = widthMod.substring(dash + 1);\n                    }\n                    const widthDef = {\n                        min: parseWidth(min),\n                        max: parseWidth(max)\n                    };\n                    def.width = widthDef;\n                    presMod = marker.substring(1, comma);\n                } else {\n                    presMod = marker.substring(1);\n                }\n                if (presMod.length === 1) {\n                    def.presentation1 = presMod; // first presentation modifier\n                    //TODO validate the first presentation modifier - it's either N, n, Nn or it passes analyseIntegerPicture\n                } else if (presMod.length > 1) {\n                    var lastChar = presMod.charAt(presMod.length - 1);\n                    if ('atco'.indexOf(lastChar) !== -1) {\n                        def.presentation2 = lastChar;\n                        if (lastChar === 'o') {\n                            def.ordinal = true;\n                        }\n                        // 'c' means 'cardinal' and is the default (i.e. not 'ordinal')\n                        // 'a' & 't' are ignored (not sure of their relevance to English numbering)\n                        def.presentation1 = presMod.substring(0, presMod.length - 1);\n                    } else {\n                        def.presentation1 = presMod;\n                        //TODO validate the first presentation modifier - it's either N, n, Nn or it passes analyseIntegerPicture,\n                        // doesn't use ] as grouping separator, and if grouping separator is , then must have width modifier\n                    }\n                } else {\n                    // no presentation modifier specified - apply the default;\n                    def.presentation1 = defaultPresentationModifiers[def.component];\n                }\n                if (typeof def.presentation1 === 'undefined') {\n                    // unknown component specifier\n                    throw {\n                        code: 'D3132',\n                        value: def.component\n                    };\n                }\n                if (def.presentation1[0] === 'n') {\n                    def.names = tcase.LOWER;\n                } else if (def.presentation1[0] === 'N') {\n                    if (def.presentation1[1] === 'n') {\n                        def.names = tcase.TITLE;\n                    } else {\n                        def.names = tcase.UPPER;\n                    }\n                } else if ('YMDdFWwXxHhmsf'.indexOf(def.component) !== -1) {\n                    var integerPattern = def.presentation1;\n                    if (def.presentation2) {\n                        integerPattern += ';' + def.presentation2;\n                    }\n                    def.integerFormat = analyseIntegerPicture(integerPattern);\n                    if (def.width && def.width.min !== undefined) {\n                        if (def.integerFormat.mandatoryDigits < def.width.min) {\n                            def.integerFormat.mandatoryDigits = def.width.min;\n                        }\n                    }\n                    if ('YMD'.indexOf(def.component) !== -1) {\n                        // §9.8.4.4\n                        def.n = -1;\n                        if (def.width && def.width.max !== undefined) {\n                            def.n = def.width.max;\n                            def.integerFormat.mandatoryDigits = def.n;\n                        } else {\n                            var w = def.integerFormat.mandatoryDigits + def.integerFormat.optionalDigits;\n                            if (w >= 2) {\n                                def.n = w;\n                            }\n                        }\n                    }\n                }\n                if (def.component === 'Z' || def.component === 'z') {\n                    def.integerFormat = analyseIntegerPicture(def.presentation1);\n                }\n                spec.push(def);\n                start = pos + 1;\n            }\n            pos++;\n        }\n        addLiteral(start, pos);\n        return format;\n    }\n\n    const days = ['', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];\n    const months = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];\n    const millisInADay = 1000 * 60 * 60 * 24;\n\n    const startOfFirstWeek = function (ym) {\n        // ISO 8601 defines the first week of the year to be the week that contains the first Thursday\n        // XPath F&O extends this same definition for the first week of a month\n        // the week starts on a Monday - calculate the millis for the start of the first week\n        // millis for given 1st Jan of that year (at 00:00 UTC)\n        const jan1 = Date.UTC(ym.year, ym.month);\n        var dayOfJan1 = (new Date(jan1)).getUTCDay();\n        if (dayOfJan1 === 0) {\n            dayOfJan1 = 7;\n        }\n        // if Jan 1 is Fri, Sat or Sun, then add the number of days (in millis) to jan1 to get the start of week 1\n        return dayOfJan1 > 4 ? jan1 + (8 - dayOfJan1) * millisInADay : jan1 - (dayOfJan1 - 1) * millisInADay;\n    };\n\n    const yearMonth = function (year, month) {\n        return {\n            year: year,\n            month: month,\n            nextMonth: function () {\n                return (month === 11) ? yearMonth(year + 1, 0) : yearMonth(year, month + 1);\n            },\n            previousMonth: function () {\n                return (month === 0) ? yearMonth(year - 1, 11) : yearMonth(year, month - 1);\n            },\n            nextYear: function () {\n                return yearMonth(year + 1, month);\n            },\n            previousYear: function () {\n                return yearMonth(year - 1, month);\n            }\n        };\n    };\n\n    const deltaWeeks = function (start, end) {\n        return (end - start) / (millisInADay * 7) + 1;\n    };\n\n    const getDateTimeFragment = (date, component) => {\n        let componentValue;\n        switch (component) {\n            case 'Y': // year\n                componentValue = date.getUTCFullYear();\n                break;\n            case 'M': // month in year\n                componentValue = date.getUTCMonth() + 1;\n                break;\n            case 'D': // day in month\n                componentValue = date.getUTCDate();\n                break;\n            case 'd': { // day in year\n                // millis for given date (at 00:00 UTC)\n                const today = Date.UTC(date.getUTCFullYear(), date.getUTCMonth(), date.getUTCDate());\n                // millis for given 1st Jan of that year (at 00:00 UTC)\n                const firstJan = Date.UTC(date.getUTCFullYear(), 0);\n                componentValue = (today - firstJan) / millisInADay + 1;\n                break;\n            }\n            case 'F': // day of week\n                componentValue = date.getUTCDay();\n                if (componentValue === 0) {\n                    // ISO 8601 defines days 1-7: Mon-Sun\n                    componentValue = 7;\n                }\n                break;\n            case 'W': { // week in year\n                const thisYear = yearMonth(date.getUTCFullYear(), 0);\n                const startOfWeek1 = startOfFirstWeek(thisYear);\n                const today = Date.UTC(thisYear.year, date.getUTCMonth(), date.getUTCDate());\n                let week = deltaWeeks(startOfWeek1, today);\n                if (week > 52) {\n                    // might be first week of the following year\n                    const startOfFollowingYear = startOfFirstWeek(thisYear.nextYear());\n                    if (today >= startOfFollowingYear) {\n                        week = 1;\n                    }\n                } else if (week < 1) {\n                    // must be end of the previous year\n                    const startOfPreviousYear = startOfFirstWeek(thisYear.previousYear());\n                    week = deltaWeeks(startOfPreviousYear, today);\n                }\n                componentValue = Math.floor(week);\n                break;\n            }\n            case 'w': { // week in month\n                const thisMonth = yearMonth(date.getUTCFullYear(), date.getUTCMonth());\n                const startOfWeek1 = startOfFirstWeek(thisMonth);\n                const today = Date.UTC(thisMonth.year, thisMonth.month, date.getUTCDate());\n                let week = deltaWeeks(startOfWeek1, today);\n                if (week > 4) {\n                    // might be first week of the following month\n                    const startOfFollowingMonth = startOfFirstWeek(thisMonth.nextMonth());\n                    if (today >= startOfFollowingMonth) {\n                        week = 1;\n                    }\n                } else if (week < 1) {\n                    // must be end of the previous month\n                    const startOfPreviousMonth = startOfFirstWeek(thisMonth.previousMonth());\n                    week = deltaWeeks(startOfPreviousMonth, today);\n                }\n                componentValue = Math.floor(week);\n                break;\n            }\n            case 'X': { // ISO week-numbering year\n                // Extension: The F&O spec says nothing about how to access the year associated with the week-of-the-year\n                // e.g. Sat 1 Jan 2005 is in the 53rd week of 2004.\n                // The 'W' component specifier gives 53, but 'Y' will give 2005.\n                // I propose to add 'X' as the component specifier to give the ISO week-numbering year (2004 in this example)\n                const thisYear = yearMonth(date.getUTCFullYear(), 0);\n                const startOfISOYear = startOfFirstWeek(thisYear);\n                const endOfISOYear = startOfFirstWeek(thisYear.nextYear());\n                const now = date.getTime();\n                if (now < startOfISOYear) {\n                    componentValue = thisYear.year - 1;\n                } else if (now >= endOfISOYear) {\n                    componentValue = thisYear.year + 1;\n                } else {\n                    componentValue = thisYear.year;\n                }\n                break;\n            }\n            case 'x': { // ISO week-numbering month\n                // Extension: The F&O spec says nothing about how to access the month associated with the week-of-the-month\n                // e.g. Sat 1 Jan 2005 is in the 5th week of December 2004.\n                // The 'w' component specifier gives 5, but 'W' will give January and 'Y' will give 2005.\n                // I propose to add 'x' as the component specifier to give the 'week-numbering' month (December in this example)\n                const thisMonth = yearMonth(date.getUTCFullYear(), date.getUTCMonth());\n                const startOfISOMonth = startOfFirstWeek(thisMonth);\n                const nextMonth = thisMonth.nextMonth();\n                const endOfISOMonth = startOfFirstWeek(nextMonth);\n                const now = date.getTime();\n                if (now < startOfISOMonth) {\n                    componentValue = thisMonth.previousMonth().month + 1;\n                } else if (now >= endOfISOMonth) {\n                    componentValue = nextMonth.month + 1;\n                } else {\n                    componentValue = thisMonth.month + 1;\n                }\n                break;\n            }\n            case 'H': // hour in day (24 hours)\n                componentValue = date.getUTCHours();\n                break;\n            case 'h': // hour in half-day (12 hours)\n                componentValue = date.getUTCHours();\n                componentValue = componentValue % 12;\n                if (componentValue === 0) {\n                    componentValue = 12;\n                }\n                break;\n            case 'P': // am/pm marker\n                componentValue = date.getUTCHours() >= 12 ? 'pm' : 'am';\n                break;\n            case 'm': // minute in hour\n                componentValue = date.getUTCMinutes();\n                break;\n            case 's': // second in minute\n                componentValue = date.getUTCSeconds();\n                break;\n            case 'f': // fractional seconds\n                componentValue = date.getUTCMilliseconds();\n                break;\n            case 'Z': // timezone\n            case 'z':\n                // since the date object is constructed from epoch millis, the TZ component is always be UTC.\n                break;\n            case 'C': // calendar name\n                componentValue = 'ISO';\n                break;\n            case 'E': // era\n                componentValue = 'ISO';\n                break;\n        }\n        return componentValue;\n    };\n\n    let iso8601Spec = null;\n\n    /**\n     * formats the date/time as specified by the XPath fn:format-dateTime function\n     * @param {number} millis - the timestamp to be formatted, in millis since the epoch\n     * @param {string} picture - the picture string that specifies the format\n     * @param {string} timezone - the timezone to use\n     * @returns {string} - the formatted timestamp\n     */\n    function formatDateTime(millis, picture, timezone) {\n        var offsetHours = 0;\n        var offsetMinutes = 0;\n\n        if (typeof timezone !== 'undefined') {\n            // parse the hour and minute offsets\n            // assume for now the format supplied is +hhmm\n            const offset = parseInt(timezone);\n            offsetHours = Math.floor(offset / 100);\n            offsetMinutes = offset % 100;\n        }\n\n        var formatComponent = function (date, markerSpec) {\n            var componentValue = getDateTimeFragment(date, markerSpec.component);\n\n            // §9.8.4.3 Formatting Integer-Valued Date/Time Components\n            if ('YMDdFWwXxHhms'.indexOf(markerSpec.component) !== -1) {\n                if (markerSpec.component === 'Y') {\n                    // §9.8.4.4 Formatting the Year Component\n                    if (markerSpec.n !== -1) {\n                        componentValue = componentValue % Math.pow(10, markerSpec.n);\n                    }\n                }\n                if (markerSpec.names) {\n                    if (markerSpec.component === 'M' || markerSpec.component === 'x') {\n                        componentValue = months[componentValue - 1];\n                    } else if (markerSpec.component === 'F') {\n                        componentValue = days[componentValue];\n                    } else {\n                        throw {\n                            code: 'D3133',\n                            value: markerSpec.component\n                        };\n                    }\n                    if (markerSpec.names === tcase.UPPER) {\n                        componentValue = componentValue.toUpperCase();\n                    } else if (markerSpec.names === tcase.LOWER) {\n                        componentValue = componentValue.toLowerCase();\n                    }\n                    if (markerSpec.width && componentValue.length > markerSpec.width.max) {\n                        componentValue = componentValue.substring(0, markerSpec.width.max);\n                    }\n                } else {\n                    componentValue = _formatInteger(componentValue, markerSpec.integerFormat);\n                }\n            } else if (markerSpec.component === 'f') {\n                // TODO §9.8.4.5 Formatting Fractional Seconds\n                componentValue = _formatInteger(componentValue, markerSpec.integerFormat);\n            } else if (markerSpec.component === 'Z' || markerSpec.component === 'z') {\n                // §9.8.4.6 Formatting timezones\n                const offset = offsetHours * 100 + offsetMinutes;\n                if (markerSpec.integerFormat.regular) {\n                    componentValue = _formatInteger(offset, markerSpec.integerFormat);\n                } else {\n                    const numDigits = markerSpec.integerFormat.mandatoryDigits;\n                    if (numDigits === 1 || numDigits === 2) {\n                        componentValue = _formatInteger(offsetHours, markerSpec.integerFormat);\n                        if (offsetMinutes !== 0) {\n                            componentValue += ':' + formatInteger(offsetMinutes, '00');\n                        }\n                    } else if (numDigits === 3 || numDigits === 4) {\n                        componentValue = _formatInteger(offset, markerSpec.integerFormat);\n                    } else {\n                        throw {\n                            code: 'D3134',\n                            value: numDigits\n                        };\n                    }\n                }\n                if (offset >= 0) {\n                    componentValue = '+' + componentValue;\n                }\n                if (markerSpec.component === 'z') {\n                    componentValue = 'GMT' + componentValue;\n                }\n                if (offset === 0 && markerSpec.presentation2 === 't') {\n                    componentValue = 'Z';\n                }\n            }\n            return componentValue;\n        };\n\n        let formatSpec;\n        if(typeof picture === 'undefined') {\n            // default to ISO 8601 format\n            if (iso8601Spec === null) {\n                iso8601Spec = analyseDateTimePicture('[Y0001]-[M01]-[D01]T[H01]:[m01]:[s01].[f001][Z01:01t]');\n            }\n            formatSpec = iso8601Spec;\n        } else {\n            formatSpec = analyseDateTimePicture(picture);\n        }\n\n        const offsetMillis = (60 * offsetHours + offsetMinutes) * 60 * 1000;\n        const dateTime = new Date(millis + offsetMillis);\n\n        let result = '';\n        formatSpec.parts.forEach(function (part) {\n            if (part.type === 'literal') {\n                result += part.value;\n            } else {\n                result += formatComponent(dateTime, part);\n            }\n        });\n\n        return result;\n    }\n\n    /**\n     * Generate a regex to parse integers or timestamps\n     * @param {object} formatSpec - object representing the format\n     * @returns {object} - regex\n     */\n    function generateRegex(formatSpec) {\n        var matcher = {};\n        if (formatSpec.type === 'datetime') {\n            matcher.type = 'datetime';\n            matcher.parts = formatSpec.parts.map(function (part) {\n                var res = {};\n                if (part.type === 'literal') {\n                    res.regex = part.value.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n                } else if (part.component === 'Z' || part.component === 'z') {\n                    // timezone\n                    let separator;\n                    if (!Array.isArray(part.integerFormat.groupingSeparators)) {\n                        separator = part.integerFormat.groupingSeparators;\n                    }\n                    res.regex = '';\n                    if (part.component === 'z') {\n                        res.regex = 'GMT';\n                    }\n                    res.regex += '[-+][0-9]+';\n                    if (separator) {\n                        res.regex += separator.character + '[0-9]+';\n                    }\n                    res.parse = function(value) {\n                        if (part.component === 'z') {\n                            value = value.substring(3); // remove the leading GMT\n                        }\n                        let offsetHours = 0, offsetMinutes = 0;\n                        if (separator) {\n                            offsetHours = Number.parseInt(value.substring(0, value.indexOf(separator.character)));\n                            offsetMinutes = Number.parseInt(value.substring(value.indexOf(separator.character) + 1));\n                        } else {\n                            // depends on number of digits\n                            const numdigits = value.length - 1;\n                            if (numdigits <= 2) {\n                                // just hour offset\n                                offsetHours = Number.parseInt(value);\n                            } else {\n                                offsetHours = Number.parseInt(value.substring(0, 3));\n                                offsetMinutes = Number.parseInt(value.substring(3));\n                            }\n                        }\n                        return offsetHours * 60 + offsetMinutes;\n                    };\n                } else if (part.integerFormat) {\n                    part.integerFormat.n = part.n;\n                    res = generateRegex(part.integerFormat);\n                } else {\n                    // must be a month or day name\n                    res.regex = '[a-zA-Z]+';\n                    var lookup = {};\n                    if (part.component === 'M' || part.component === 'x') {\n                        // months\n                        months.forEach(function (name, index) {\n                            if (part.width && part.width.max) {\n                                lookup[name.substring(0, part.width.max)] = index + 1;\n                            } else {\n                                lookup[name] = index + 1;\n                            }\n                        });\n                    } else if (part.component === 'F') {\n                        // days\n                        days.forEach(function (name, index) {\n                            if (index > 0) {\n                                if (part.width && part.width.max) {\n                                    lookup[name.substring(0, part.width.max)] = index;\n                                } else {\n                                    lookup[name] = index;\n                                }\n                            }\n                        });\n                    } else if (part.component === 'P') {\n                        lookup = {'am': 0, 'AM': 0, 'pm': 1, 'PM': 1};\n                    } else {\n                        // unsupported 'name' option for this component\n                        throw {\n                            code: 'D3133',\n                            value: part.component\n                        };\n                    }\n                    res.parse = function (value) {\n                        return lookup[value];\n                    };\n                }\n                res.component = part.component;\n                return res;\n            });\n        } else { // type === 'integer'\n            matcher.type = 'integer';\n            const isUpper = formatSpec.case === tcase.UPPER;\n            let occurrences;\n            if(formatSpec.n && formatSpec.n > 0){\n                if(formatSpec.optionalDigits === 0){\n                    occurrences = `{${formatSpec.n}}`;\n                } else {\n                    occurrences = `{${formatSpec.n - formatSpec.optionalDigits},${formatSpec.n}}`;\n                }\n            } else {\n                occurrences = '+';\n            }\n\n            switch (formatSpec.primary) {\n                case formats.LETTERS:\n                    matcher.regex = isUpper ? '[A-Z]+' : '[a-z]+';\n                    matcher.parse = function (value) {\n                        return lettersToDecimal(value, isUpper ? 'A' : 'a');\n                    };\n                    break;\n                case formats.ROMAN:\n                    matcher.regex = isUpper ? '[MDCLXVI]+' : '[mdclxvi]+';\n                    matcher.parse = function (value) {\n                        return romanToDecimal(isUpper ? value : value.toUpperCase());\n                    };\n                    break;\n                case formats.WORDS:\n                    matcher.regex = '(?:' + Object.keys(wordValues).concat('and', '[\\\\-, ]').join('|') + ')+';\n                    matcher.parse = function (value) {\n                        return wordsToNumber(value.toLowerCase());\n                    };\n                    break;\n                case formats.DECIMAL:\n                    matcher.regex = `[0-9]${occurrences}`;\n                    if (formatSpec.ordinal) {\n                        // ordinals\n                        matcher.regex += '(?:th|st|nd|rd)';\n                    }\n                    matcher.parse = function (value) {\n                        let digits = value;\n                        if (formatSpec.ordinal) {\n                            // strip off the suffix\n                            digits = value.substring(0, value.length - 2);\n                        }\n                        // strip out the separators\n                        if (formatSpec.regular) {\n                            digits = digits.split(',').join('');\n                        } else {\n                            formatSpec.groupingSeparators.forEach(sep => {\n                                digits = digits.split(sep.character).join('');\n                            });\n                        }\n                        if (formatSpec.zeroCode !== 0x30) {\n                            // apply offset\n                            digits = digits.split('').map(char => String.fromCodePoint(char.codePointAt(0) - formatSpec.zeroCode + 0x30)).join('');\n                        }\n                        return parseInt(digits);\n                    };\n                    break;\n                case formats.SEQUENCE:\n                    throw {\n                        code: 'D3130',\n                        value: formatSpec.token\n                    };\n            }\n\n        }\n        return matcher;\n    }\n\n    /**\n     * parse a string containing an integer as specified by the picture string\n     * @param {string} value - the string to parse\n     * @param {string} picture - the picture string\n     * @returns {number} - the parsed number\n     */\n    function parseInteger(value, picture) {\n        if (typeof value === 'undefined') {\n            return undefined;\n        }\n\n        const formatSpec = analyseIntegerPicture(picture);\n        const matchSpec = generateRegex(formatSpec);\n        //const fullRegex = '^' + matchSpec.regex + '$';\n        //const matcher = new RegExp(fullRegex);\n        // TODO validate input based on the matcher regex\n        const result = matchSpec.parse(value);\n        return result;\n    }\n\n    /**\n     * parse a string containing a timestamp as specified by the picture string\n     * @param {string} timestamp - the string to parse\n     * @param {string} picture - the picture string\n     * @returns {number} - the parsed timestamp in millis since the epoch\n     */\n    function parseDateTime(timestamp, picture) {\n        const formatSpec = analyseDateTimePicture(picture);\n        const matchSpec = generateRegex(formatSpec);\n        const fullRegex = '^' + matchSpec.parts.map(part => '(' + part.regex + ')').join('') + '$';\n\n        const matcher = new RegExp(fullRegex, 'i'); // TODO can cache this against the picture\n        var info = matcher.exec(timestamp);\n        if (info !== null) {\n            // validate what we've just parsed - do we have enough information to create a timestamp?\n            // rules:\n            // The date is specified by one of:\n            //    {Y, M, D}    (dateA)\n            // or {Y, d}       (dateB)\n            // or {Y, x, w, F} (dateC)\n            // or {X, W, F}    (dateD)\n            // The time is specified by one of:\n            //    {H, m, s, f}    (timeA)\n            // or {P, h, m, s, f} (timeB)\n            // All sets can have an optional Z\n            // To create a timestamp (epoch millis) we need both date and time, but we can default missing\n            // information according to the following rules:\n            // - line up one combination of the above from date, and one from time, most significant value (MSV) to least significant (LSV\n            // - for the values that have been captured, if there are any gaps between MSV and LSV, then throw an error\n            //     (e.g.) if hour and seconds, but not minutes is given - throw\n            //     (e.g.) if month, hour and minutes, but not day-of-month is given - throw\n            // - anything right of the LSV should be defaulted to zero\n            //     (e.g.) if hour and minutes given, default seconds and fractional seconds to zero\n            //     (e.g.) if date only given, default the time to 0:00:00.000 (midnight)\n            // - anything left of the MSV should be defaulted to the value of that component returned by $now()\n            //     (e.g.) if time only given, default the date to today\n            //     (e.g.) if month and date given, default to this year (and midnight, by previous rule)\n            //   -- default values for X, x, W, w, F will be derived from the values returned by $now()\n\n            // implement the above rules\n            // determine which of the above date/time combinations we have by using bit masks\n\n            //        Y X M x W w d D F P H h m s f Z\n            // dateA  1 0 1 0 0 0 0 1 ?                     0 - must not appear\n            // dateB  1 0 0 0 0 0 1 0 ?                     1 - can appear - relevant\n            // dateC  0 1 0 1 0 1 0 0 1                     ? - can appear - ignored\n            // dateD  0 1 0 0 1 0 0 0 1\n            // timeA                    0 1 0 1 1 1\n            // timeB                    1 0 1 1 1 1\n\n            // create bitmasks based on the above\n            //    date mask             YXMxWwdD\n            const dmA = 161;  // binary 10100001\n            const dmB = 130;  // binary 10000010\n            const dmC = 84;   // binary 01010100\n            const dmD = 72;   // binary 01001000\n            //    time mask             PHhmsf\n            const tmA = 23;   // binary 010111\n            const tmB = 47;   // binary 101111\n\n            const components = {};\n            for (let i = 1; i < info.length; i++) {\n                const mpart = matchSpec.parts[i - 1];\n                if (mpart.parse) {\n                    components[mpart.component] = mpart.parse(info[i]);\n                }\n            }\n\n            if(Object.getOwnPropertyNames(components).length === 0) {\n                // nothing specified\n                return undefined;\n            }\n\n            let mask = 0;\n\n            const shift = bit => {\n                mask <<= 1;\n                mask += bit ? 1 : 0;\n            };\n\n            const isType = type => {\n                // shouldn't match any 0's, must match at least one 1\n                return !(~type & mask) && !!(type & mask);\n            };\n\n            'YXMxWwdD'.split('').forEach(part => shift(components[part]));\n\n            const dateA = isType(dmA);\n            const dateB = !dateA && isType(dmB);\n            const dateC = isType(dmC);\n            const dateD = !dateC && isType(dmD);\n\n            mask = 0;\n            'PHhmsf'.split('').forEach(part => shift(components[part]));\n\n            const timeA = isType(tmA);\n            const timeB = !timeA && isType(tmB);\n\n            // should only be zero or one date type and zero or one time type\n\n            const dateComps = dateB ? 'YD' : dateC ? 'XxwF' : dateD? 'XWF' : 'YMD';\n            const timeComps = timeB ? 'Phmsf' : 'Hmsf';\n\n            const comps = dateComps + timeComps;\n\n            // step through the candidate parts from most significant to least significant\n            // default the most significant unspecified parts to current timestamp component\n            // default the least significant unspecified parts to zero\n            // if any gaps in between the specified parts, throw an error\n\n            const now = this.environment.timestamp; // must get the fixed timestamp from jsonata\n\n            let startSpecified = false;\n            let endSpecified = false;\n            comps.split('').forEach(part => {\n                if(typeof components[part] === 'undefined') {\n                    if(startSpecified) {\n                        // past the specified block - default to zero\n                        components[part] = ('MDd'.indexOf(part) !== -1) ? 1 : 0;\n                        endSpecified = true;\n                    } else {\n                        // haven't hit the specified block yet, default to current timestamp\n                        components[part] = getDateTimeFragment(now, part);\n                    }\n                } else {\n                    startSpecified = true;\n                    if(endSpecified) {\n                        throw {\n                            code: 'D3136'\n                        };\n                    }\n                }\n            });\n\n            // validate and fill in components\n            if (components.M > 0) {\n                components.M -= 1;  // Date.UTC requires a zero-indexed month\n            } else {\n                components.M = 0; // default to January\n            }\n            if (dateB) {\n                // millis for given 1st Jan of that year (at 00:00 UTC)\n                const firstJan = Date.UTC(components.Y, 0);\n                const offsetMillis = (components.d - 1) * 1000 * 60 * 60 * 24;\n                const derivedDate = new Date(firstJan + offsetMillis);\n                components.M = derivedDate.getUTCMonth();\n                components.D = derivedDate.getUTCDate();\n            }\n            if (dateC) {\n                // TODO implement this\n                // parsing this format not currently supported\n                throw {\n                    code: 'D3136'\n                };\n            }\n            if (dateD) {\n                // TODO implement this\n                // parsing this format (ISO week date) not currently supported\n                throw {\n                    code: 'D3136'\n                };\n            }\n            if (timeB) {\n                // 12hr to 24hr\n                components.H = components.h === 12 ? 0 : components.h;\n                if (components.P === 1) {\n                    components.H += 12;\n                }\n            }\n\n            var millis = Date.UTC(components.Y, components.M, components.D, components.H, components.m, components.s, components.f);\n            if(components.Z || components.z) {\n                // adjust for timezone\n                millis -= (components.Z || components.z) * 60 * 1000;\n            }\n            return millis;\n        }\n    }\n\n    // Regular expression to match an ISO 8601 formatted timestamp\n    var iso8601regex = new RegExp('^\\\\d{4}(-[01]\\\\d)*(-[0-3]\\\\d)*(T[0-2]\\\\d:[0-5]\\\\d:[0-5]\\\\d)*(\\\\.\\\\d+)?([+-][0-2]\\\\d:?[0-5]\\\\d|Z)?$');\n\n    /**\n     * Converts an ISO 8601 timestamp to milliseconds since the epoch\n     *\n     * @param {string} timestamp - the timestamp to be converted\n     * @param {string} [picture] - the picture string defining the format of the timestamp (defaults to ISO 8601)\n     * @returns {Number} - milliseconds since the epoch\n     */\n    function toMillis(timestamp, picture) {\n        // undefined inputs always return undefined\n        if(typeof timestamp === 'undefined') {\n            return undefined;\n        }\n\n        if(typeof picture === 'undefined') {\n            if (!iso8601regex.test(timestamp)) {\n                throw {\n                    stack: (new Error()).stack,\n                    code: \"D3110\",\n                    value: timestamp\n                };\n            }\n\n            return Date.parse(timestamp);\n        } else {\n            return parseDateTime.call(this, timestamp, picture);\n        }\n    }\n\n    /**\n     * Converts milliseconds since the epoch to an ISO 8601 timestamp\n     * @param {Number} millis - milliseconds since the epoch to be converted\n     * @param {string} [picture] - the picture string defining the format of the timestamp (defaults to ISO 8601)\n     * @param {string} [timezone] - the timezone to format the timestamp in (defaults to UTC)\n     * @returns {String} - the formatted timestamp\n     */\n    function fromMillis(millis, picture, timezone) {\n        // undefined inputs always return undefined\n        if(typeof millis === 'undefined') {\n            return undefined;\n        }\n\n        return formatDateTime.call(this, millis, picture, timezone);\n    }\n\n    return {\n        formatInteger, parseInteger, fromMillis, toMillis\n    };\n})();\n\nmodule.exports = dateTime;\n\n},{\"./utils\":6}],2:[function(require,module,exports){\n(function (global){(function (){\n/**\n * © Copyright IBM Corp. 2016, 2018 All Rights Reserved\n *   Project name: JSONata\n *   This project is licensed under the MIT License, see LICENSE\n */\n\nvar utils = require('./utils');\n\nconst functions = (() => {\n    'use strict';\n\n    var isNumeric = utils.isNumeric;\n    var isArrayOfStrings = utils.isArrayOfStrings;\n    var isArrayOfNumbers = utils.isArrayOfNumbers;\n    var createSequence = utils.createSequence;\n    var isSequence = utils.isSequence;\n    var isFunction = utils.isFunction;\n    var isLambda = utils.isLambda;\n    var isIterable = utils.isIterable;\n    var getFunctionArity = utils.getFunctionArity;\n    var deepEquals = utils.isDeepEqual;\n    var stringToArray = utils.stringToArray;\n\n    /**\n     * Sum function\n     * @param {Object} args - Arguments\n     * @returns {number} Total value of arguments\n     */\n    function sum(args) {\n        // undefined inputs always return undefined\n        if (typeof args === 'undefined') {\n            return undefined;\n        }\n\n        var total = 0;\n        args.forEach(function (num) {\n            total += num;\n        });\n        return total;\n    }\n\n    /**\n     * Count function\n     * @param {Object} args - Arguments\n     * @returns {number} Number of elements in the array\n     */\n    function count(args) {\n        // undefined inputs always return undefined\n        if (typeof args === 'undefined') {\n            return 0;\n        }\n\n        return args.length;\n    }\n\n    /**\n     * Max function\n     * @param {Object} args - Arguments\n     * @returns {number} Max element in the array\n     */\n    function max(args) {\n        // undefined inputs always return undefined\n        if (typeof args === 'undefined' || args.length === 0) {\n            return undefined;\n        }\n\n        return Math.max.apply(Math, args);\n    }\n\n    /**\n     * Min function\n     * @param {Object} args - Arguments\n     * @returns {number} Min element in the array\n     */\n    function min(args) {\n        // undefined inputs always return undefined\n        if (typeof args === 'undefined' || args.length === 0) {\n            return undefined;\n        }\n\n        return Math.min.apply(Math, args);\n    }\n\n    /**\n     * Average function\n     * @param {Object} args - Arguments\n     * @returns {number} Average element in the array\n     */\n    function average(args) {\n        // undefined inputs always return undefined\n        if (typeof args === 'undefined' || args.length === 0) {\n            return undefined;\n        }\n\n        var total = 0;\n        args.forEach(function (num) {\n            total += num;\n        });\n        return total / args.length;\n    }\n\n    /**\n     * Stringify arguments\n     * @param {Object} arg - Arguments\n     * @param {boolean} [prettify] - Pretty print the result\n     * @returns {String} String from arguments\n     */\n    function string(arg, prettify = false) {\n        // undefined inputs always return undefined\n        if (typeof arg === 'undefined') {\n            return undefined;\n        }\n\n        var str;\n\n        if (typeof arg === 'string') {\n            // already a string\n            str = arg;\n        } else if (isFunction(arg)) {\n            // functions (built-in and lambda convert to empty string\n            str = '';\n        } else if (typeof arg === 'number' && !isFinite(arg)) {\n            throw {\n                code: \"D3001\",\n                value: arg,\n                stack: (new Error()).stack\n            };\n        } else {\n            var space = prettify ? 2 : 0;\n            if(Array.isArray(arg) && arg.outerWrapper) {\n                arg = arg[0];\n            }\n            str = JSON.stringify(arg, function (key, val) {\n                return (typeof val !== 'undefined' && val !== null && val.toPrecision && isNumeric(val)) ? Number(val.toPrecision(15)) :\n                    (val && isFunction(val)) ? '' : val;\n            }, space);\n        }\n        return str;\n    }\n\n    /**\n     * Create substring based on character number and length\n     * @param {String} str - String to evaluate\n     * @param {Integer} start - Character number to start substring\n     * @param {Integer} [length] - Number of characters in substring\n     * @returns {string|*} Substring\n     */\n    function substring(str, start, length) {\n        // undefined inputs always return undefined\n        if (typeof str === 'undefined') {\n            return undefined;\n        }\n\n        var strArray = stringToArray(str);\n        var strLength = strArray.length;\n\n        if (strLength + start < 0) {\n            start = 0;\n        }\n\n        if (typeof length !== 'undefined') {\n            if (length <= 0) {\n                return '';\n            }\n            var end = start >= 0 ? start + length : strLength + start + length;\n            return strArray.slice(start, end).join('');\n        }\n\n        return strArray.slice(start).join('');\n    }\n\n    /**\n     * Create substring up until a character\n     * @param {String} str - String to evaluate\n     * @param {String} chars - Character to define substring boundary\n     * @returns {*} Substring\n     */\n    function substringBefore(str, chars) {\n        // undefined inputs always return undefined\n        if (typeof str === 'undefined') {\n            return undefined;\n        }\n\n        var pos = str.indexOf(chars);\n        if (pos > -1) {\n            return str.substr(0, pos);\n        } else {\n            return str;\n        }\n    }\n\n    /**\n     * Create substring after a character\n     * @param {String} str - String to evaluate\n     * @param {String} chars - Character to define substring boundary\n     * @returns {*} Substring\n     */\n    function substringAfter(str, chars) {\n        // undefined inputs always return undefined\n        if (typeof str === 'undefined') {\n            return undefined;\n        }\n\n        var pos = str.indexOf(chars);\n        if (pos > -1) {\n            return str.substr(pos + chars.length);\n        } else {\n            return str;\n        }\n    }\n\n    /**\n     * Lowercase a string\n     * @param {String} str - String to evaluate\n     * @returns {string} Lowercase string\n     */\n    function lowercase(str) {\n        // undefined inputs always return undefined\n        if (typeof str === 'undefined') {\n            return undefined;\n        }\n\n        return str.toLowerCase();\n    }\n\n    /**\n     * Uppercase a string\n     * @param {String} str - String to evaluate\n     * @returns {string} Uppercase string\n     */\n    function uppercase(str) {\n        // undefined inputs always return undefined\n        if (typeof str === 'undefined') {\n            return undefined;\n        }\n\n        return str.toUpperCase();\n    }\n\n    /**\n     * length of a string\n     * @param {String} str - string\n     * @returns {Number} The number of characters in the string\n     */\n    function length(str) {\n        // undefined inputs always return undefined\n        if (typeof str === 'undefined') {\n            return undefined;\n        }\n\n        return stringToArray(str).length;\n    }\n\n    /**\n     * Normalize and trim whitespace within a string\n     * @param {string} str - string to be trimmed\n     * @returns {string} - trimmed string\n     */\n    function trim(str) {\n        // undefined inputs always return undefined\n        if (typeof str === 'undefined') {\n            return undefined;\n        }\n\n        // normalize whitespace\n        var result = str.replace(/[ \\t\\n\\r]+/gm, ' ');\n        if (result.charAt(0) === ' ') {\n            // strip leading space\n            result = result.substring(1);\n        }\n        if (result.charAt(result.length - 1) === ' ') {\n            // strip trailing space\n            result = result.substring(0, result.length - 1);\n        }\n        return result;\n    }\n\n    /**\n     * Pad a string to a minimum width by adding characters to the start or end\n     * @param {string} str - string to be padded\n     * @param {number} width - the minimum width; +ve pads to the right, -ve pads to the left\n     * @param {string} [char] - the pad character(s); defaults to ' '\n     * @returns {string} - padded string\n     */\n    function pad(str, width, char) {\n        // undefined inputs always return undefined\n        if (typeof str === 'undefined') {\n            return undefined;\n        }\n\n        if (typeof char === 'undefined' || char.length === 0) {\n            char = ' ';\n        }\n\n        var result;\n        var padLength = Math.abs(width) - length(str);\n        if (padLength > 0) {\n            var padding = (new Array(padLength + 1)).join(char);\n            if (char.length > 1) {\n                padding = substring(padding, 0, padLength);\n            }\n            if (width > 0) {\n                result = str + padding;\n            } else {\n                result = padding + str;\n            }\n        } else {\n            result = str;\n        }\n        return result;\n    }\n\n    /**\n     * Evaluate the matcher function against the str arg\n     *\n     * @param {*} matcher - matching function (native or lambda)\n     * @param {string} str - the string to match against\n     * @returns {object} - structure that represents the match(es)\n     */\n    function* evaluateMatcher(matcher, str) {\n        var result = matcher.apply(this, [str]); // eslint-disable-line no-useless-call\n        if(isIterable(result)) {\n            result = yield * result;\n        }\n        if(result && !(typeof result.start === 'number' || result.end === 'number' || Array.isArray(result.groups) || isFunction(result.next))) {\n            // the matcher function didn't return the correct structure\n            throw {\n                code: \"T1010\",\n                stack: (new Error()).stack,\n            };\n        }\n        return result;\n    }\n\n    /**\n     * Tests if the str contains the token\n     * @param {String} str - string to test\n     * @param {String} token - substring or regex to find\n     * @returns {Boolean} - true if str contains token\n     */\n    function* contains(str, token) {\n        // undefined inputs always return undefined\n        if (typeof str === 'undefined') {\n            return undefined;\n        }\n\n        var result;\n\n        if (typeof token === 'string') {\n            result = (str.indexOf(token) !== -1);\n        } else {\n            var matches = yield* evaluateMatcher(token, str);\n            result = (typeof matches !== 'undefined');\n        }\n\n        return result;\n    }\n\n    /**\n     * Match a string with a regex returning an array of object containing details of each match\n     * @param {String} str - string\n     * @param {String} regex - the regex applied to the string\n     * @param {Integer} [limit] - max number of matches to return\n     * @returns {Array} The array of match objects\n     */\n    function* match(str, regex, limit) {\n        // undefined inputs always return undefined\n        if (typeof str === 'undefined') {\n            return undefined;\n        }\n\n        // limit, if specified, must be a non-negative number\n        if (limit < 0) {\n            throw {\n                stack: (new Error()).stack,\n                value: limit,\n                code: 'D3040',\n                index: 3\n            };\n        }\n\n        var result = createSequence();\n\n        if (typeof limit === 'undefined' || limit > 0) {\n            var count = 0;\n            var matches = yield* evaluateMatcher(regex, str);\n            if (typeof matches !== 'undefined') {\n                while (typeof matches !== 'undefined' && (typeof limit === 'undefined' || count < limit)) {\n                    result.push({\n                        match: matches.match,\n                        index: matches.start,\n                        groups: matches.groups\n                    });\n                    matches = yield* evaluateMatcher(matches.next);\n                    count++;\n                }\n            }\n        }\n\n        return result;\n    }\n\n    /**\n     * Match a string with a regex returning an array of object containing details of each match\n     * @param {String} str - string\n     * @param {String} pattern - the substring/regex applied to the string\n     * @param {String} replacement - text to replace the matched substrings\n     * @param {Integer} [limit] - max number of matches to return\n     * @returns {Array} The array of match objects\n     */\n    function* replace(str, pattern, replacement, limit) {\n        // undefined inputs always return undefined\n        if (typeof str === 'undefined') {\n            return undefined;\n        }\n\n        var self = this;\n\n        // pattern cannot be an empty string\n        if (pattern === '') {\n            throw {\n                code: \"D3010\",\n                stack: (new Error()).stack,\n                value: pattern,\n                index: 2\n            };\n        }\n\n        // limit, if specified, must be a non-negative number\n        if (limit < 0) {\n            throw {\n                code: \"D3011\",\n                stack: (new Error()).stack,\n                value: limit,\n                index: 4\n            };\n        }\n\n        var replacer;\n        if (typeof replacement === 'string') {\n            replacer = function (regexMatch) {\n                var substitute = '';\n                // scan forward, copying the replacement text into the substitute string\n                // and replace any occurrence of $n with the values matched by the regex\n                var position = 0;\n                var index = replacement.indexOf('$', position);\n                while (index !== -1 && position < replacement.length) {\n                    substitute += replacement.substring(position, index);\n                    position = index + 1;\n                    var dollarVal = replacement.charAt(position);\n                    if (dollarVal === '$') {\n                        // literal $\n                        substitute += '$';\n                        position++;\n                    } else if (dollarVal === '0') {\n                        substitute += regexMatch.match;\n                        position++;\n                    } else {\n                        var maxDigits;\n                        if (regexMatch.groups.length === 0) {\n                            // no sub-matches; any $ followed by a digit will be replaced by an empty string\n                            maxDigits = 1;\n                        } else {\n                            // max number of digits to parse following the $\n                            maxDigits = Math.floor(Math.log(regexMatch.groups.length) * Math.LOG10E) + 1;\n                        }\n                        index = parseInt(replacement.substring(position, position + maxDigits), 10);\n                        if (maxDigits > 1 && index > regexMatch.groups.length) {\n                            index = parseInt(replacement.substring(position, position + maxDigits - 1), 10);\n                        }\n                        if (!isNaN(index)) {\n                            if (regexMatch.groups.length > 0) {\n                                var submatch = regexMatch.groups[index - 1];\n                                if (typeof submatch !== 'undefined') {\n                                    substitute += submatch;\n                                }\n                            }\n                            position += index.toString().length;\n                        } else {\n                            // not a capture group, treat the $ as literal\n                            substitute += '$';\n                        }\n                    }\n                    index = replacement.indexOf('$', position);\n                }\n                substitute += replacement.substring(position);\n                return substitute;\n            };\n        } else {\n            replacer = replacement;\n        }\n\n        var result = '';\n        var position = 0;\n\n        if (typeof limit === 'undefined' || limit > 0) {\n            var count = 0;\n            if (typeof pattern === 'string') {\n                var index = str.indexOf(pattern, position);\n                while (index !== -1 && (typeof limit === 'undefined' || count < limit)) {\n                    result += str.substring(position, index);\n                    result += replacement;\n                    position = index + pattern.length;\n                    count++;\n                    index = str.indexOf(pattern, position);\n                }\n                result += str.substring(position);\n            } else {\n                var matches = yield* evaluateMatcher(pattern, str);\n                if (typeof matches !== 'undefined') {\n                    while (typeof matches !== 'undefined' && (typeof limit === 'undefined' || count < limit)) {\n                        result += str.substring(position, matches.start);\n                        var replacedWith = replacer.apply(self, [matches]);\n                        if (isIterable(replacedWith)) {\n                            replacedWith = yield* replacedWith;\n                        }\n                        // check replacedWith is a string\n                        if (typeof replacedWith === 'string') {\n                            result += replacedWith;\n                        } else {\n                            // not a string - throw error\n                            throw {\n                                code: \"D3012\",\n                                stack: (new Error()).stack,\n                                value: replacedWith\n                            };\n                        }\n                        position = matches.start + matches.match.length;\n                        count++;\n                        matches = yield* evaluateMatcher(matches.next);\n                    }\n                    result += str.substring(position);\n                } else {\n                    result = str;\n                }\n            }\n        } else {\n            result = str;\n        }\n\n        return result;\n    }\n\n    /**\n     * Base64 encode a string\n     * @param {String} str - string\n     * @returns {String} Base 64 encoding of the binary data\n     */\n    function base64encode(str) {\n        // undefined inputs always return undefined\n        if (typeof str === 'undefined') {\n            return undefined;\n        }\n        // Use btoa in a browser, or Buffer in Node.js\n\n        var btoa = typeof window !== 'undefined' ?\n            /* istanbul ignore next */ window.btoa :\n            function (str) {\n                // Simply doing `new Buffer` at this point causes Browserify to pull\n                // in the entire Buffer browser library, which is large and unnecessary.\n                // Using `global.Buffer` defeats this.\n                return new global.Buffer.from(str, 'binary').toString('base64'); // eslint-disable-line new-cap\n            };\n        return btoa(str);\n    }\n\n    /**\n     * Base64 decode a string\n     * @param {String} str - string\n     * @returns {String} Base 64 encoding of the binary data\n     */\n    function base64decode(str) {\n        // undefined inputs always return undefined\n        if (typeof str === 'undefined') {\n            return undefined;\n        }\n        // Use btoa in a browser, or Buffer in Node.js\n        var atob = typeof window !== 'undefined' ?\n            /* istanbul ignore next */ window.atob :\n            function (str) {\n                // Simply doing `new Buffer` at this point causes Browserify to pull\n                // in the entire Buffer browser library, which is large and unnecessary.\n                // Using `global.Buffer` defeats this.\n                return new global.Buffer.from(str, 'base64').toString('binary'); // eslint-disable-line new-cap\n            };\n        return atob(str);\n    }\n\n    /**\n     * Encode a string into a component for a url\n     * @param {String} str - String to encode\n     * @returns {string} Encoded string\n     */\n    function encodeUrlComponent(str) {\n        // undefined inputs always return undefined\n        if (typeof str === 'undefined') {\n            return undefined;\n        }\n\n        // Catch URIErrors when URI sequence is malformed\n        var returnVal;\n        try {\n            returnVal = encodeURIComponent(str);\n        } catch (e) {\n            throw {\n                code: \"D3140\",\n                stack: (new Error()).stack,\n                value: str,\n                functionName: \"encodeUrlComponent\"\n            };\n        }\n        return returnVal;\n    }\n\n    /**\n     * Encode a string into a url\n     * @param {String} str - String to encode\n     * @returns {string} Encoded string\n     */\n    function encodeUrl(str) {\n        // undefined inputs always return undefined\n        if (typeof str === 'undefined') {\n            return undefined;\n        }\n\n        // Catch URIErrors when URI sequence is malformed\n        var returnVal;\n        try {\n            returnVal = encodeURI(str);\n        } catch (e) {\n            throw {\n                code: \"D3140\",\n                stack: (new Error()).stack,\n                value: str,\n                functionName: \"encodeUrl\"\n            };\n        }\n        return returnVal;\n    }\n\n    /**\n     * Decode a string from a component for a url\n     * @param {String} str - String to decode\n     * @returns {string} Decoded string\n     */\n    function decodeUrlComponent(str) {\n        // undefined inputs always return undefined\n        if (typeof str === 'undefined') {\n            return undefined;\n        }\n\n        // Catch URIErrors when URI sequence is malformed\n        var returnVal;\n        try {\n            returnVal = decodeURIComponent(str);\n        } catch (e) {\n            throw {\n                code: \"D3140\",\n                stack: (new Error()).stack,\n                value: str,\n                functionName: \"decodeUrlComponent\"\n            };\n        }\n        return returnVal;\n    }\n\n    /**\n     * Decode a string from a url\n     * @param {String} str - String to decode\n     * @returns {string} Decoded string\n     */\n    function decodeUrl(str) {\n        // undefined inputs always return undefined\n        if (typeof str === 'undefined') {\n            return undefined;\n        }\n\n        // Catch URIErrors when URI sequence is malformed\n        var returnVal;\n        try {\n            returnVal = decodeURI(str);\n        } catch (e) {\n            throw {\n                code: \"D3140\",\n                stack: (new Error()).stack,\n                value: str,\n                functionName: \"decodeUrl\"\n            };\n        }\n        return returnVal;\n    }\n\n    /**\n     * Split a string into an array of substrings\n     * @param {String} str - string\n     * @param {String} separator - the token or regex that splits the string\n     * @param {Integer} [limit] - max number of substrings\n     * @returns {Array} The array of string\n     */\n    function* split(str, separator, limit) {\n        // undefined inputs always return undefined\n        if (typeof str === 'undefined') {\n            return undefined;\n        }\n\n        // limit, if specified, must be a non-negative number\n        if (limit < 0) {\n            throw {\n                code: \"D3020\",\n                stack: (new Error()).stack,\n                value: limit,\n                index: 3\n            };\n        }\n\n        var result = [];\n\n        if (typeof limit === 'undefined' || limit > 0) {\n            if (typeof separator === 'string') {\n                result = str.split(separator, limit);\n            } else {\n                var count = 0;\n                var matches = yield* evaluateMatcher(separator, str);\n                if (typeof matches !== 'undefined') {\n                    var start = 0;\n                    while (typeof matches !== 'undefined' && (typeof limit === 'undefined' || count < limit)) {\n                        result.push(str.substring(start, matches.start));\n                        start = matches.end;\n                        matches = yield* evaluateMatcher(matches.next);\n                        count++;\n                    }\n                    if (typeof limit === 'undefined' || count < limit) {\n                        result.push(str.substring(start));\n                    }\n                } else {\n                    result.push(str);\n                }\n            }\n        }\n\n        return result;\n    }\n\n    /**\n     * Join an array of strings\n     * @param {Array} strs - array of string\n     * @param {String} [separator] - the token that splits the string\n     * @returns {String} The concatenated string\n     */\n    function join(strs, separator) {\n        // undefined inputs always return undefined\n        if (typeof strs === 'undefined') {\n            return undefined;\n        }\n\n        // if separator is not specified, default to empty string\n        if (typeof separator === 'undefined') {\n            separator = \"\";\n        }\n\n        return strs.join(separator);\n    }\n\n    /**\n     * Formats a number into a decimal string representation using XPath 3.1 F&O fn:format-number spec\n     * @param {number} value - number to format\n     * @param {String} picture - picture string definition\n     * @param {Object} [options] - override locale defaults\n     * @returns {String} The formatted string\n     */\n    function formatNumber(value, picture, options) {\n        // undefined inputs always return undefined\n        if (typeof value === 'undefined') {\n            return undefined;\n        }\n\n        var defaults = {\n            \"decimal-separator\": \".\",\n            \"grouping-separator\": \",\",\n            \"exponent-separator\": \"e\",\n            \"infinity\": \"Infinity\",\n            \"minus-sign\": \"-\",\n            \"NaN\": \"NaN\",\n            \"percent\": \"%\",\n            \"per-mille\": \"\\u2030\",\n            \"zero-digit\": \"0\",\n            \"digit\": \"#\",\n            \"pattern-separator\": \";\"\n        };\n\n        // if `options` is specified, then its entries override defaults\n        var properties = defaults;\n        if (typeof options !== 'undefined') {\n            Object.keys(options).forEach(function (key) {\n                properties[key] = options[key];\n            });\n        }\n\n        var decimalDigitFamily = [];\n        var zeroCharCode = properties['zero-digit'].charCodeAt(0);\n        for (var ii = zeroCharCode; ii < zeroCharCode + 10; ii++) {\n            decimalDigitFamily.push(String.fromCharCode(ii));\n        }\n\n        var activeChars = decimalDigitFamily.concat([properties['decimal-separator'], properties['exponent-separator'], properties['grouping-separator'], properties.digit, properties['pattern-separator']]);\n\n        var subPictures = picture.split(properties['pattern-separator']);\n\n        if (subPictures.length > 2) {\n            throw {\n                code: 'D3080',\n                stack: (new Error()).stack\n            };\n        }\n\n        var splitParts = function (subpicture) {\n            var prefix = (function () {\n                var ch;\n                for (var ii = 0; ii < subpicture.length; ii++) {\n                    ch = subpicture.charAt(ii);\n                    if (activeChars.indexOf(ch) !== -1 && ch !== properties['exponent-separator']) {\n                        return subpicture.substring(0, ii);\n                    }\n                }\n            })();\n            var suffix = (function () {\n                var ch;\n                for (var ii = subpicture.length - 1; ii >= 0; ii--) {\n                    ch = subpicture.charAt(ii);\n                    if (activeChars.indexOf(ch) !== -1 && ch !== properties['exponent-separator']) {\n                        return subpicture.substring(ii + 1);\n                    }\n                }\n            })();\n            var activePart = subpicture.substring(prefix.length, subpicture.length - suffix.length);\n            var mantissaPart, exponentPart, integerPart, fractionalPart;\n            var exponentPosition = subpicture.indexOf(properties['exponent-separator'], prefix.length);\n            if (exponentPosition === -1 || exponentPosition > subpicture.length - suffix.length) {\n                mantissaPart = activePart;\n                exponentPart = undefined;\n            } else {\n                mantissaPart = activePart.substring(0, exponentPosition);\n                exponentPart = activePart.substring(exponentPosition + 1);\n            }\n            var decimalPosition = mantissaPart.indexOf(properties['decimal-separator']);\n            if (decimalPosition === -1) {\n                integerPart = mantissaPart;\n                fractionalPart = suffix;\n            } else {\n                integerPart = mantissaPart.substring(0, decimalPosition);\n                fractionalPart = mantissaPart.substring(decimalPosition + 1);\n            }\n            return {\n                prefix: prefix,\n                suffix: suffix,\n                activePart: activePart,\n                mantissaPart: mantissaPart,\n                exponentPart: exponentPart,\n                integerPart: integerPart,\n                fractionalPart: fractionalPart,\n                subpicture: subpicture\n            };\n        };\n\n        // validate the picture string, F&O 4.7.3\n        var validate = function (parts) {\n            var error;\n            var ii;\n            var subpicture = parts.subpicture;\n            var decimalPos = subpicture.indexOf(properties['decimal-separator']);\n            if (decimalPos !== subpicture.lastIndexOf(properties['decimal-separator'])) {\n                error = 'D3081';\n            }\n            if (subpicture.indexOf(properties.percent) !== subpicture.lastIndexOf(properties.percent)) {\n                error = 'D3082';\n            }\n            if (subpicture.indexOf(properties['per-mille']) !== subpicture.lastIndexOf(properties['per-mille'])) {\n                error = 'D3083';\n            }\n            if (subpicture.indexOf(properties.percent) !== -1 && subpicture.indexOf(properties['per-mille']) !== -1) {\n                error = 'D3084';\n            }\n            var valid = false;\n            for (ii = 0; ii < parts.mantissaPart.length; ii++) {\n                var ch = parts.mantissaPart.charAt(ii);\n                if (decimalDigitFamily.indexOf(ch) !== -1 || ch === properties.digit) {\n                    valid = true;\n                    break;\n                }\n            }\n            if (!valid) {\n                error = 'D3085';\n            }\n            var charTypes = parts.activePart.split('').map(function (char) {\n                return activeChars.indexOf(char) === -1 ? 'p' : 'a';\n            }).join('');\n            if (charTypes.indexOf('p') !== -1) {\n                error = 'D3086';\n            }\n            if (decimalPos !== -1) {\n                if (subpicture.charAt(decimalPos - 1) === properties['grouping-separator'] || subpicture.charAt(decimalPos + 1) === properties['grouping-separator']) {\n                    error = 'D3087';\n                }\n            } else if (parts.integerPart.charAt(parts.integerPart.length - 1) === properties['grouping-separator']) {\n                error = 'D3088';\n            }\n            if (subpicture.indexOf(properties['grouping-separator'] + properties['grouping-separator']) !== -1) {\n                error = 'D3089';\n            }\n            var optionalDigitPos = parts.integerPart.indexOf(properties.digit);\n            if (optionalDigitPos !== -1 && parts.integerPart.substring(0, optionalDigitPos).split('').filter(function (char) {\n                return decimalDigitFamily.indexOf(char) > -1;\n            }).length > 0) {\n                error = 'D3090';\n            }\n            optionalDigitPos = parts.fractionalPart.lastIndexOf(properties.digit);\n            if (optionalDigitPos !== -1 && parts.fractionalPart.substring(optionalDigitPos).split('').filter(function (char) {\n                return decimalDigitFamily.indexOf(char) > -1;\n            }).length > 0) {\n                error = 'D3091';\n            }\n            var exponentExists = (typeof parts.exponentPart === 'string');\n            if (exponentExists && parts.exponentPart.length > 0 && (subpicture.indexOf(properties.percent) !== -1 || subpicture.indexOf(properties['per-mille']) !== -1)) {\n                error = 'D3092';\n            }\n            if (exponentExists && (parts.exponentPart.length === 0 || parts.exponentPart.split('').filter(function (char) {\n                return decimalDigitFamily.indexOf(char) === -1;\n            }).length > 0)) {\n                error = 'D3093';\n            }\n            if (error) {\n                throw {\n                    code: error,\n                    stack: (new Error()).stack\n                };\n            }\n        };\n\n        // analyse the picture string, F&O 4.7.4\n        var analyse = function (parts) {\n            var getGroupingPositions = function (part, toLeft) {\n                var positions = [];\n                var groupingPosition = part.indexOf(properties['grouping-separator']);\n                while (groupingPosition !== -1) {\n                    var charsToTheRight = (toLeft ? part.substring(0, groupingPosition) : part.substring(groupingPosition)).split('').filter(function (char) {\n                        return decimalDigitFamily.indexOf(char) !== -1 || char === properties.digit;\n                    }).length;\n                    positions.push(charsToTheRight);\n                    groupingPosition = parts.integerPart.indexOf(properties['grouping-separator'], groupingPosition + 1);\n                }\n                return positions;\n            };\n            var integerPartGroupingPositions = getGroupingPositions(parts.integerPart);\n            var regular = function (indexes) {\n                // are the grouping positions regular? i.e. same interval between each of them\n                if (indexes.length === 0) {\n                    return 0;\n                }\n                var gcd = function (a, b) {\n                    return b === 0 ? a : gcd(b, a % b);\n                };\n                // find the greatest common divisor of all the positions\n                var factor = indexes.reduce(gcd);\n                // is every position separated by this divisor? If so, it's regular\n                for (var index = 1; index <= indexes.length; index++) {\n                    if (indexes.indexOf(index * factor) === -1) {\n                        return 0;\n                    }\n                }\n                return factor;\n            };\n\n            var regularGrouping = regular(integerPartGroupingPositions);\n            var fractionalPartGroupingPositions = getGroupingPositions(parts.fractionalPart, true);\n\n            var minimumIntegerPartSize = parts.integerPart.split('').filter(function (char) {\n                return decimalDigitFamily.indexOf(char) !== -1;\n            }).length;\n            var scalingFactor = minimumIntegerPartSize;\n\n            var fractionalPartArray = parts.fractionalPart.split('');\n            var minimumFactionalPartSize = fractionalPartArray.filter(function (char) {\n                return decimalDigitFamily.indexOf(char) !== -1;\n            }).length;\n            var maximumFactionalPartSize = fractionalPartArray.filter(function (char) {\n                return decimalDigitFamily.indexOf(char) !== -1 || char === properties.digit;\n            }).length;\n            var exponentPresent = typeof parts.exponentPart === 'string';\n            if (minimumIntegerPartSize === 0 && maximumFactionalPartSize === 0) {\n                if (exponentPresent) {\n                    minimumFactionalPartSize = 1;\n                    maximumFactionalPartSize = 1;\n                } else {\n                    minimumIntegerPartSize = 1;\n                }\n            }\n            if (exponentPresent && minimumIntegerPartSize === 0 && parts.integerPart.indexOf(properties.digit) !== -1) {\n                minimumIntegerPartSize = 1;\n            }\n            if (minimumIntegerPartSize === 0 && minimumFactionalPartSize === 0) {\n                minimumFactionalPartSize = 1;\n            }\n            var minimumExponentSize = 0;\n            if (exponentPresent) {\n                minimumExponentSize = parts.exponentPart.split('').filter(function (char) {\n                    return decimalDigitFamily.indexOf(char) !== -1;\n                }).length;\n            }\n\n            return {\n                integerPartGroupingPositions: integerPartGroupingPositions,\n                regularGrouping: regularGrouping,\n                minimumIntegerPartSize: minimumIntegerPartSize,\n                scalingFactor: scalingFactor,\n                prefix: parts.prefix,\n                fractionalPartGroupingPositions: fractionalPartGroupingPositions,\n                minimumFactionalPartSize: minimumFactionalPartSize,\n                maximumFactionalPartSize: maximumFactionalPartSize,\n                minimumExponentSize: minimumExponentSize,\n                suffix: parts.suffix,\n                picture: parts.subpicture\n            };\n        };\n\n        var parts = subPictures.map(splitParts);\n        parts.forEach(validate);\n\n        var variables = parts.map(analyse);\n\n        var minus_sign = properties['minus-sign'];\n        var zero_digit = properties['zero-digit'];\n        var decimal_separator = properties['decimal-separator'];\n        var grouping_separator = properties['grouping-separator'];\n\n        if (variables.length === 1) {\n            variables.push(JSON.parse(JSON.stringify(variables[0])));\n            variables[1].prefix = minus_sign + variables[1].prefix;\n        }\n\n        // TODO cache the result of the analysis\n\n        // format the number\n        // bullet 1: TODO: NaN - not sure we'd ever get this in JSON\n        var pic;\n        // bullet 2:\n        if (value >= 0) {\n            pic = variables[0];\n        } else {\n            pic = variables[1];\n        }\n        var adjustedNumber;\n        // bullet 3:\n        if (pic.picture.indexOf(properties.percent) !== -1) {\n            adjustedNumber = value * 100;\n        } else if (pic.picture.indexOf(properties['per-mille']) !== -1) {\n            adjustedNumber = value * 1000;\n        } else {\n            adjustedNumber = value;\n        }\n        // bullet 4:\n        // TODO: infinity - not sure we'd ever get this in JSON\n        // bullet 5:\n        var mantissa, exponent;\n        if (pic.minimumExponentSize === 0) {\n            mantissa = adjustedNumber;\n        } else {\n            // mantissa * 10^exponent = adjustedNumber\n            var maxMantissa = Math.pow(10, pic.scalingFactor);\n            var minMantissa = Math.pow(10, pic.scalingFactor - 1);\n            mantissa = adjustedNumber;\n            exponent = 0;\n            while (mantissa < minMantissa) {\n                mantissa *= 10;\n                exponent -= 1;\n            }\n            while (mantissa > maxMantissa) {\n                mantissa /= 10;\n                exponent += 1;\n            }\n        }\n        // bullet 6:\n        var roundedNumber = round(mantissa, pic.maximumFactionalPartSize);\n        // bullet 7:\n        var makeString = function (value, dp) {\n            var str = Math.abs(value).toFixed(dp);\n            if (zero_digit !== '0') {\n                str = str.split('').map(function (digit) {\n                    if (digit >= '0' && digit <= '9') {\n                        return decimalDigitFamily[digit.charCodeAt(0) - 48];\n                    } else {\n                        return digit;\n                    }\n                }).join('');\n            }\n            return str;\n        };\n        var stringValue = makeString(roundedNumber, pic.maximumFactionalPartSize);\n        var decimalPos = stringValue.indexOf('.');\n        if (decimalPos === -1) {\n            stringValue = stringValue + decimal_separator;\n        } else {\n            stringValue = stringValue.replace('.', decimal_separator);\n        }\n        while (stringValue.charAt(0) === zero_digit) {\n            stringValue = stringValue.substring(1);\n        }\n        while (stringValue.charAt(stringValue.length - 1) === zero_digit) {\n            stringValue = stringValue.substring(0, stringValue.length - 1);\n        }\n        // bullets 8 & 9:\n        decimalPos = stringValue.indexOf(decimal_separator);\n        var padLeft = pic.minimumIntegerPartSize - decimalPos;\n        var padRight = pic.minimumFactionalPartSize - (stringValue.length - decimalPos - 1);\n        stringValue = (padLeft > 0 ? new Array(padLeft + 1).join(zero_digit) : '') + stringValue;\n        stringValue = stringValue + (padRight > 0 ? new Array(padRight + 1).join(zero_digit) : '');\n        decimalPos = stringValue.indexOf(decimal_separator);\n        // bullet 10:\n        if (pic.regularGrouping > 0) {\n            var groupCount = Math.floor((decimalPos - 1) / pic.regularGrouping);\n            for (var group = 1; group <= groupCount; group++) {\n                stringValue = [stringValue.slice(0, decimalPos - group * pic.regularGrouping), grouping_separator, stringValue.slice(decimalPos - group * pic.regularGrouping)].join('');\n            }\n        } else {\n            pic.integerPartGroupingPositions.forEach(function (pos) {\n                stringValue = [stringValue.slice(0, decimalPos - pos), grouping_separator, stringValue.slice(decimalPos - pos)].join('');\n                decimalPos++;\n            });\n        }\n        // bullet 11:\n        decimalPos = stringValue.indexOf(decimal_separator);\n        pic.fractionalPartGroupingPositions.forEach(function (pos) {\n            stringValue = [stringValue.slice(0, pos + decimalPos + 1), grouping_separator, stringValue.slice(pos + decimalPos + 1)].join('');\n        });\n        // bullet 12:\n        decimalPos = stringValue.indexOf(decimal_separator);\n        if (pic.picture.indexOf(decimal_separator) === -1 || decimalPos === stringValue.length - 1) {\n            stringValue = stringValue.substring(0, stringValue.length - 1);\n        }\n        // bullet 13:\n        if (typeof exponent !== 'undefined') {\n            var stringExponent = makeString(exponent, 0);\n            padLeft = pic.minimumExponentSize - stringExponent.length;\n            if (padLeft > 0) {\n                stringExponent = new Array(padLeft + 1).join(zero_digit) + stringExponent;\n            }\n            stringValue = stringValue + properties['exponent-separator'] + (exponent < 0 ? minus_sign : '') + stringExponent;\n        }\n        // bullet 14:\n        stringValue = pic.prefix + stringValue + pic.suffix;\n        return stringValue;\n    }\n\n    /**\n     * Converts a number to a string using a specified number base\n     * @param {number} value - the number to convert\n     * @param {number} [radix] - the number base; must be between 2 and 36. Defaults to 10\n     * @returns {string} - the converted string\n     */\n    function formatBase(value, radix) {\n        // undefined inputs always return undefined\n        if (typeof value === 'undefined') {\n            return undefined;\n        }\n\n        value = round(value);\n\n        if (typeof radix === 'undefined') {\n            radix = 10;\n        } else {\n            radix = round(radix);\n        }\n\n        if (radix < 2 || radix > 36) {\n            throw {\n                code: 'D3100',\n                stack: (new Error()).stack,\n                value: radix\n            };\n\n        }\n\n        var result = value.toString(radix);\n\n        return result;\n    }\n\n    /**\n     * Cast argument to number\n     * @param {Object} arg - Argument\n     * @returns {Number} numeric value of argument\n     */\n    function number(arg) {\n        var result;\n\n        // undefined inputs always return undefined\n        if (typeof arg === 'undefined') {\n            return undefined;\n        }\n\n        if (typeof arg === 'number') {\n            // already a number\n            result = arg;\n        } else if (typeof arg === 'string' && /^-?[0-9]+(\\.[0-9]+)?([Ee][-+]?[0-9]+)?$/.test(arg) && !isNaN(parseFloat(arg)) && isFinite(arg)) {\n            result = parseFloat(arg);\n        } else if (arg === true) {\n            // boolean true casts to 1\n            result = 1;\n        } else if (arg === false) {\n            // boolean false casts to 0\n            result = 0;\n        } else {\n            throw {\n                code: \"D3030\",\n                value: arg,\n                stack: (new Error()).stack,\n                index: 1\n            };\n        }\n        return result;\n    }\n\n    /**\n     * Absolute value of a number\n     * @param {Number} arg - Argument\n     * @returns {Number} absolute value of argument\n     */\n    function abs(arg) {\n        var result;\n\n        // undefined inputs always return undefined\n        if (typeof arg === 'undefined') {\n            return undefined;\n        }\n\n        result = Math.abs(arg);\n        return result;\n    }\n\n    /**\n     * Rounds a number down to integer\n     * @param {Number} arg - Argument\n     * @returns {Number} rounded integer\n     */\n    function floor(arg) {\n        var result;\n\n        // undefined inputs always return undefined\n        if (typeof arg === 'undefined') {\n            return undefined;\n        }\n\n        result = Math.floor(arg);\n        return result;\n    }\n\n    /**\n     * Rounds a number up to integer\n     * @param {Number} arg - Argument\n     * @returns {Number} rounded integer\n     */\n    function ceil(arg) {\n        var result;\n\n        // undefined inputs always return undefined\n        if (typeof arg === 'undefined') {\n            return undefined;\n        }\n\n        result = Math.ceil(arg);\n        return result;\n    }\n\n    /**\n     * Round to half even\n     * @param {Number} arg - Argument\n     * @param {Number} [precision] - number of decimal places\n     * @returns {Number} rounded integer\n     */\n    function round(arg, precision) {\n        var result;\n\n        // undefined inputs always return undefined\n        if (typeof arg === 'undefined') {\n            return undefined;\n        }\n\n        if (precision) {\n            // shift the decimal place - this needs to be done in a string since multiplying\n            // by a power of ten can introduce floating point precision errors which mess up\n            // this rounding algorithm - See 'Decimal rounding' in\n            // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/round\n            // Shift\n            var value = arg.toString().split('e');\n            arg = +(value[0] + 'e' + (value[1] ? (+value[1] + precision) : precision));\n\n        }\n\n        // round up to nearest int\n        result = Math.round(arg);\n        var diff = result - arg;\n        if (Math.abs(diff) === 0.5 && Math.abs(result % 2) === 1) {\n            // rounded the wrong way - adjust to nearest even number\n            result = result - 1;\n        }\n        if (precision) {\n            // Shift back\n            value = result.toString().split('e');\n            /* istanbul ignore next */\n            result = +(value[0] + 'e' + (value[1] ? (+value[1] - precision) : -precision));\n        }\n        if (Object.is(result, -0)) { // ESLint rule 'no-compare-neg-zero' suggests this way\n            // JSON doesn't do -0\n            result = 0;\n        }\n        return result;\n    }\n\n    /**\n     * Square root of number\n     * @param {Number} arg - Argument\n     * @returns {Number} square root\n     */\n    function sqrt(arg) {\n        var result;\n\n        // undefined inputs always return undefined\n        if (typeof arg === 'undefined') {\n            return undefined;\n        }\n\n        if (arg < 0) {\n            throw {\n                stack: (new Error()).stack,\n                code: \"D3060\",\n                index: 1,\n                value: arg\n            };\n        }\n\n        result = Math.sqrt(arg);\n\n        return result;\n    }\n\n    /**\n     * Raises number to the power of the second number\n     * @param {Number} arg - the base\n     * @param {Number} exp - the exponent\n     * @returns {Number} rounded integer\n     */\n    function power(arg, exp) {\n        var result;\n\n        // undefined inputs always return undefined\n        if (typeof arg === 'undefined') {\n            return undefined;\n        }\n\n        result = Math.pow(arg, exp);\n\n        if (!isFinite(result)) {\n            throw {\n                stack: (new Error()).stack,\n                code: \"D3061\",\n                index: 1,\n                value: arg,\n                exp: exp\n            };\n        }\n\n        return result;\n    }\n\n    /**\n     * Returns a random number 0 <= n < 1\n     * @returns {number} random number\n     */\n    function random() {\n        return Math.random();\n    }\n\n    /**\n     * Evaluate an input and return a boolean\n     * @param {*} arg - Arguments\n     * @returns {boolean} Boolean\n     */\n    function boolean(arg) {\n        // cast arg to its effective boolean value\n        // boolean: unchanged\n        // string: zero-length -> false; otherwise -> true\n        // number: 0 -> false; otherwise -> true\n        // null -> false\n        // array: empty -> false; length > 1 -> true\n        // object: empty -> false; non-empty -> true\n        // function -> false\n\n        // undefined inputs always return undefined\n        if (typeof arg === 'undefined') {\n            return undefined;\n        }\n\n        var result = false;\n        if (Array.isArray(arg)) {\n            if (arg.length === 1) {\n                result = boolean(arg[0]);\n            } else if (arg.length > 1) {\n                var trues = arg.filter(function (val) {\n                    return boolean(val);\n                });\n                result = trues.length > 0;\n            }\n        } else if (typeof arg === 'string') {\n            if (arg.length > 0) {\n                result = true;\n            }\n        } else if (isNumeric(arg)) {\n            if (arg !== 0) {\n                result = true;\n            }\n        } else if (arg !== null && typeof arg === 'object') {\n            if (Object.keys(arg).length > 0) {\n                result = true;\n            }\n        } else if (typeof arg === 'boolean' && arg === true) {\n            result = true;\n        }\n        return result;\n    }\n\n    /**\n     * returns the Boolean NOT of the arg\n     * @param {*} arg - argument\n     * @returns {boolean} - NOT arg\n     */\n    function not(arg) {\n        // undefined inputs always return undefined\n        if (typeof arg === 'undefined') {\n            return undefined;\n        }\n\n        return !boolean(arg);\n    }\n\n    /**\n     * Helper function to build the arguments to be supplied to the function arg of the\n     * HOFs map, filter, each, sift and single\n     * @param {function} func - the function to be invoked\n     * @param {*} arg1 - the first (required) arg - the value\n     * @param {*} arg2 - the second (optional) arg - the position (index or key)\n     * @param {*} arg3 - the third (optional) arg - the whole structure (array or object)\n     * @returns {*[]} the argument list\n     */\n    function hofFuncArgs(func, arg1, arg2, arg3) {\n        var func_args = [arg1]; // the first arg (the value) is required\n        // the other two are optional - only supply it if the function can take it\n        var length = getFunctionArity(func);\n        if (length >= 2) {\n            func_args.push(arg2);\n        }\n        if (length >= 3) {\n            func_args.push(arg3);\n        }\n        return func_args;\n    }\n\n    /**\n     * Create a map from an array of arguments\n     * @param {Array} [arr] - array to map over\n     * @param {Function} func - function to apply\n     * @returns {Array} Map array\n     */\n    function* map(arr, func) {\n        // undefined inputs always return undefined\n        if (typeof arr === 'undefined') {\n            return undefined;\n        }\n\n        var result = createSequence();\n        // do the map - iterate over the arrays, and invoke func\n        for (var i = 0; i < arr.length; i++) {\n            var func_args = hofFuncArgs(func, arr[i], i, arr);\n            // invoke func\n            var res = yield* func.apply(this, func_args);\n            if (typeof res !== 'undefined') {\n                result.push(res);\n            }\n        }\n\n        return result;\n    }\n\n    /**\n     * Create a map from an array of arguments\n     * @param {Array} [arr] - array to filter\n     * @param {Function} func - predicate function\n     * @returns {Array} Map array\n     */\n    function* filter(arr, func) { // eslint-disable-line require-yield\n        // undefined inputs always return undefined\n        if (typeof arr === 'undefined') {\n            return undefined;\n        }\n\n        var result = createSequence();\n\n        for (var i = 0; i < arr.length; i++) {\n            var entry = arr[i];\n            var func_args = hofFuncArgs(func, entry, i, arr);\n            // invoke func\n            var res = yield* func.apply(this, func_args);\n            if (boolean(res)) {\n                result.push(entry);\n            }\n        }\n\n        return result;\n    }\n\n    /**\n     * Given an array, find the single element matching a specified condition\n     * Throws an exception if the number of matching elements is not exactly one\n     * @param {Array} [arr] - array to filter\n     * @param {Function} [func] - predicate function\n     * @returns {*} Matching element\n     */\n    function* single(arr, func) { // eslint-disable-line require-yield\n        // undefined inputs always return undefined\n        if (typeof arr === 'undefined') {\n            return undefined;\n        }\n\n        var hasFoundMatch = false;\n        var result;\n\n        for (var i = 0; i < arr.length; i++) {\n            var entry = arr[i];\n            var positiveResult = true;\n            if (typeof func !== 'undefined') {\n                var func_args = hofFuncArgs(func, entry, i, arr);\n                // invoke func\n                var res = yield* func.apply(this, func_args);\n                positiveResult = boolean(res);\n            }\n            if (positiveResult) {\n                if(!hasFoundMatch) {\n                    result = entry;\n                    hasFoundMatch = true;\n                } else {\n                    throw {\n                        stack: (new Error()).stack,\n                        code: \"D3138\",\n                        index: i\n                    };\n                }\n            }\n        }\n\n        if(!hasFoundMatch) {\n            throw {\n                stack: (new Error()).stack,\n                code: \"D3139\"\n            };\n        }\n\n        return result;\n    }\n\n    /**\n     * Convolves (zips) each value from a set of arrays\n     * @param {Array} [args] - arrays to zip\n     * @returns {Array} Zipped array\n     */\n    function zip() {\n        // this can take a variable number of arguments\n        var result = [];\n        var args = Array.prototype.slice.call(arguments);\n        // length of the shortest array\n        var length = Math.min.apply(Math, args.map(function (arg) {\n            if (Array.isArray(arg)) {\n                return arg.length;\n            }\n            return 0;\n        }));\n        for (var i = 0; i < length; i++) {\n            var tuple = args.map((arg) => {\n                return arg[i];\n            });\n            result.push(tuple);\n        }\n        return result;\n    }\n\n    /**\n     * Fold left function\n     * @param {Array} sequence - Sequence\n     * @param {Function} func - Function\n     * @param {Object} init - Initial value\n     * @returns {*} Result\n     */\n    function* foldLeft(sequence, func, init) {\n        // undefined inputs always return undefined\n        if (typeof sequence === 'undefined') {\n            return undefined;\n        }\n\n        var result;\n\n        var arity = getFunctionArity(func);\n        if (arity < 2) {\n            throw {\n                stack: (new Error()).stack,\n                code: \"D3050\",\n                index: 1\n            };\n        }\n\n        var index;\n        if (typeof init === 'undefined' && sequence.length > 0) {\n            result = sequence[0];\n            index = 1;\n        } else {\n            result = init;\n            index = 0;\n        }\n\n        while (index < sequence.length) {\n            var args = [result, sequence[index]];\n            if (arity >= 3) {\n                args.push(index);\n            }\n            if (arity >= 4) {\n                args.push(sequence);\n            }\n            result = yield* func.apply(this, args);\n            index++;\n        }\n\n        return result;\n    }\n\n    /**\n     * Return keys for an object\n     * @param {Object} arg - Object\n     * @returns {Array} Array of keys\n     */\n    function keys(arg) {\n        var result = createSequence();\n\n        if (Array.isArray(arg)) {\n            // merge the keys of all of the items in the array\n            var merge = {};\n            arg.forEach(function (item) {\n                var allkeys = keys(item);\n                allkeys.forEach(function (key) {\n                    merge[key] = true;\n                });\n            });\n            result = keys(merge);\n        } else if (arg !== null && typeof arg === 'object' && !(isLambda(arg))) {\n            Object.keys(arg).forEach(key => result.push(key));\n        }\n        return result;\n    }\n\n    /**\n     * Return value from an object for a given key\n     * @param {Object} input - Object/Array\n     * @param {String} key - Key in object\n     * @returns {*} Value of key in object\n     */\n    function lookup(input, key) {\n        // lookup the 'name' item in the input\n        var result;\n        if (Array.isArray(input)) {\n            result = createSequence();\n            for(var ii = 0; ii < input.length; ii++) {\n                var res =  lookup(input[ii], key);\n                if (typeof res !== 'undefined') {\n                    if (Array.isArray(res)) {\n                        res.forEach(val => result.push(val));\n                    } else {\n                        result.push(res);\n                    }\n                }\n            }\n        } else if (input !== null && typeof input === 'object') {\n            result = input[key];\n        }\n        return result;\n    }\n\n    /**\n     * Append second argument to first\n     * @param {Array|Object} arg1 - First argument\n     * @param {Array|Object} arg2 - Second argument\n     * @returns {*} Appended arguments\n     */\n    function append(arg1, arg2) {\n        // disregard undefined args\n        if (typeof arg1 === 'undefined') {\n            return arg2;\n        }\n        if (typeof arg2 === 'undefined') {\n            return arg1;\n        }\n        // if either argument is not an array, make it so\n        if (!Array.isArray(arg1)) {\n            arg1 = createSequence(arg1);\n        }\n        if (!Array.isArray(arg2)) {\n            arg2 = [arg2];\n        }\n        return arg1.concat(arg2);\n    }\n\n    /**\n     * Determines if the argument is undefined\n     * @param {*} arg - argument\n     * @returns {boolean} False if argument undefined, otherwise true\n     */\n    function exists(arg) {\n        if (typeof arg === 'undefined') {\n            return false;\n        } else {\n            return true;\n        }\n    }\n\n    /**\n     * Splits an object into an array of object with one property each\n     * @param {*} arg - the object to split\n     * @returns {*} - the array\n     */\n    function spread(arg) {\n        var result = createSequence();\n\n        if (Array.isArray(arg)) {\n            // spread all of the items in the array\n            arg.forEach(function (item) {\n                result = append(result, spread(item));\n            });\n        } else if (arg !== null && typeof arg === 'object' && !isLambda(arg)) {\n            for (var key in arg) {\n                var obj = {};\n                obj[key] = arg[key];\n                result.push(obj);\n            }\n        } else {\n            result = arg;\n        }\n        return result;\n    }\n\n    /**\n     * Merges an array of objects into a single object.  Duplicate properties are\n     * overridden by entries later in the array\n     * @param {*} arg - the objects to merge\n     * @returns {*} - the object\n     */\n    function merge(arg) {\n        // undefined inputs always return undefined\n        if (typeof arg === 'undefined') {\n            return undefined;\n        }\n\n        var result = {};\n\n        arg.forEach(function (obj) {\n            for (var prop in obj) {\n                result[prop] = obj[prop];\n            }\n        });\n        return result;\n    }\n\n    /**\n     * Reverses the order of items in an array\n     * @param {Array} arr - the array to reverse\n     * @returns {Array} - the reversed array\n     */\n    function reverse(arr) {\n        // undefined inputs always return undefined\n        if (typeof arr === 'undefined') {\n            return undefined;\n        }\n\n        if (arr.length <= 1) {\n            return arr;\n        }\n\n        var length = arr.length;\n        var result = new Array(length);\n        for (var i = 0; i < length; i++) {\n            result[length - i - 1] = arr[i];\n        }\n\n        return result;\n    }\n\n    /**\n     *\n     * @param {*} obj - the input object to iterate over\n     * @param {*} func - the function to apply to each key/value pair\n     * @returns {Array} - the resultant array\n     */\n    function* each(obj, func) {\n        var result = createSequence();\n\n        for (var key in obj) {\n            var func_args = hofFuncArgs(func, obj[key], key, obj);\n            // invoke func\n            var val = yield* func.apply(this, func_args);\n            if(typeof val !== 'undefined') {\n                result.push(val);\n            }\n        }\n\n        return result;\n    }\n\n    /**\n     *\n     * @param {string} [message] - the message to attach to the error\n     * @throws custom error with code 'D3137'\n     */\n    function error(message) {\n        throw {\n            code: \"D3137\",\n            stack: (new Error()).stack,\n            message: message || \"$error() function evaluated\"\n        };\n    }\n\n    /**\n     *\n     * @param {boolean} condition - the condition to evaluate\n     * @param {string} [message] - the message to attach to the error\n     * @throws custom error with code 'D3137'\n     * @returns {undefined}\n     */\n    function assert(condition, message) {\n        if(!condition) {\n            throw {\n                code: \"D3141\",\n                stack: (new Error()).stack,\n                message: message || \"$assert() statement failed\"\n            };\n        }\n\n        return undefined;\n    }\n\n    /**\n     *\n     * @param {*} [value] - the input to which the type will be checked\n     * @returns {string} - the type of the input\n     */\n    function type(value) {\n        if (value === undefined) {\n            return undefined;\n        }\n\n        if (value === null) {\n            return 'null';\n        }\n\n        if (isNumeric(value)) {\n            return 'number';\n        }\n\n        if (typeof value === 'string') {\n            return 'string';\n        }\n\n        if (typeof value === 'boolean') {\n            return 'boolean';\n        }\n\n        if(Array.isArray(value)) {\n            return 'array';\n        }\n\n        if(isFunction(value)) {\n            return 'function';\n        }\n\n        return 'object';\n    }\n\n    /**\n     * Implements the merge sort (stable) with optional comparator function\n     *\n     * @param {Array} arr - the array to sort\n     * @param {*} comparator - comparator function\n     * @returns {Array} - sorted array\n     */\n    function* sort(arr, comparator) {\n        // undefined inputs always return undefined\n        if (typeof arr === 'undefined') {\n            return undefined;\n        }\n\n        if (arr.length <= 1) {\n            return arr;\n        }\n\n        var comp;\n        if (typeof comparator === 'undefined') {\n            // inject a default comparator - only works for numeric or string arrays\n            if (!isArrayOfNumbers(arr) && !isArrayOfStrings(arr)) {\n                throw {\n                    stack: (new Error()).stack,\n                    code: \"D3070\",\n                    index: 1\n                };\n            }\n\n            comp = function* (a, b) {  // eslint-disable-line require-yield\n                return a > b;\n            };\n        } else {\n            // for internal usage of functionSort (i.e. order-by syntax)\n            comp = comparator;\n        }\n\n        var merge = function* (l, r) {\n            var merge_iter = function* (result, left, right) {\n                if (left.length === 0) {\n                    Array.prototype.push.apply(result, right);\n                } else if (right.length === 0) {\n                    Array.prototype.push.apply(result, left);\n                } else if (yield* comp(left[0], right[0])) { // invoke the comparator function\n                    // if it returns true - swap left and right\n                    result.push(right[0]);\n                    yield* merge_iter(result, left, right.slice(1));\n                } else {\n                    // otherwise keep the same order\n                    result.push(left[0]);\n                    yield* merge_iter(result, left.slice(1), right);\n                }\n            };\n            var merged = [];\n            yield* merge_iter(merged, l, r);\n            return merged;\n        };\n\n        var msort = function* (array) {\n            if (!Array.isArray(array) || array.length <= 1) {\n                return array;\n            } else {\n                var middle = Math.floor(array.length / 2);\n                var left = array.slice(0, middle);\n                var right = array.slice(middle);\n                left = yield* msort(left);\n                right = yield* msort(right);\n                return yield* merge(left, right);\n            }\n        };\n\n        var result = yield* msort(arr);\n\n        return result;\n    }\n\n    /**\n     * Randomly shuffles the contents of an array\n     * @param {Array} arr - the input array\n     * @returns {Array} the shuffled array\n     */\n    function shuffle(arr) {\n        // undefined inputs always return undefined\n        if (typeof arr === 'undefined') {\n            return undefined;\n        }\n\n        if (arr.length <= 1) {\n            return arr;\n        }\n\n        // shuffle using the 'inside-out' variant of the Fisher-Yates algorithm\n        var result = new Array(arr.length);\n        for (var i = 0; i < arr.length; i++) {\n            var j = Math.floor(Math.random() * (i + 1)); // random integer such that 0 ≤ j ≤ i\n            if (i !== j) {\n                result[i] = result[j];\n            }\n            result[j] = arr[i];\n        }\n\n        return result;\n    }\n\n    /**\n     * Returns the values that appear in a sequence, with duplicates eliminated.\n     * @param {Array} arr - An array or sequence of values\n     * @returns {Array} - sequence of distinct values\n     */\n    function distinct(arr) {\n        // undefined inputs always return undefined\n        if (typeof arr === 'undefined') {\n            return undefined;\n        }\n\n        if(!Array.isArray(arr) || arr.length <= 1) {\n            return arr;\n        }\n\n        var results = isSequence(arr) ? createSequence() : [];\n\n        for(var ii = 0; ii < arr.length; ii++) {\n            var value = arr[ii];\n            // is this value already in the result sequence?\n            var includes = false;\n            for(var jj = 0; jj < results.length; jj++) {\n                if (deepEquals(value, results[jj])) {\n                    includes = true;\n                    break;\n                }\n            }\n            if(!includes) {\n                results.push(value);\n            }\n        }\n        return results;\n    }\n\n    /**\n     * Applies a predicate function to each key/value pair in an object, and returns an object containing\n     * only the key/value pairs that passed the predicate\n     *\n     * @param {object} arg - the object to be sifted\n     * @param {object} func - the predicate function (lambda or native)\n     * @returns {object} - sifted object\n     */\n    function* sift(arg, func) {\n        var result = {};\n\n        for (var item in arg) {\n            var entry = arg[item];\n            var func_args = hofFuncArgs(func, entry, item, arg);\n            // invoke func\n            var res = yield* func.apply(this, func_args);\n            if (boolean(res)) {\n                result[item] = entry;\n            }\n        }\n\n        // empty objects should be changed to undefined\n        if (Object.keys(result).length === 0) {\n            result = undefined;\n        }\n\n        return result;\n    }\n\n    return {\n        sum, count, max, min, average,\n        string, substring, substringBefore, substringAfter, lowercase, uppercase, length, trim, pad,\n        match, contains, replace, split, join,\n        formatNumber, formatBase, number, floor, ceil, round, abs, sqrt, power, random,\n        boolean, not,\n        map, zip, filter, single, foldLeft, sift,\n        keys, lookup, append, exists, spread, merge, reverse, each, error, assert, type, sort, shuffle, distinct,\n        base64encode, base64decode,  encodeUrlComponent, encodeUrl, decodeUrlComponent, decodeUrl\n    };\n})();\n\nmodule.exports = functions;\n\n}).call(this)}).call(this,typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n},{\"./utils\":6}],3:[function(require,module,exports){\n/**\n * © Copyright IBM Corp. 2016, 2017 All Rights Reserved\n *   Project name: JSONata\n *   This project is licensed under the MIT License, see LICENSE\n */\n\n/**\n * @module JSONata\n * @description JSON query and transformation language\n */\n\nvar datetime = require('./datetime');\nvar fn = require('./functions');\nvar utils = require('./utils');\nvar parser = require('./parser');\nvar parseSignature = require('./signature');\n\n/**\n * jsonata\n * @function\n * @param {Object} expr - JSONata expression\n * @returns {{evaluate: evaluate, assign: assign}} Evaluated expression\n */\nvar jsonata = (function() {\n    'use strict';\n\n    var isNumeric = utils.isNumeric;\n    var isArrayOfStrings = utils.isArrayOfStrings;\n    var isArrayOfNumbers = utils.isArrayOfNumbers;\n    var createSequence = utils.createSequence;\n    var isSequence = utils.isSequence;\n    var isFunction = utils.isFunction;\n    var isLambda = utils.isLambda;\n    var isIterable = utils.isIterable;\n    var getFunctionArity = utils.getFunctionArity;\n    var isDeepEqual = utils.isDeepEqual;\n\n    // Start of Evaluator code\n\n    var staticFrame = createFrame(null);\n\n    /**\n     * Evaluate expression against input data\n     * @param {Object} expr - JSONata expression\n     * @param {Object} input - Input data to evaluate against\n     * @param {Object} environment - Environment\n     * @returns {*} Evaluated input data\n     */\n    function* evaluate(expr, input, environment) {\n        var result;\n\n        var entryCallback = environment.lookup('__evaluate_entry');\n        if(entryCallback) {\n            entryCallback(expr, input, environment);\n        }\n\n        switch (expr.type) {\n            case 'path':\n                result = yield * evaluatePath(expr, input, environment);\n                break;\n            case 'binary':\n                result = yield * evaluateBinary(expr, input, environment);\n                break;\n            case 'unary':\n                result = yield * evaluateUnary(expr, input, environment);\n                break;\n            case 'name':\n                result = evaluateName(expr, input, environment);\n                break;\n            case 'string':\n            case 'number':\n            case 'value':\n                result = evaluateLiteral(expr, input, environment);\n                break;\n            case 'wildcard':\n                result = evaluateWildcard(expr, input, environment);\n                break;\n            case 'descendant':\n                result = evaluateDescendants(expr, input, environment);\n                break;\n            case 'parent':\n                result = environment.lookup(expr.slot.label);\n                break;\n            case 'condition':\n                result = yield * evaluateCondition(expr, input, environment);\n                break;\n            case 'block':\n                result = yield * evaluateBlock(expr, input, environment);\n                break;\n            case 'bind':\n                result = yield * evaluateBindExpression(expr, input, environment);\n                break;\n            case 'regex':\n                result = evaluateRegex(expr, input, environment);\n                break;\n            case 'function':\n                result = yield * evaluateFunction(expr, input, environment);\n                break;\n            case 'variable':\n                result = evaluateVariable(expr, input, environment);\n                break;\n            case 'lambda':\n                result = evaluateLambda(expr, input, environment);\n                break;\n            case 'partial':\n                result = yield * evaluatePartialApplication(expr, input, environment);\n                break;\n            case 'apply':\n                result = yield * evaluateApplyExpression(expr, input, environment);\n                break;\n            case 'transform':\n                result = evaluateTransformExpression(expr, input, environment);\n                break;\n        }\n\n        if(environment.async &&\n            (typeof result === 'undefined' || result === null || typeof result.then !== 'function')) {\n            result = Promise.resolve(result);\n        }\n        if(environment.async && typeof result.then === 'function' && expr.nextFunction && typeof result[expr.nextFunction] === 'function') {\n            // although this is a 'thenable', it is chaining a different function\n            // so don't yield since yielding will trigger the .then()\n        } else {\n            result = yield result;\n        }\n\n        if (Object.prototype.hasOwnProperty.call(expr, 'predicate')) {\n            for(var ii = 0; ii < expr.predicate.length; ii++) {\n                result = yield * evaluateFilter(expr.predicate[ii].expr, result, environment);\n            }\n        }\n\n        if (expr.type !== 'path' && Object.prototype.hasOwnProperty.call(expr, 'group')) {\n            result = yield * evaluateGroupExpression(expr.group, result, environment);\n        }\n\n        var exitCallback = environment.lookup('__evaluate_exit');\n        if(exitCallback) {\n            exitCallback(expr, input, environment, result);\n        }\n\n        if(result && isSequence(result) && !result.tupleStream) {\n            if(expr.keepArray) {\n                result.keepSingleton = true;\n            }\n            if(result.length === 0) {\n                result = undefined;\n            } else if(result.length === 1) {\n                result =  result.keepSingleton ? result : result[0];\n            }\n\n        }\n\n        return result;\n    }\n\n    /**\n     * Evaluate path expression against input data\n     * @param {Object} expr - JSONata expression\n     * @param {Object} input - Input data to evaluate against\n     * @param {Object} environment - Environment\n     * @returns {*} Evaluated input data\n     */\n    function* evaluatePath(expr, input, environment) {\n        var inputSequence;\n        // expr is an array of steps\n        // if the first step is a variable reference ($...), including root reference ($$),\n        //   then the path is absolute rather than relative\n        if (Array.isArray(input) && expr.steps[0].type !== 'variable') {\n            inputSequence = input;\n        } else {\n            // if input is not an array, make it so\n            inputSequence = createSequence(input);\n        }\n\n        var resultSequence;\n        var isTupleStream = false;\n        var tupleBindings = undefined;\n\n        // evaluate each step in turn\n        for(var ii = 0; ii < expr.steps.length; ii++) {\n            var step = expr.steps[ii];\n\n            if(step.tuple) {\n                isTupleStream = true;\n            }\n\n            // if the first step is an explicit array constructor, then just evaluate that (i.e. don't iterate over a context array)\n            if(ii === 0 && step.consarray) {\n                resultSequence = yield * evaluate(step, inputSequence, environment);\n            } else {\n                if(isTupleStream) {\n                    tupleBindings = yield * evaluateTupleStep(step, inputSequence, tupleBindings, environment);\n                } else {\n                    resultSequence = yield * evaluateStep(step, inputSequence, environment, ii === expr.steps.length - 1);\n                }\n            }\n\n            if (!isTupleStream && (typeof resultSequence === 'undefined' || resultSequence.length === 0)) {\n                break;\n            }\n\n            if(typeof step.focus === 'undefined') {\n                inputSequence = resultSequence;\n            }\n\n        }\n\n        if(isTupleStream) {\n            if(expr.tuple) {\n                // tuple stream is carrying ancestry information - keep this\n                resultSequence = tupleBindings;\n            } else {\n                resultSequence = createSequence();\n                for (ii = 0; ii < tupleBindings.length; ii++) {\n                    resultSequence.push(tupleBindings[ii]['@']);\n                }\n            }\n        }\n\n        if(expr.keepSingletonArray) {\n            // if the array is explicitly constructed in the expression and marked to promote singleton sequences to array\n            if(Array.isArray(resultSequence) && resultSequence.cons && !resultSequence.sequence) {\n                resultSequence = createSequence(resultSequence);\n            }\n            resultSequence.keepSingleton = true;\n        }\n\n        if (expr.hasOwnProperty('group')) {\n            resultSequence = yield* evaluateGroupExpression(expr.group, isTupleStream ? tupleBindings : resultSequence, environment)\n        }\n\n        return resultSequence;\n    }\n\n    function createFrameFromTuple(environment, tuple) {\n        var frame = createFrame(environment);\n        for(const prop in tuple) {\n            frame.bind(prop, tuple[prop]);\n        }\n        return frame;\n    }\n\n    /**\n     * Evaluate a step within a path\n     * @param {Object} expr - JSONata expression\n     * @param {Object} input - Input data to evaluate against\n     * @param {Object} environment - Environment\n     * @param {boolean} lastStep - flag the last step in a path\n     * @returns {*} Evaluated input data\n     */\n    function* evaluateStep(expr, input, environment, lastStep) {\n        var result;\n        if(expr.type === 'sort') {\n             result = yield* evaluateSortExpression(expr, input, environment);\n             if(expr.stages) {\n                 result = yield* evaluateStages(expr.stages, result, environment);\n             }\n             return result;\n        }\n\n        result = createSequence();\n\n        for(var ii = 0; ii < input.length; ii++) {\n            var res = yield * evaluate(expr, input[ii], environment);\n            if(expr.stages) {\n                for(var ss = 0; ss < expr.stages.length; ss++) {\n                    res = yield* evaluateFilter(expr.stages[ss].expr, res, environment);\n                }\n            }\n            if(typeof res !== 'undefined') {\n                result.push(res);\n            }\n        }\n\n        var resultSequence = createSequence();\n        if(lastStep && result.length === 1 && Array.isArray(result[0]) && !isSequence(result[0])) {\n            resultSequence = result[0];\n        } else {\n            // flatten the sequence\n            result.forEach(function(res) {\n                if (!Array.isArray(res) || res.cons) {\n                    // it's not an array - just push into the result sequence\n                    resultSequence.push(res);\n                } else {\n                    // res is a sequence - flatten it into the parent sequence\n                    res.forEach(val => resultSequence.push(val));\n                }\n            });\n        }\n\n        return resultSequence;\n    }\n\n    function* evaluateStages(stages, input, environment) {\n        var result = input;\n        for(var ss = 0; ss < stages.length; ss++) {\n            var stage = stages[ss];\n            switch(stage.type) {\n                case 'filter':\n                    result = yield * evaluateFilter(stage.expr, result, environment);\n                    break;\n                case 'index':\n                    for(var ee = 0; ee < result.length; ee++) {\n                        var tuple = result[ee];\n                        tuple[stage.value] = ee;\n                    }\n                    break;\n            }\n        }\n        return result;\n    }\n\n    /**\n     * Evaluate a step within a path\n     * @param {Object} expr - JSONata expression\n     * @param {Object} input - Input data to evaluate against\n     * @param {Object} tupleBindings - The tuple stream\n     * @param {Object} environment - Environment\n     * @returns {*} Evaluated input data\n     */\n    function* evaluateTupleStep(expr, input, tupleBindings, environment) {\n        var result;\n        if(expr.type === 'sort') {\n            if(tupleBindings) {\n                result = yield* evaluateSortExpression(expr, tupleBindings, environment);\n            } else {\n                var sorted = yield* evaluateSortExpression(expr, input, environment);\n                result = createSequence();\n                result.tupleStream = true;\n                for(var ss = 0; ss < sorted.length; ss++) {\n                    var tuple = {'@': sorted[ss]};\n                    tuple[expr.index] = ss;\n                    result.push(tuple);\n                }\n            }\n            if(expr.stages) {\n                result = yield* evaluateStages(expr.stages, result, environment);\n            }\n            return result;\n        }\n\n        result = createSequence();\n        result.tupleStream = true;\n        var stepEnv = environment;\n        if(tupleBindings === undefined) {\n            tupleBindings = input.map(item => { return {'@': item} });\n        }\n\n        for(var ee = 0; ee < tupleBindings.length; ee++) {\n            stepEnv = createFrameFromTuple(environment, tupleBindings[ee]);\n            var res = yield* evaluate(expr, tupleBindings[ee]['@'], stepEnv);\n            // res is the binding sequence for the output tuple stream\n            if(typeof res !== 'undefined') {\n                if (!Array.isArray(res)) {\n                    res = [res];\n                }\n                for (var bb = 0; bb < res.length; bb++) {\n                    tuple = {};\n                    Object.assign(tuple, tupleBindings[ee]);\n                    if(res.tupleStream) {\n                        Object.assign(tuple, res[bb]);\n                    } else {\n                        if (expr.focus) {\n                            tuple[expr.focus] = res[bb];\n                            tuple['@'] = tupleBindings[ee]['@'];\n                        } else {\n                            tuple['@'] = res[bb];\n                        }\n                        if (expr.index) {\n                            tuple[expr.index] = bb;\n                        }\n                        if (expr.ancestor) {\n                            tuple[expr.ancestor.label] = tupleBindings[ee]['@'];\n                        }\n                    }\n                    result.push(tuple);\n                }\n            }\n        }\n\n        if(expr.stages) {\n            result = yield * evaluateStages(expr.stages, result, environment);\n        }\n\n        return result;\n    }\n\n    /**\n     * Apply filter predicate to input data\n     * @param {Object} predicate - filter expression\n     * @param {Object} input - Input data to apply predicates against\n     * @param {Object} environment - Environment\n     * @returns {*} Result after applying predicates\n     */\n    function* evaluateFilter(predicate, input, environment) {\n        var results = createSequence();\n        if( input && input.tupleStream) {\n            results.tupleStream = true;\n        }\n        if (!Array.isArray(input)) {\n            input = createSequence(input);\n        }\n        if (predicate.type === 'number') {\n            var index = Math.floor(predicate.value);  // round it down\n            if (index < 0) {\n                // count in from end of array\n                index = input.length + index;\n            }\n            var item = input[index];\n            if(typeof item !== 'undefined') {\n                if(Array.isArray(item)) {\n                    results = item;\n                } else {\n                    results.push(item);\n                }\n            }\n        } else {\n            for (index = 0; index < input.length; index++) {\n                var item = input[index];\n                var context = item;\n                var env = environment;\n                if(input.tupleStream) {\n                    context = item['@'];\n                    env = createFrameFromTuple(environment, item);\n                }\n                var res = yield* evaluate(predicate, context, env);\n                if (isNumeric(res)) {\n                    res = [res];\n                }\n                if (isArrayOfNumbers(res)) {\n                    res.forEach(function (ires) {\n                        // round it down\n                        var ii = Math.floor(ires);\n                        if (ii < 0) {\n                            // count in from end of array\n                            ii = input.length + ii;\n                        }\n                        if (ii === index) {\n                            results.push(item);\n                        }\n                    });\n                } else if (fn.boolean(res)) { // truthy\n                    results.push(item);\n                }\n            }\n        }\n        return results;\n    }\n\n    /**\n     * Evaluate binary expression against input data\n     * @param {Object} expr - JSONata expression\n     * @param {Object} input - Input data to evaluate against\n     * @param {Object} environment - Environment\n     * @returns {*} Evaluated input data\n     */\n    function * evaluateBinary(expr, input, environment) {\n        var result;\n        var lhs = yield * evaluate(expr.lhs, input, environment);\n        var op = expr.value;\n\n        //defer evaluation of RHS to allow short-circuiting\n        var evalrhs = function*(){return yield * evaluate(expr.rhs, input, environment);};\n        if (op === \"and\" || op === \"or\") {\n            try {\n                return yield * evaluateBooleanExpression(lhs, evalrhs, op);\n            } catch(err) {\n                err.position = expr.position;\n                err.token = op;\n                throw err;\n            }\n        }\n\n        var rhs = yield * evalrhs();\n        try {\n            switch (op) {\n                case '+':\n                case '-':\n                case '*':\n                case '/':\n                case '%':\n                    result = evaluateNumericExpression(lhs, rhs, op);\n                    break;\n                case '=':\n                case '!=':\n                    result = evaluateEqualityExpression(lhs, rhs, op);\n                    break;\n                case '<':\n                case '<=':\n                case '>':\n                case '>=':\n                    result = evaluateComparisonExpression(lhs, rhs, op);\n                    break;\n                case '&':\n                    result = evaluateStringConcat(lhs, rhs);\n                    break;\n                case '..':\n                    result = evaluateRangeExpression(lhs, rhs);\n                    break;\n                case 'in':\n                    result = evaluateIncludesExpression(lhs, rhs);\n                    break;\n            }\n        } catch(err) {\n            err.position = expr.position;\n            err.token = op;\n            throw err;\n        }\n        return result;\n    }\n\n    /**\n     * Evaluate unary expression against input data\n     * @param {Object} expr - JSONata expression\n     * @param {Object} input - Input data to evaluate against\n     * @param {Object} environment - Environment\n     * @returns {*} Evaluated input data\n     */\n    function* evaluateUnary(expr, input, environment) {\n        var result;\n\n        switch (expr.value) {\n            case '-':\n                result = yield * evaluate(expr.expression, input, environment);\n                if(typeof result === 'undefined') {\n                    result = undefined;\n                } else if (isNumeric(result)) {\n                    result = -result;\n                } else {\n                    throw {\n                        code: \"D1002\",\n                        stack: (new Error()).stack,\n                        position: expr.position,\n                        token: expr.value,\n                        value: result\n                    };\n                }\n                break;\n            case '[':\n                // array constructor - evaluate each item\n                result = [];\n                for(var ii = 0; ii < expr.expressions.length; ii++) {\n                    var item = expr.expressions[ii];\n                    var value = yield * evaluate(item, input, environment);\n                    if (typeof value !== 'undefined') {\n                        if(item.value === '[') {\n                            result.push(value);\n                        } else {\n                            result = fn.append(result, value);\n                        }\n                    }\n                }\n                if(expr.consarray) {\n                    Object.defineProperty(result, 'cons', {\n                        enumerable: false,\n                        configurable: false,\n                        value: true\n                    });\n                }\n                break;\n            case '{':\n                // object constructor - apply grouping\n                result = yield * evaluateGroupExpression(expr, input, environment);\n                break;\n\n        }\n        return result;\n    }\n\n    /**\n     * Evaluate name object against input data\n     * @param {Object} expr - JSONata expression\n     * @param {Object} input - Input data to evaluate against\n     * @param {Object} environment - Environment\n     * @returns {*} Evaluated input data\n     */\n    function evaluateName(expr, input, environment) {\n        // lookup the 'name' item in the input\n        return fn.lookup(input, expr.value);\n    }\n\n    /**\n     * Evaluate literal against input data\n     * @param {Object} expr - JSONata expression\n     * @returns {*} Evaluated input data\n     */\n    function evaluateLiteral(expr) {\n        return expr.value;\n    }\n\n    /**\n     * Evaluate wildcard against input data\n     * @param {Object} expr - JSONata expression\n     * @param {Object} input - Input data to evaluate against\n     * @returns {*} Evaluated input data\n     */\n    function evaluateWildcard(expr, input) {\n        var results = createSequence();\n        if (Array.isArray(input) && input.outerWrapper && input.length > 0) {\n            input = input[0];\n        }\n        if (input !== null && typeof input === 'object') {\n            Object.keys(input).forEach(function (key) {\n                var value = input[key];\n                if(Array.isArray(value)) {\n                    value = flatten(value);\n                    results = fn.append(results, value);\n                } else {\n                    results.push(value);\n                }\n            });\n        }\n\n        //        result = normalizeSequence(results);\n        return results;\n    }\n\n    /**\n     * Returns a flattened array\n     * @param {Array} arg - the array to be flatten\n     * @param {Array} flattened - carries the flattened array - if not defined, will initialize to []\n     * @returns {Array} - the flattened array\n     */\n    function flatten(arg, flattened) {\n        if(typeof flattened === 'undefined') {\n            flattened = [];\n        }\n        if(Array.isArray(arg)) {\n            arg.forEach(function (item) {\n                flatten(item, flattened);\n            });\n        } else {\n            flattened.push(arg);\n        }\n        return flattened;\n    }\n\n    /**\n     * Evaluate descendants against input data\n     * @param {Object} expr - JSONata expression\n     * @param {Object} input - Input data to evaluate against\n     * @returns {*} Evaluated input data\n     */\n    function evaluateDescendants(expr, input) {\n        var result;\n        var resultSequence = createSequence();\n        if (typeof input !== 'undefined') {\n            // traverse all descendants of this object/array\n            recurseDescendants(input, resultSequence);\n            if (resultSequence.length === 1) {\n                result = resultSequence[0];\n            } else {\n                result = resultSequence;\n            }\n        }\n        return result;\n    }\n\n    /**\n     * Recurse through descendants\n     * @param {Object} input - Input data\n     * @param {Object} results - Results\n     */\n    function recurseDescendants(input, results) {\n        // this is the equivalent of //* in XPath\n        if (!Array.isArray(input)) {\n            results.push(input);\n        }\n        if (Array.isArray(input)) {\n            input.forEach(function (member) {\n                recurseDescendants(member, results);\n            });\n        } else if (input !== null && typeof input === 'object') {\n            Object.keys(input).forEach(function (key) {\n                recurseDescendants(input[key], results);\n            });\n        }\n    }\n\n    /**\n     * Evaluate numeric expression against input data\n     * @param {Object} lhs - LHS value\n     * @param {Object} rhs - RHS value\n     * @param {Object} op - opcode\n     * @returns {*} Result\n     */\n    function evaluateNumericExpression(lhs, rhs, op) {\n        var result;\n\n        if (typeof lhs !== 'undefined' && !isNumeric(lhs)) {\n            throw {\n                code: \"T2001\",\n                stack: (new Error()).stack,\n                value: lhs\n            };\n        }\n        if (typeof rhs !== 'undefined' && !isNumeric(rhs)) {\n            throw {\n                code: \"T2002\",\n                stack: (new Error()).stack,\n                value: rhs\n            };\n        }\n\n        if (typeof lhs === 'undefined' || typeof rhs === 'undefined') {\n            // if either side is undefined, the result is undefined\n            return result;\n        }\n\n        switch (op) {\n            case '+':\n                result = lhs + rhs;\n                break;\n            case '-':\n                result = lhs - rhs;\n                break;\n            case '*':\n                result = lhs * rhs;\n                break;\n            case '/':\n                result = lhs / rhs;\n                break;\n            case '%':\n                result = lhs % rhs;\n                break;\n        }\n        return result;\n    }\n\n    /**\n     * Evaluate equality expression against input data\n     * @param {Object} lhs - LHS value\n     * @param {Object} rhs - RHS value\n     * @param {Object} op - opcode\n     * @returns {*} Result\n     */\n    function evaluateEqualityExpression(lhs, rhs, op) {\n        var result;\n\n        // type checks\n        var ltype = typeof lhs;\n        var rtype = typeof rhs;\n\n        if (ltype === 'undefined' || rtype === 'undefined') {\n            // if either side is undefined, the result is false\n            return false;\n        }\n\n        switch (op) {\n            case '=':\n                result = isDeepEqual(lhs, rhs);\n                break;\n            case '!=':\n                result = !isDeepEqual(lhs, rhs);\n                break;\n        }\n        return result;\n    }\n\n    /**\n     * Evaluate comparison expression against input data\n     * @param {Object} lhs - LHS value\n     * @param {Object} rhs - RHS value\n     * @param {Object} op - opcode\n     * @returns {*} Result\n     */\n    function evaluateComparisonExpression(lhs, rhs, op) {\n        var result;\n\n        // type checks\n        var ltype = typeof lhs;\n        var rtype = typeof rhs;\n\n        var lcomparable = (ltype === 'undefined' || ltype === 'string' || ltype === 'number');\n        var rcomparable = (rtype === 'undefined' || rtype === 'string' || rtype === 'number');\n\n        // if either aa or bb are not comparable (string or numeric) values, then throw an error\n        if (!lcomparable || !rcomparable) {\n            throw {\n                code: \"T2010\",\n                stack: (new Error()).stack,\n                value: !(ltype === 'string' || ltype === 'number') ? lhs : rhs\n            };\n        }\n\n        // if either side is undefined, the result is undefined\n        if (ltype === 'undefined' || rtype === 'undefined') {\n            return undefined;\n        }\n\n        //if aa and bb are not of the same type\n        if (ltype !== rtype) {\n            throw {\n                code: \"T2009\",\n                stack: (new Error()).stack,\n                value: lhs,\n                value2: rhs\n            };\n        }\n\n        switch (op) {\n            case '<':\n                result = lhs < rhs;\n                break;\n            case '<=':\n                result = lhs <= rhs;\n                break;\n            case '>':\n                result = lhs > rhs;\n                break;\n            case '>=':\n                result = lhs >= rhs;\n                break;\n        }\n        return result;\n    }\n\n    /**\n     * Inclusion operator - in\n     *\n     * @param {Object} lhs - LHS value\n     * @param {Object} rhs - RHS value\n     * @returns {boolean} - true if lhs is a member of rhs\n     */\n    function evaluateIncludesExpression(lhs, rhs) {\n        var result = false;\n\n        if (typeof lhs === 'undefined' || typeof rhs === 'undefined') {\n            // if either side is undefined, the result is false\n            return false;\n        }\n\n        if(!Array.isArray(rhs)) {\n            rhs = [rhs];\n        }\n\n        for(var i = 0; i < rhs.length; i++) {\n            if(rhs[i] === lhs) {\n                result = true;\n                break;\n            }\n        }\n\n        return result;\n    }\n\n    /**\n     * Evaluate boolean expression against input data\n     * @param {Object} lhs - LHS value\n     * @param {Function} evalrhs - function to evaluate RHS value\n     * @param {Object} op - opcode\n     * @returns {*} Result\n     */\n    function * evaluateBooleanExpression(lhs, evalrhs, op) {\n        var result;\n\n        var lBool = boolize(lhs);\n\n        switch (op) {\n            case 'and':\n                result = lBool && boolize(yield * evalrhs());\n                break;\n            case 'or':\n                result = lBool || boolize(yield * evalrhs());\n                break;\n        }\n        return result;\n    }\n\n    function boolize(value) {\n        var booledValue = fn.boolean(value);\n        return typeof booledValue === 'undefined' ? false : booledValue;\n    }\n\n    /**\n     * Evaluate string concatenation against input data\n     * @param {Object} lhs - LHS value\n     * @param {Object} rhs - RHS value\n     * @returns {string|*} Concatenated string\n     */\n    function evaluateStringConcat(lhs, rhs) {\n        var result;\n\n        var lstr = '';\n        var rstr = '';\n        if (typeof lhs !== 'undefined') {\n            lstr = fn.string(lhs);\n        }\n        if (typeof rhs !== 'undefined') {\n            rstr = fn.string(rhs);\n        }\n\n        result = lstr.concat(rstr);\n        return result;\n    }\n\n    /**\n     * Evaluate group expression against input data\n     * @param {Object} expr - JSONata expression\n     * @param {Object} input - Input data to evaluate against\n     * @param {Object} environment - Environment\n     * @returns {{}} Evaluated input data\n     */\n    function* evaluateGroupExpression(expr, input, environment) {\n        var result = {};\n        var groups = {};\n        var reduce = input && input.tupleStream ? true : false;\n        // group the input sequence by 'key' expression\n        if (!Array.isArray(input)) {\n            input = createSequence(input);\n        }\n        // if the array is empty, add an undefined entry to enable literal JSON object to be generated\n        if (input.length === 0) {\n            input.push(undefined);\n        }\n\n        for(var itemIndex = 0; itemIndex < input.length; itemIndex++) {\n            var item = input[itemIndex];\n            var env = reduce ? createFrameFromTuple(environment, item) : environment;\n            for(var pairIndex = 0; pairIndex < expr.lhs.length; pairIndex++) {\n                var pair = expr.lhs[pairIndex];\n                var key = yield * evaluate(pair[0], reduce ? item['@'] : item, env);\n                // key has to be a string\n                if (typeof  key !== 'string' && key !== undefined) {\n                    throw {\n                        code: \"T1003\",\n                        stack: (new Error()).stack,\n                        position: expr.position,\n                        value: key\n                    };\n                }\n\n                if (key !== undefined) {\n                    var entry = {data: item, exprIndex: pairIndex};\n                    if (groups.hasOwnProperty(key)) {\n                        // a value already exists in this slot\n                        if(groups[key].exprIndex !== pairIndex) {\n                            // this key has been generated by another expression in this group\n                            // when multiple key expressions evaluate to the same key, then error D1009 must be thrown\n                            throw {\n                                code: \"D1009\",\n                                stack: (new Error()).stack,\n                                position: expr.position,\n                                value: key\n                            };\n                        }\n\n                        // append it as an array\n                        groups[key].data = fn.append(groups[key].data, item);\n                    } else {\n                        groups[key] = entry;\n                    }\n                }\n            }\n        }\n\n        // iterate over the groups to evaluate the 'value' expression\n        for (key in groups) {\n            entry = groups[key];\n            var context = entry.data;\n            var env = environment;\n            if (reduce) {\n                var tuple = reduceTupleStream(entry.data);\n                context = tuple['@'];\n                delete tuple['@'];\n                env = createFrameFromTuple(environment, tuple);\n            }\n            var value = yield * evaluate(expr.lhs[entry.exprIndex][1], context, env);\n            if(typeof value !== 'undefined') {\n                result[key] = value;\n            }\n        }\n\n        return result;\n    }\n\n    function reduceTupleStream(tupleStream) {\n        if(!Array.isArray(tupleStream)) {\n            return tupleStream;\n        }\n        var result = {};\n        Object.assign(result, tupleStream[0]);\n        for(var ii = 1; ii < tupleStream.length; ii++) {\n            for(const prop in tupleStream[ii]) {\n                result[prop] = fn.append(result[prop], tupleStream[ii][prop]);\n            }\n        }\n        return result;\n    }\n\n    /**\n     * Evaluate range expression against input data\n     * @param {Object} lhs - LHS value\n     * @param {Object} rhs - RHS value\n     * @returns {Array} Resultant array\n     */\n    function evaluateRangeExpression(lhs, rhs) {\n        var result;\n\n        if (typeof lhs !== 'undefined' && !Number.isInteger(lhs)) {\n            throw {\n                code: \"T2003\",\n                stack: (new Error()).stack,\n                value: lhs\n            };\n        }\n        if (typeof rhs !== 'undefined' && !Number.isInteger(rhs)) {\n            throw {\n                code: \"T2004\",\n                stack: (new Error()).stack,\n                value: rhs\n            };\n        }\n\n        if (typeof lhs === 'undefined' || typeof rhs === 'undefined') {\n            // if either side is undefined, the result is undefined\n            return result;\n        }\n\n        if (lhs > rhs) {\n            // if the lhs is greater than the rhs, return undefined\n            return result;\n        }\n\n        // limit the size of the array to ten million entries (1e7)\n        // this is an implementation defined limit to protect against\n        // memory and performance issues.  This value may increase in the future.\n        var size = rhs - lhs + 1;\n        if(size > 1e7) {\n            throw {\n                code: \"D2014\",\n                stack: (new Error()).stack,\n                value: size\n            };\n        }\n\n        result = new Array(size);\n        for (var item = lhs, index = 0; item <= rhs; item++, index++) {\n            result[index] = item;\n        }\n        result.sequence = true;\n        return result;\n    }\n\n    /**\n     * Evaluate bind expression against input data\n     * @param {Object} expr - JSONata expression\n     * @param {Object} input - Input data to evaluate against\n     * @param {Object} environment - Environment\n     * @returns {*} Evaluated input data\n     */\n    function* evaluateBindExpression(expr, input, environment) {\n        // The RHS is the expression to evaluate\n        // The LHS is the name of the variable to bind to - should be a VARIABLE token (enforced by parser)\n        var value = yield * evaluate(expr.rhs, input, environment);\n        environment.bind(expr.lhs.value, value);\n        return value;\n    }\n\n    /**\n     * Evaluate condition against input data\n     * @param {Object} expr - JSONata expression\n     * @param {Object} input - Input data to evaluate against\n     * @param {Object} environment - Environment\n     * @returns {*} Evaluated input data\n     */\n    function* evaluateCondition(expr, input, environment) {\n        var result;\n        var condition = yield * evaluate(expr.condition, input, environment);\n        if (fn.boolean(condition)) {\n            result = yield * evaluate(expr.then, input, environment);\n        } else if (typeof expr.else !== 'undefined') {\n            result = yield * evaluate(expr.else, input, environment);\n        }\n        return result;\n    }\n\n    /**\n     * Evaluate block against input data\n     * @param {Object} expr - JSONata expression\n     * @param {Object} input - Input data to evaluate against\n     * @param {Object} environment - Environment\n     * @returns {*} Evaluated input data\n     */\n    function* evaluateBlock(expr, input, environment) {\n        var result;\n        // create a new frame to limit the scope of variable assignments\n        // TODO, only do this if the post-parse stage has flagged this as required\n        var frame = createFrame(environment);\n        // invoke each expression in turn\n        // only return the result of the last one\n        for(var ii = 0; ii < expr.expressions.length; ii++) {\n            result = yield * evaluate(expr.expressions[ii], input, frame);\n        }\n\n        return result;\n    }\n\n    /**\n     * Prepare a regex\n     * @param {Object} expr - expression containing regex\n     * @returns {Function} Higher order function representing prepared regex\n     */\n    function evaluateRegex(expr) {\n        var re = new jsonata.RegexEngine(expr.value);\n        var closure = function(str, fromIndex) {\n            var result;\n            re.lastIndex = fromIndex || 0;\n            var match = re.exec(str);\n            if(match !== null) {\n                result = {\n                    match: match[0],\n                    start: match.index,\n                    end: match.index + match[0].length,\n                    groups: []\n                };\n                if(match.length > 1) {\n                    for(var i = 1; i < match.length; i++) {\n                        result.groups.push(match[i]);\n                    }\n                }\n                result.next = function() {\n                    if(re.lastIndex >= str.length) {\n                        return undefined;\n                    } else {\n                        var next = closure(str, re.lastIndex);\n                        if(next && next.match === '') {\n                            // matches zero length string; this will never progress\n                            throw {\n                                code: \"D1004\",\n                                stack: (new Error()).stack,\n                                position: expr.position,\n                                value: expr.value.source\n                            };\n                        }\n                        return next;\n                    }\n                };\n            }\n\n            return result;\n        };\n        return closure;\n    }\n\n    /**\n     * Evaluate variable against input data\n     * @param {Object} expr - JSONata expression\n     * @param {Object} input - Input data to evaluate against\n     * @param {Object} environment - Environment\n     * @returns {*} Evaluated input data\n     */\n    function evaluateVariable(expr, input, environment) {\n        // lookup the variable value in the environment\n        var result;\n        // if the variable name is empty string, then it refers to context value\n        if (expr.value === '') {\n            result = input && input.outerWrapper ? input[0] : input;\n        } else {\n            result = environment.lookup(expr.value);\n        }\n        return result;\n    }\n\n    /**\n     * sort / order-by operator\n     * @param {Object} expr - AST for operator\n     * @param {Object} input - Input data to evaluate against\n     * @param {Object} environment - Environment\n     * @returns {*} Ordered sequence\n     */\n    function* evaluateSortExpression(expr, input, environment) {\n        var result;\n\n        // evaluate the lhs, then sort the results in order according to rhs expression\n        //var lhs = yield * evaluate(expr.lhs, input, environment);\n        var lhs = input;\n        var isTupleSort = input.tupleStream ? true : false;\n\n        // sort the lhs array\n        // use comparator function\n        var comparator = function*(a, b) { // eslint-disable-line require-yield\n            // expr.terms is an array of order-by in priority order\n            var comp = 0;\n            for(var index = 0; comp === 0 && index < expr.terms.length; index++) {\n                var term = expr.terms[index];\n                //evaluate the sort term in the context of a\n                var context = a;\n                var env = environment;\n                if(isTupleSort) {\n                    context = a['@'];\n                    env = createFrameFromTuple(environment, a);\n                }\n                var aa = yield * evaluate(term.expression, context, env);\n                //evaluate the sort term in the context of b\n                context = b;\n                env = environment;\n                if(isTupleSort) {\n                    context = b['@'];\n                    env = createFrameFromTuple(environment, b);\n                }\n                var bb = yield * evaluate(term.expression, context, env);\n\n                // type checks\n                var atype = typeof aa;\n                var btype = typeof bb;\n                // undefined should be last in sort order\n                if(atype === 'undefined') {\n                    // swap them, unless btype is also undefined\n                    comp = (btype === 'undefined') ? 0 : 1;\n                    continue;\n                }\n                if(btype === 'undefined') {\n                    comp = -1;\n                    continue;\n                }\n\n                // if aa or bb are not string or numeric values, then throw an error\n                if(!(atype === 'string' || atype === 'number') || !(btype === 'string' || btype === 'number')) {\n                    throw {\n                        code: \"T2008\",\n                        stack: (new Error()).stack,\n                        position: expr.position,\n                        value: !(atype === 'string' || atype === 'number') ? aa : bb\n                    };\n                }\n\n                //if aa and bb are not of the same type\n                if(atype !== btype) {\n                    throw {\n                        code: \"T2007\",\n                        stack: (new Error()).stack,\n                        position: expr.position,\n                        value: aa,\n                        value2: bb\n                    };\n                }\n                if(aa === bb) {\n                    // both the same - move on to next term\n                    continue;\n                } else if (aa < bb) {\n                    comp = -1;\n                } else {\n                    comp = 1;\n                }\n                if(term.descending === true) {\n                    comp = -comp;\n                }\n            }\n            // only swap a & b if comp equals 1\n            return comp === 1;\n        };\n\n        var focus = {\n            environment: environment,\n            input: input\n        };\n        // the `focus` is passed in as the `this` for the invoked function\n        result = yield * fn.sort.apply(focus, [lhs, comparator]);\n\n        return result;\n    }\n\n    /**\n     * create a transformer function\n     * @param {Object} expr - AST for operator\n     * @param {Object} input - Input data to evaluate against\n     * @param {Object} environment - Environment\n     * @returns {*} tranformer function\n     */\n    function evaluateTransformExpression(expr, input, environment) {\n        // create a function to implement the transform definition\n        var transformer = function*(obj) { // signature <(oa):o>\n            // undefined inputs always return undefined\n            if(typeof obj === 'undefined') {\n                return undefined;\n            }\n\n            // this function returns a copy of obj with changes specified by the pattern/operation\n            var cloneFunction = environment.lookup('clone');\n            if(!isFunction(cloneFunction)) {\n                // throw type error\n                throw {\n                    code: \"T2013\",\n                    stack: (new Error()).stack,\n                    position: expr.position\n                };\n            }\n            var result = yield * apply(cloneFunction, [obj], null, environment);\n            var matches = yield * evaluate(expr.pattern, result, environment);\n            if(typeof matches !== 'undefined') {\n                if(!Array.isArray(matches)) {\n                    matches = [matches];\n                }\n                for(var ii = 0; ii < matches.length; ii++) {\n                    var match = matches[ii];\n                    // evaluate the update value for each match\n                    var update = yield * evaluate(expr.update, match, environment);\n                    // update must be an object\n                    var updateType = typeof update;\n                    if(updateType !== 'undefined') {\n                        if(updateType !== 'object' || update === null || Array.isArray(update)) {\n                            // throw type error\n                            throw {\n                                code: \"T2011\",\n                                stack: (new Error()).stack,\n                                position: expr.update.position,\n                                value: update\n                            };\n                        }\n                        // merge the update\n                        for(var prop in update) {\n                            match[prop] = update[prop];\n                        }\n                    }\n\n                    // delete, if specified, must be an array of strings (or single string)\n                    if(typeof expr.delete !== 'undefined') {\n                        var deletions = yield * evaluate(expr.delete, match, environment);\n                        if(typeof deletions !== 'undefined') {\n                            var val = deletions;\n                            if (!Array.isArray(deletions)) {\n                                deletions = [deletions];\n                            }\n                            if (!isArrayOfStrings(deletions)) {\n                                // throw type error\n                                throw {\n                                    code: \"T2012\",\n                                    stack: (new Error()).stack,\n                                    position: expr.delete.position,\n                                    value: val\n                                };\n                            }\n                            for (var jj = 0; jj < deletions.length; jj++) {\n                                if(typeof match === 'object' && match !== null) {\n                                    delete match[deletions[jj]];\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n\n            return result;\n        };\n\n        return defineFunction(transformer, '<(oa):o>');\n    }\n\n    var chainAST = parser('function($f, $g) { function($x){ $g($f($x)) } }');\n\n    /**\n     * Apply the function on the RHS using the sequence on the LHS as the first argument\n     * @param {Object} expr - JSONata expression\n     * @param {Object} input - Input data to evaluate against\n     * @param {Object} environment - Environment\n     * @returns {*} Evaluated input data\n     */\n    function* evaluateApplyExpression(expr, input, environment) {\n        var result;\n\n\n        var lhs = yield * evaluate(expr.lhs, input, environment);\n        if(expr.rhs.type === 'function') {\n            // this is a function _invocation_; invoke it with lhs expression as the first argument\n            result = yield * evaluateFunction(expr.rhs, input, environment, { context: lhs });\n        } else {\n            var func = yield * evaluate(expr.rhs, input, environment);\n\n            if(!isFunction(func)) {\n                throw {\n                    code: \"T2006\",\n                    stack: (new Error()).stack,\n                    position: expr.position,\n                    value: func\n                };\n            }\n\n            if(isFunction(lhs)) {\n                // this is function chaining (func1 ~> func2)\n                // λ($f, $g) { λ($x){ $g($f($x)) } }\n                var chain = yield * evaluate(chainAST, null, environment);\n                result = yield * apply(chain, [lhs, func], null, environment);\n            } else {\n                result = yield * apply(func, [lhs], null, environment);\n            }\n\n        }\n\n        return result;\n    }\n\n    /**\n     * Evaluate function against input data\n     * @param {Object} expr - JSONata expression\n     * @param {Object} input - Input data to evaluate against\n     * @param {Object} environment - Environment\n     * @returns {*} Evaluated input data\n     */\n    function* evaluateFunction(expr, input, environment, applyto) {\n        var result;\n\n        // create the procedure\n        // can't assume that expr.procedure is a lambda type directly\n        // could be an expression that evaluates to a function (e.g. variable reference, parens expr etc.\n        // evaluate it generically first, then check that it is a function.  Throw error if not.\n        var proc = yield * evaluate(expr.procedure, input, environment);\n\n        if (typeof proc === 'undefined' && expr.procedure.type === 'path' && environment.lookup(expr.procedure.steps[0].value)) {\n            // help the user out here if they simply forgot the leading $\n            throw {\n                code: \"T1005\",\n                stack: (new Error()).stack,\n                position: expr.position,\n                token: expr.procedure.steps[0].value\n            };\n        }\n\n        var evaluatedArgs = [];\n        if(typeof applyto !== 'undefined') {\n            evaluatedArgs.push(applyto.context);\n        }\n        // eager evaluation - evaluate the arguments\n        for (var jj = 0; jj < expr.arguments.length; jj++) {\n            const arg = yield* evaluate(expr.arguments[jj], input, environment);\n            if(isFunction(arg)) {\n                // wrap this in a closure\n                const closure = function* (...params) {\n                    // invoke func\n                    return yield * apply(arg, params, null, environment);\n                };\n                closure.arity = getFunctionArity(arg);\n                evaluatedArgs.push(closure);\n            } else {\n                evaluatedArgs.push(arg);\n            }\n        }\n        // apply the procedure\n        var procName = expr.procedure.type === 'path' ? expr.procedure.steps[0].value : expr.procedure.value;\n        try {\n            if(typeof proc === 'object') {\n                proc.token = procName;\n                proc.position = expr.position;\n            }\n            result = yield * apply(proc, evaluatedArgs, input, environment);\n        } catch (err) {\n            if(!err.position) {\n                // add the position field to the error\n                err.position = expr.position;\n            }\n            if (!err.token) {\n                // and the function identifier\n                err.token = procName;\n            }\n            throw err;\n        }\n        return result;\n    }\n\n    /**\n     * Apply procedure or function\n     * @param {Object} proc - Procedure\n     * @param {Array} args - Arguments\n     * @param {Object} input - input\n     * @param {Object} environment - environment\n     * @returns {*} Result of procedure\n     */\n    function* apply(proc, args, input, environment) {\n        var result;\n        result = yield * applyInner(proc, args, input, environment);\n        while(isLambda(result) && result.thunk === true) {\n            // trampoline loop - this gets invoked as a result of tail-call optimization\n            // the function returned a tail-call thunk\n            // unpack it, evaluate its arguments, and apply the tail call\n            var next = yield * evaluate(result.body.procedure, result.input, result.environment);\n            if(result.body.procedure.type === 'variable') {\n                next.token = result.body.procedure.value;\n            }\n            next.position = result.body.procedure.position;\n            var evaluatedArgs = [];\n            for(var ii = 0; ii < result.body.arguments.length; ii++) {\n                evaluatedArgs.push(yield * evaluate(result.body.arguments[ii], result.input, result.environment));\n            }\n\n            result = yield * applyInner(next, evaluatedArgs, input, environment);\n        }\n        return result;\n    }\n\n    /**\n     * Apply procedure or function\n     * @param {Object} proc - Procedure\n     * @param {Array} args - Arguments\n     * @param {Object} input - input\n     * @param {Object} environment - environment\n     * @returns {*} Result of procedure\n     */\n    function* applyInner(proc, args, input, environment) {\n        var result;\n        try {\n            var validatedArgs = args;\n            if (proc) {\n                validatedArgs = validateArguments(proc.signature, args, input);\n            }\n\n            if (isLambda(proc)) {\n                result = yield* applyProcedure(proc, validatedArgs);\n            } else if (proc && proc._jsonata_function === true) {\n                var focus = {\n                    environment: environment,\n                    input: input\n                };\n                // the `focus` is passed in as the `this` for the invoked function\n                result = proc.implementation.apply(focus, validatedArgs);\n                // `proc.implementation` might be a generator function\n                // and `result` might be a generator - if so, yield\n                if (isIterable(result)) {\n                    result = yield* result;\n                }\n            } else if (typeof proc === 'function') {\n                // typically these are functions that are returned by the invocation of plugin functions\n                // the `input` is being passed in as the `this` for the invoked function\n                // this is so that functions that return objects containing functions can chain\n                // e.g. $func().next().next()\n                result = proc.apply(input, validatedArgs);\n                /* istanbul ignore next */\n                if (isIterable(result)) {\n                    result = yield* result;\n                }\n            } else {\n                throw {\n                    code: \"T1006\",\n                    stack: (new Error()).stack\n                };\n            }\n        } catch(err) {\n            if(proc) {\n                if (typeof err.token == 'undefined' && typeof proc.token !== 'undefined') {\n                    err.token = proc.token;\n                }\n                err.position = proc.position;\n            }\n            throw err;\n        }\n        return result;\n    }\n\n    /**\n     * Evaluate lambda against input data\n     * @param {Object} expr - JSONata expression\n     * @param {Object} input - Input data to evaluate against\n     * @param {Object} environment - Environment\n     * @returns {{lambda: boolean, input: *, environment: *, arguments: *, body: *}} Evaluated input data\n     */\n    function evaluateLambda(expr, input, environment) {\n        // make a function (closure)\n        var procedure = {\n            _jsonata_lambda: true,\n            input: input,\n            environment: environment,\n            arguments: expr.arguments,\n            signature: expr.signature,\n            body: expr.body\n        };\n        if(expr.thunk === true) {\n            procedure.thunk = true;\n        }\n        procedure.apply = function*(self, args) {\n            return yield * apply(procedure, args, input, self.environment);\n        };\n        return procedure;\n    }\n\n    /**\n     * Evaluate partial application\n     * @param {Object} expr - JSONata expression\n     * @param {Object} input - Input data to evaluate against\n     * @param {Object} environment - Environment\n     * @returns {*} Evaluated input data\n     */\n    function* evaluatePartialApplication(expr, input, environment) {\n        // partially apply a function\n        var result;\n        // evaluate the arguments\n        var evaluatedArgs = [];\n        for(var ii = 0; ii < expr.arguments.length; ii++) {\n            var arg = expr.arguments[ii];\n            if (arg.type === 'operator' && arg.value === '?') {\n                evaluatedArgs.push(arg);\n            } else {\n                evaluatedArgs.push(yield * evaluate(arg, input, environment));\n            }\n        }\n        // lookup the procedure\n        var proc = yield * evaluate(expr.procedure, input, environment);\n        if (typeof proc === 'undefined' && expr.procedure.type === 'path' && environment.lookup(expr.procedure.steps[0].value)) {\n            // help the user out here if they simply forgot the leading $\n            throw {\n                code: \"T1007\",\n                stack: (new Error()).stack,\n                position: expr.position,\n                token: expr.procedure.steps[0].value\n            };\n        }\n        if (isLambda(proc)) {\n            result = partialApplyProcedure(proc, evaluatedArgs);\n        } else if (proc && proc._jsonata_function === true) {\n            result = partialApplyNativeFunction(proc.implementation, evaluatedArgs);\n        } else if (typeof proc === 'function') {\n            result = partialApplyNativeFunction(proc, evaluatedArgs);\n        } else {\n            throw {\n                code: \"T1008\",\n                stack: (new Error()).stack,\n                position: expr.position,\n                token: expr.procedure.type === 'path' ? expr.procedure.steps[0].value : expr.procedure.value\n            };\n        }\n        return result;\n    }\n\n    /**\n     * Validate the arguments against the signature validator (if it exists)\n     * @param {Function} signature - validator function\n     * @param {Array} args - function arguments\n     * @param {*} context - context value\n     * @returns {Array} - validated arguments\n     */\n    function validateArguments(signature, args, context) {\n        if(typeof signature === 'undefined') {\n            // nothing to validate\n            return args;\n        }\n        var validatedArgs = signature.validate(args, context);\n        return validatedArgs;\n    }\n\n    /**\n     * Apply procedure\n     * @param {Object} proc - Procedure\n     * @param {Array} args - Arguments\n     * @returns {*} Result of procedure\n     */\n    function* applyProcedure(proc, args) {\n        var result;\n        var env = createFrame(proc.environment);\n        proc.arguments.forEach(function (param, index) {\n            env.bind(param.value, args[index]);\n        });\n        if (typeof proc.body === 'function') {\n            // this is a lambda that wraps a native function - generated by partially evaluating a native\n            result = yield * applyNativeFunction(proc.body, env);\n        } else {\n            result = yield * evaluate(proc.body, proc.input, env);\n        }\n        return result;\n    }\n\n    /**\n     * Partially apply procedure\n     * @param {Object} proc - Procedure\n     * @param {Array} args - Arguments\n     * @returns {{lambda: boolean, input: *, environment: {bind, lookup}, arguments: Array, body: *}} Result of partially applied procedure\n     */\n    function partialApplyProcedure(proc, args) {\n        // create a closure, bind the supplied parameters and return a function that takes the remaining (?) parameters\n        var env = createFrame(proc.environment);\n        var unboundArgs = [];\n        proc.arguments.forEach(function (param, index) {\n            var arg = args[index];\n            if (arg && arg.type === 'operator' && arg.value === '?') {\n                unboundArgs.push(param);\n            } else {\n                env.bind(param.value, arg);\n            }\n        });\n        var procedure = {\n            _jsonata_lambda: true,\n            input: proc.input,\n            environment: env,\n            arguments: unboundArgs,\n            body: proc.body\n        };\n        return procedure;\n    }\n\n    /**\n     * Partially apply native function\n     * @param {Function} native - Native function\n     * @param {Array} args - Arguments\n     * @returns {{lambda: boolean, input: *, environment: {bind, lookup}, arguments: Array, body: *}} Result of partially applying native function\n     */\n    function partialApplyNativeFunction(native, args) {\n        // create a lambda function that wraps and invokes the native function\n        // get the list of declared arguments from the native function\n        // this has to be picked out from the toString() value\n        var sigArgs = getNativeFunctionArguments(native);\n        sigArgs = sigArgs.map(function (sigArg) {\n            return '$' + sigArg.trim();\n        });\n        var body = 'function(' + sigArgs.join(', ') + '){ _ }';\n\n        var bodyAST = parser(body);\n        bodyAST.body = native;\n\n        var partial = partialApplyProcedure(bodyAST, args);\n        return partial;\n    }\n\n    /**\n     * Apply native function\n     * @param {Object} proc - Procedure\n     * @param {Object} env - Environment\n     * @returns {*} Result of applying native function\n     */\n    function* applyNativeFunction(proc, env) {\n        var sigArgs = getNativeFunctionArguments(proc);\n        // generate the array of arguments for invoking the function - look them up in the environment\n        var args = sigArgs.map(function (sigArg) {\n            return env.lookup(sigArg.trim());\n        });\n\n        var focus = {\n            environment: env\n        };\n        var result = proc.apply(focus, args);\n        if(isIterable(result)) {\n            result = yield * result;\n        }\n        return result;\n    }\n\n    /**\n     * Get native function arguments\n     * @param {Function} func - Function\n     * @returns {*|Array} Native function arguments\n     */\n    function getNativeFunctionArguments(func) {\n        var signature = func.toString();\n        var sigParens = /\\(([^)]*)\\)/.exec(signature)[1]; // the contents of the parens\n        var sigArgs = sigParens.split(',');\n        return sigArgs;\n    }\n\n    /**\n     * Creates a function definition\n     * @param {Function} func - function implementation in Javascript\n     * @param {string} signature - JSONata function signature definition\n     * @returns {{implementation: *, signature: *}} function definition\n     */\n    function defineFunction(func, signature) {\n        var definition = {\n            _jsonata_function: true,\n            implementation: func\n        };\n        if(typeof signature !== 'undefined') {\n            definition.signature = parseSignature(signature);\n        }\n        return definition;\n    }\n\n\n    /**\n     * parses and evaluates the supplied expression\n     * @param {string} expr - expression to evaluate\n     * @returns {*} - result of evaluating the expression\n     */\n    function* functionEval(expr, focus) {\n        // undefined inputs always return undefined\n        if(typeof expr === 'undefined') {\n            return undefined;\n        }\n        var input = this.input;\n        if(typeof focus !== 'undefined') {\n            input = focus;\n            // if the input is a JSON array, then wrap it in a singleton sequence so it gets treated as a single input\n            if(Array.isArray(input) && !isSequence(input)) {\n                input = createSequence(input);\n                input.outerWrapper = true;\n            }\n        }\n\n        try {\n            var ast = parser(expr, false);\n        } catch(err) {\n            // error parsing the expression passed to $eval\n            populateMessage(err);\n            throw {\n                stack: (new Error()).stack,\n                code: \"D3120\",\n                value: err.message,\n                error: err\n            };\n        }\n        try {\n            var result = yield* evaluate(ast, input, this.environment);\n        } catch(err) {\n            // error evaluating the expression passed to $eval\n            populateMessage(err);\n            throw {\n                stack: (new Error()).stack,\n                code: \"D3121\",\n                value:err.message,\n                error: err\n            };\n        }\n\n        return result;\n    }\n\n    /**\n     * Clones an object\n     * @param {Object} arg - object to clone (deep copy)\n     * @returns {*} - the cloned object\n     */\n    function functionClone(arg) {\n        // undefined inputs always return undefined\n        if(typeof arg === 'undefined') {\n            return undefined;\n        }\n\n        return JSON.parse(fn.string(arg));\n    }\n\n    /**\n     * Create frame\n     * @param {Object} enclosingEnvironment - Enclosing environment\n     * @returns {{bind: bind, lookup: lookup}} Created frame\n     */\n    function createFrame(enclosingEnvironment) {\n        var bindings = {};\n        return {\n            bind: function (name, value) {\n                bindings[name] = value;\n            },\n            lookup: function (name) {\n                var value;\n                if(bindings.hasOwnProperty(name)) {\n                    value = bindings[name];\n                } else if (enclosingEnvironment) {\n                    value = enclosingEnvironment.lookup(name);\n                }\n                return value;\n            },\n            timestamp: enclosingEnvironment ? enclosingEnvironment.timestamp : null,\n            async: enclosingEnvironment ? enclosingEnvironment.async : false,\n            global: enclosingEnvironment ? enclosingEnvironment.global : {\n                ancestry: [ null ]\n            }\n        };\n    }\n\n    // Function registration\n    staticFrame.bind('sum', defineFunction(fn.sum, '<a<n>:n>'));\n    staticFrame.bind('count', defineFunction(fn.count, '<a:n>'));\n    staticFrame.bind('max', defineFunction(fn.max, '<a<n>:n>'));\n    staticFrame.bind('min', defineFunction(fn.min, '<a<n>:n>'));\n    staticFrame.bind('average', defineFunction(fn.average, '<a<n>:n>'));\n    staticFrame.bind('string', defineFunction(fn.string, '<x-b?:s>'));\n    staticFrame.bind('substring', defineFunction(fn.substring, '<s-nn?:s>'));\n    staticFrame.bind('substringBefore', defineFunction(fn.substringBefore, '<s-s:s>'));\n    staticFrame.bind('substringAfter', defineFunction(fn.substringAfter, '<s-s:s>'));\n    staticFrame.bind('lowercase', defineFunction(fn.lowercase, '<s-:s>'));\n    staticFrame.bind('uppercase', defineFunction(fn.uppercase, '<s-:s>'));\n    staticFrame.bind('length', defineFunction(fn.length, '<s-:n>'));\n    staticFrame.bind('trim', defineFunction(fn.trim, '<s-:s>'));\n    staticFrame.bind('pad', defineFunction(fn.pad, '<s-ns?:s>'));\n    staticFrame.bind('match', defineFunction(fn.match, '<s-f<s:o>n?:a<o>>'));\n    staticFrame.bind('contains', defineFunction(fn.contains, '<s-(sf):b>')); // TODO <s-(sf<s:o>):b>\n    staticFrame.bind('replace', defineFunction(fn.replace, '<s-(sf)(sf)n?:s>')); // TODO <s-(sf<s:o>)(sf<o:s>)n?:s>\n    staticFrame.bind('split', defineFunction(fn.split, '<s-(sf)n?:a<s>>')); // TODO <s-(sf<s:o>)n?:a<s>>\n    staticFrame.bind('join', defineFunction(fn.join, '<a<s>s?:s>'));\n    staticFrame.bind('formatNumber', defineFunction(fn.formatNumber, '<n-so?:s>'));\n    staticFrame.bind('formatBase', defineFunction(fn.formatBase, '<n-n?:s>'));\n    staticFrame.bind('formatInteger', defineFunction(datetime.formatInteger, '<n-s:s>'));\n    staticFrame.bind('parseInteger', defineFunction(datetime.parseInteger, '<s-s:n>'));\n    staticFrame.bind('number', defineFunction(fn.number, '<(nsb)-:n>'));\n    staticFrame.bind('floor', defineFunction(fn.floor, '<n-:n>'));\n    staticFrame.bind('ceil', defineFunction(fn.ceil, '<n-:n>'));\n    staticFrame.bind('round', defineFunction(fn.round, '<n-n?:n>'));\n    staticFrame.bind('abs', defineFunction(fn.abs, '<n-:n>'));\n    staticFrame.bind('sqrt', defineFunction(fn.sqrt, '<n-:n>'));\n    staticFrame.bind('power', defineFunction(fn.power, '<n-n:n>'));\n    staticFrame.bind('random', defineFunction(fn.random, '<:n>'));\n    staticFrame.bind('boolean', defineFunction(fn.boolean, '<x-:b>'));\n    staticFrame.bind('not', defineFunction(fn.not, '<x-:b>'));\n    staticFrame.bind('map', defineFunction(fn.map, '<af>'));\n    staticFrame.bind('zip', defineFunction(fn.zip, '<a+>'));\n    staticFrame.bind('filter', defineFunction(fn.filter, '<af>'));\n    staticFrame.bind('single', defineFunction(fn.single, '<af?>'));\n    staticFrame.bind('reduce', defineFunction(fn.foldLeft, '<afj?:j>')); // TODO <f<jj:j>a<j>j?:j>\n    staticFrame.bind('sift', defineFunction(fn.sift, '<o-f?:o>'));\n    staticFrame.bind('keys', defineFunction(fn.keys, '<x-:a<s>>'));\n    staticFrame.bind('lookup', defineFunction(fn.lookup, '<x-s:x>'));\n    staticFrame.bind('append', defineFunction(fn.append, '<xx:a>'));\n    staticFrame.bind('exists', defineFunction(fn.exists, '<x:b>'));\n    staticFrame.bind('spread', defineFunction(fn.spread, '<x-:a<o>>'));\n    staticFrame.bind('merge', defineFunction(fn.merge, '<a<o>:o>'));\n    staticFrame.bind('reverse', defineFunction(fn.reverse, '<a:a>'));\n    staticFrame.bind('each', defineFunction(fn.each, '<o-f:a>'));\n    staticFrame.bind('error', defineFunction(fn.error, '<s?:x>'));\n    staticFrame.bind('assert', defineFunction(fn.assert, '<bs?:x>'));\n    staticFrame.bind('type', defineFunction(fn.type, '<x:s>'));\n    staticFrame.bind('sort', defineFunction(fn.sort, '<af?:a>'));\n    staticFrame.bind('shuffle', defineFunction(fn.shuffle, '<a:a>'));\n    staticFrame.bind('distinct', defineFunction(fn.distinct, '<x:x>'));\n    staticFrame.bind('base64encode', defineFunction(fn.base64encode, '<s-:s>'));\n    staticFrame.bind('base64decode', defineFunction(fn.base64decode, '<s-:s>'));\n    staticFrame.bind('encodeUrlComponent', defineFunction(fn.encodeUrlComponent, '<s-:s>'));\n    staticFrame.bind('encodeUrl', defineFunction(fn.encodeUrl, '<s-:s>'));\n    staticFrame.bind('decodeUrlComponent', defineFunction(fn.decodeUrlComponent, '<s-:s>'));\n    staticFrame.bind('decodeUrl', defineFunction(fn.decodeUrl, '<s-:s>'));\n    staticFrame.bind('eval', defineFunction(functionEval, '<sx?:x>'));\n    staticFrame.bind('toMillis', defineFunction(datetime.toMillis, '<s-s?:n>'));\n    staticFrame.bind('fromMillis', defineFunction(datetime.fromMillis, '<n-s?s?:s>'));\n    staticFrame.bind('clone', defineFunction(functionClone, '<(oa)-:o>'));\n\n    /**\n     * Error codes\n     *\n     * Sxxxx    - Static errors (compile time)\n     * Txxxx    - Type errors\n     * Dxxxx    - Dynamic errors (evaluate time)\n     *  01xx    - tokenizer\n     *  02xx    - parser\n     *  03xx    - regex parser\n     *  04xx    - function signature parser/evaluator\n     *  10xx    - evaluator\n     *  20xx    - operators\n     *  3xxx    - functions (blocks of 10 for each function)\n     */\n    var errorCodes = {\n        \"S0101\": \"String literal must be terminated by a matching quote\",\n        \"S0102\": \"Number out of range: {{token}}\",\n        \"S0103\": \"Unsupported escape sequence: \\\\{{token}}\",\n        \"S0104\": \"The escape sequence \\\\u must be followed by 4 hex digits\",\n        \"S0105\": \"Quoted property name must be terminated with a backquote (`)\",\n        \"S0106\": \"Comment has no closing tag\",\n        \"S0201\": \"Syntax error: {{token}}\",\n        \"S0202\": \"Expected {{value}}, got {{token}}\",\n        \"S0203\": \"Expected {{value}} before end of expression\",\n        \"S0204\": \"Unknown operator: {{token}}\",\n        \"S0205\": \"Unexpected token: {{token}}\",\n        \"S0206\": \"Unknown expression type: {{token}}\",\n        \"S0207\": \"Unexpected end of expression\",\n        \"S0208\": \"Parameter {{value}} of function definition must be a variable name (start with $)\",\n        \"S0209\": \"A predicate cannot follow a grouping expression in a step\",\n        \"S0210\": \"Each step can only have one grouping expression\",\n        \"S0211\": \"The symbol {{token}} cannot be used as a unary operator\",\n        \"S0212\": \"The left side of := must be a variable name (start with $)\",\n        \"S0213\": \"The literal value {{value}} cannot be used as a step within a path expression\",\n        \"S0214\": \"The right side of {{token}} must be a variable name (start with $)\",\n        \"S0215\": \"A context variable binding must precede any predicates on a step\",\n        \"S0216\": \"A context variable binding must precede the 'order-by' clause on a step\",\n        \"S0217\": \"The object representing the 'parent' cannot be derived from this expression\",\n        \"S0301\": \"Empty regular expressions are not allowed\",\n        \"S0302\": \"No terminating / in regular expression\",\n        \"S0402\": \"Choice groups containing parameterized types are not supported\",\n        \"S0401\": \"Type parameters can only be applied to functions and arrays\",\n        \"S0500\": \"Attempted to evaluate an expression containing syntax error(s)\",\n        \"T0410\": \"Argument {{index}} of function {{token}} does not match function signature\",\n        \"T0411\": \"Context value is not a compatible type with argument {{index}} of function {{token}}\",\n        \"T0412\": \"Argument {{index}} of function {{token}} must be an array of {{type}}\",\n        \"D1001\": \"Number out of range: {{value}}\",\n        \"D1002\": \"Cannot negate a non-numeric value: {{value}}\",\n        \"T1003\": \"Key in object structure must evaluate to a string; got: {{value}}\",\n        \"D1004\": \"Regular expression matches zero length string\",\n        \"T1005\": \"Attempted to invoke a non-function. Did you mean ${{{token}}}?\",\n        \"T1006\": \"Attempted to invoke a non-function\",\n        \"T1007\": \"Attempted to partially apply a non-function. Did you mean ${{{token}}}?\",\n        \"T1008\": \"Attempted to partially apply a non-function\",\n        \"D1009\": \"Multiple key definitions evaluate to same key: {{value}}\",\n        \"T1010\": \"The matcher function argument passed to function {{token}} does not return the correct object structure\",\n        \"T2001\": \"The left side of the {{token}} operator must evaluate to a number\",\n        \"T2002\": \"The right side of the {{token}} operator must evaluate to a number\",\n        \"T2003\": \"The left side of the range operator (..) must evaluate to an integer\",\n        \"T2004\": \"The right side of the range operator (..) must evaluate to an integer\",\n        \"D2005\": \"The left side of := must be a variable name (start with $)\",  // defunct - replaced by S0212 parser error\n        \"T2006\": \"The right side of the function application operator ~> must be a function\",\n        \"T2007\": \"Type mismatch when comparing values {{value}} and {{value2}} in order-by clause\",\n        \"T2008\": \"The expressions within an order-by clause must evaluate to numeric or string values\",\n        \"T2009\": \"The values {{value}} and {{value2}} either side of operator {{token}} must be of the same data type\",\n        \"T2010\": \"The expressions either side of operator {{token}} must evaluate to numeric or string values\",\n        \"T2011\": \"The insert/update clause of the transform expression must evaluate to an object: {{value}}\",\n        \"T2012\": \"The delete clause of the transform expression must evaluate to a string or array of strings: {{value}}\",\n        \"T2013\": \"The transform expression clones the input object using the $clone() function.  This has been overridden in the current scope by a non-function.\",\n        \"D2014\": \"The size of the sequence allocated by the range operator (..) must not exceed 1e6.  Attempted to allocate {{value}}.\",\n        \"D3001\": \"Attempting to invoke string function on Infinity or NaN\",\n        \"D3010\": \"Second argument of replace function cannot be an empty string\",\n        \"D3011\": \"Fourth argument of replace function must evaluate to a positive number\",\n        \"D3012\": \"Attempted to replace a matched string with a non-string value\",\n        \"D3020\": \"Third argument of split function must evaluate to a positive number\",\n        \"D3030\": \"Unable to cast value to a number: {{value}}\",\n        \"D3040\": \"Third argument of match function must evaluate to a positive number\",\n        \"D3050\": \"The second argument of reduce function must be a function with at least two arguments\",\n        \"D3060\": \"The sqrt function cannot be applied to a negative number: {{value}}\",\n        \"D3061\": \"The power function has resulted in a value that cannot be represented as a JSON number: base={{value}}, exponent={{exp}}\",\n        \"D3070\": \"The single argument form of the sort function can only be applied to an array of strings or an array of numbers.  Use the second argument to specify a comparison function\",\n        \"D3080\": \"The picture string must only contain a maximum of two sub-pictures\",\n        \"D3081\": \"The sub-picture must not contain more than one instance of the 'decimal-separator' character\",\n        \"D3082\": \"The sub-picture must not contain more than one instance of the 'percent' character\",\n        \"D3083\": \"The sub-picture must not contain more than one instance of the 'per-mille' character\",\n        \"D3084\": \"The sub-picture must not contain both a 'percent' and a 'per-mille' character\",\n        \"D3085\": \"The mantissa part of a sub-picture must contain at least one character that is either an 'optional digit character' or a member of the 'decimal digit family'\",\n        \"D3086\": \"The sub-picture must not contain a passive character that is preceded by an active character and that is followed by another active character\",\n        \"D3087\": \"The sub-picture must not contain a 'grouping-separator' character that appears adjacent to a 'decimal-separator' character\",\n        \"D3088\": \"The sub-picture must not contain a 'grouping-separator' at the end of the integer part\",\n        \"D3089\": \"The sub-picture must not contain two adjacent instances of the 'grouping-separator' character\",\n        \"D3090\": \"The integer part of the sub-picture must not contain a member of the 'decimal digit family' that is followed by an instance of the 'optional digit character'\",\n        \"D3091\": \"The fractional part of the sub-picture must not contain an instance of the 'optional digit character' that is followed by a member of the 'decimal digit family'\",\n        \"D3092\": \"A sub-picture that contains a 'percent' or 'per-mille' character must not contain a character treated as an 'exponent-separator'\",\n        \"D3093\": \"The exponent part of the sub-picture must comprise only of one or more characters that are members of the 'decimal digit family'\",\n        \"D3100\": \"The radix of the formatBase function must be between 2 and 36.  It was given {{value}}\",\n        \"D3110\": \"The argument of the toMillis function must be an ISO 8601 formatted timestamp. Given {{value}}\",\n        \"D3120\": \"Syntax error in expression passed to function eval: {{value}}\",\n        \"D3121\": \"Dynamic error evaluating the expression passed to function eval: {{value}}\",\n        \"D3130\": \"Formatting or parsing an integer as a sequence starting with {{value}} is not supported by this implementation\",\n        \"D3131\": \"In a decimal digit pattern, all digits must be from the same decimal group\",\n        \"D3132\": \"Unknown component specifier {{value}} in date/time picture string\",\n        \"D3133\": \"The 'name' modifier can only be applied to months and days in the date/time picture string, not {{value}}\",\n        \"D3134\": \"The timezone integer format specifier cannot have more than four digits\",\n        \"D3135\": \"No matching closing bracket ']' in date/time picture string\",\n        \"D3136\": \"The date/time picture string is missing specifiers required to parse the timestamp\",\n        \"D3137\": \"{{{message}}}\",\n        \"D3138\": \"The $single() function expected exactly 1 matching result.  Instead it matched more.\",\n        \"D3139\": \"The $single() function expected exactly 1 matching result.  Instead it matched 0.\",\n        \"D3140\": \"Malformed URL passed to ${{{functionName}}}(): {{value}}\",\n        \"D3141\": \"{{{message}}}\"\n    };\n\n    /**\n     * lookup a message template from the catalog and substitute the inserts.\n     * Populates `err.message` with the substituted message. Leaves `err.message`\n     * untouched if code lookup fails.\n     * @param {string} err - error code to lookup\n     * @returns {undefined} - `err` is modified in place\n     */\n    function populateMessage(err) {\n        var template = errorCodes[err.code];\n        if(typeof template !== 'undefined') {\n            // if there are any handlebars, replace them with the field references\n            // triple braces - replace with value\n            // double braces - replace with json stringified value\n            var message = template.replace(/\\{\\{\\{([^}]+)}}}/g, function() {\n                return err[arguments[1]];\n            });\n            message = message.replace(/\\{\\{([^}]+)}}/g, function() {\n                return JSON.stringify(err[arguments[1]]);\n            });\n            err.message = message;\n        }\n        // Otherwise retain the original `err.message`\n    }\n\n    /**\n     * JSONata\n     * @param {Object} expr - JSONata expression\n     * @param {Object} options\n     * @param {boolean} options.recover: attempt to recover on parse error\n     * @param {Function} options.RegexEngine: RegEx class constructor to use\n     * @returns {{evaluate: evaluate, assign: assign}} Evaluated expression\n     */\n    function jsonata(expr, options) {\n        var ast;\n        var errors;\n        try {\n            ast = parser(expr, options && options.recover);\n            errors = ast.errors;\n            delete ast.errors;\n        } catch(err) {\n            // insert error message into structure\n            populateMessage(err); // possible side-effects on `err`\n            throw err;\n        }\n        var environment = createFrame(staticFrame);\n\n        var timestamp = new Date(); // will be overridden on each call to evalute()\n        environment.bind('now', defineFunction(function(picture, timezone) {\n            return datetime.fromMillis(timestamp.getTime(), picture, timezone);\n        }, '<s?s?:s>'));\n        environment.bind('millis', defineFunction(function() {\n            return timestamp.getTime();\n        }, '<:n>'));\n\n        if(options && options.RegexEngine) {\n            jsonata.RegexEngine = options.RegexEngine;\n        } else {\n            jsonata.RegexEngine = RegExp;\n        }\n\n        return {\n            evaluate: function (input, bindings, callback) {\n                // throw if the expression compiled with syntax errors\n                if(typeof errors !== 'undefined') {\n                    var err = {\n                        code: 'S0500',\n                        position: 0\n                    };\n                    populateMessage(err); // possible side-effects on `err`\n                    throw err;\n                }\n\n                if (typeof bindings !== 'undefined') {\n                    var exec_env;\n                    // the variable bindings have been passed in - create a frame to hold these\n                    exec_env = createFrame(environment);\n                    for (var v in bindings) {\n                        exec_env.bind(v, bindings[v]);\n                    }\n                } else {\n                    exec_env = environment;\n                }\n                // put the input document into the environment as the root object\n                exec_env.bind('$', input);\n\n                // capture the timestamp and put it in the execution environment\n                // the $now() and $millis() functions will return this value - whenever it is called\n                timestamp = new Date();\n                exec_env.timestamp = timestamp;\n\n                // if the input is a JSON array, then wrap it in a singleton sequence so it gets treated as a single input\n                if(Array.isArray(input) && !isSequence(input)) {\n                    input = createSequence(input);\n                    input.outerWrapper = true;\n                }\n\n                var result, it;\n                // if a callback function is supplied, then drive the generator in a promise chain\n                if(typeof callback === 'function') {\n                    exec_env.async = true;\n                    var catchHandler = function (err) {\n                        populateMessage(err); // possible side-effects on `err`\n                        callback(err, null);\n                    };\n                    var thenHandler = function (response) {\n                        result = it.next(response);\n                        if (result.done) {\n                            callback(null, result.value);\n                        } else {\n                            result.value.then(thenHandler).catch(catchHandler);\n                        }\n                    };\n                    it = evaluate(ast, input, exec_env);\n                    result = it.next();\n                    result.value.then(thenHandler).catch(catchHandler);\n                } else {\n                    // no callback function - drive the generator to completion synchronously\n                    try {\n                        it = evaluate(ast, input, exec_env);\n                        result = it.next();\n                        while (!result.done) {\n                            result = it.next(result.value);\n                        }\n                        return result.value;\n                    } catch (err) {\n                        // insert error message into structure\n                        populateMessage(err); // possible side-effects on `err`\n                        throw err;\n                    }\n                }\n            },\n            assign: function (name, value) {\n                environment.bind(name, value);\n            },\n            registerFunction: function(name, implementation, signature) {\n                var func = defineFunction(implementation, signature);\n                environment.bind(name, func);\n            },\n            ast: function() {\n                return ast;\n            },\n            errors: function() {\n                return errors;\n            }\n        };\n    }\n\n    jsonata.parser = parser; // TODO remove this in a future release - use ast() instead\n\n    return jsonata;\n\n})();\n\nmodule.exports = jsonata;\n\n},{\"./datetime\":1,\"./functions\":2,\"./parser\":4,\"./signature\":5,\"./utils\":6}],4:[function(require,module,exports){\n/**\n * © Copyright IBM Corp. 2016, 2018 All Rights Reserved\n *   Project name: JSONata\n *   This project is licensed under the MIT License, see LICENSE\n */\n\nvar parseSignature = require('./signature');\n\nconst parser = (() => {\n    'use strict';\n\n    var operators = {\n        '.': 75,\n        '[': 80,\n        ']': 0,\n        '{': 70,\n        '}': 0,\n        '(': 80,\n        ')': 0,\n        ',': 0,\n        '@': 80,\n        '#': 80,\n        ';': 80,\n        ':': 80,\n        '?': 20,\n        '+': 50,\n        '-': 50,\n        '*': 60,\n        '/': 60,\n        '%': 60,\n        '|': 20,\n        '=': 40,\n        '<': 40,\n        '>': 40,\n        '^': 40,\n        '**': 60,\n        '..': 20,\n        ':=': 10,\n        '!=': 40,\n        '<=': 40,\n        '>=': 40,\n        '~>': 40,\n        'and': 30,\n        'or': 25,\n        'in': 40,\n        '&': 50,\n        '!': 0,   // not an operator, but needed as a stop character for name tokens\n        '~': 0   // not an operator, but needed as a stop character for name tokens\n    };\n\n    var escapes = {  // JSON string escape sequences - see json.org\n        '\"': '\"',\n        '\\\\': '\\\\',\n        '/': '/',\n        'b': '\\b',\n        'f': '\\f',\n        'n': '\\n',\n        'r': '\\r',\n        't': '\\t'\n    };\n\n    // Tokenizer (lexer) - invoked by the parser to return one token at a time\n    var tokenizer = function (path) {\n        var position = 0;\n        var length = path.length;\n\n        var create = function (type, value) {\n            var obj = {type: type, value: value, position: position};\n            return obj;\n        };\n\n        var scanRegex = function () {\n            // the prefix '/' will have been previously scanned. Find the end of the regex.\n            // search for closing '/' ignoring any that are escaped, or within brackets\n            var start = position;\n            var depth = 0;\n            var pattern;\n            var flags;\n            while (position < length) {\n                var currentChar = path.charAt(position);\n                if (currentChar === '/' && path.charAt(position - 1) !== '\\\\' && depth === 0) {\n                    // end of regex found\n                    pattern = path.substring(start, position);\n                    if (pattern === '') {\n                        throw {\n                            code: \"S0301\",\n                            stack: (new Error()).stack,\n                            position: position\n                        };\n                    }\n                    position++;\n                    currentChar = path.charAt(position);\n                    // flags\n                    start = position;\n                    while (currentChar === 'i' || currentChar === 'm') {\n                        position++;\n                        currentChar = path.charAt(position);\n                    }\n                    flags = path.substring(start, position) + 'g';\n                    return new RegExp(pattern, flags);\n                }\n                if ((currentChar === '(' || currentChar === '[' || currentChar === '{') && path.charAt(position - 1) !== '\\\\') {\n                    depth++;\n                }\n                if ((currentChar === ')' || currentChar === ']' || currentChar === '}') && path.charAt(position - 1) !== '\\\\') {\n                    depth--;\n                }\n\n                position++;\n            }\n            throw {\n                code: \"S0302\",\n                stack: (new Error()).stack,\n                position: position\n            };\n        };\n\n        var next = function (prefix) {\n            if (position >= length) return null;\n            var currentChar = path.charAt(position);\n            // skip whitespace\n            while (position < length && ' \\t\\n\\r\\v'.indexOf(currentChar) > -1) {\n                position++;\n                currentChar = path.charAt(position);\n            }\n            // skip comments\n            if (currentChar === '/' && path.charAt(position + 1) === '*') {\n                var commentStart = position;\n                position += 2;\n                currentChar = path.charAt(position);\n                while (!(currentChar === '*' && path.charAt(position + 1) === '/')) {\n                    currentChar = path.charAt(++position);\n                    if (position >= length) {\n                        // no closing tag\n                        throw {\n                            code: \"S0106\",\n                            stack: (new Error()).stack,\n                            position: commentStart\n                        };\n                    }\n                }\n                position += 2;\n                currentChar = path.charAt(position);\n                return next(prefix); // need this to swallow any following whitespace\n            }\n            // test for regex\n            if (prefix !== true && currentChar === '/') {\n                position++;\n                return create('regex', scanRegex());\n            }\n            // handle double-char operators\n            if (currentChar === '.' && path.charAt(position + 1) === '.') {\n                // double-dot .. range operator\n                position += 2;\n                return create('operator', '..');\n            }\n            if (currentChar === ':' && path.charAt(position + 1) === '=') {\n                // := assignment\n                position += 2;\n                return create('operator', ':=');\n            }\n            if (currentChar === '!' && path.charAt(position + 1) === '=') {\n                // !=\n                position += 2;\n                return create('operator', '!=');\n            }\n            if (currentChar === '>' && path.charAt(position + 1) === '=') {\n                // >=\n                position += 2;\n                return create('operator', '>=');\n            }\n            if (currentChar === '<' && path.charAt(position + 1) === '=') {\n                // <=\n                position += 2;\n                return create('operator', '<=');\n            }\n            if (currentChar === '*' && path.charAt(position + 1) === '*') {\n                // **  descendant wildcard\n                position += 2;\n                return create('operator', '**');\n            }\n            if (currentChar === '~' && path.charAt(position + 1) === '>') {\n                // ~>  chain function\n                position += 2;\n                return create('operator', '~>');\n            }\n            // test for single char operators\n            if (Object.prototype.hasOwnProperty.call(operators, currentChar)) {\n                position++;\n                return create('operator', currentChar);\n            }\n            // test for string literals\n            if (currentChar === '\"' || currentChar === \"'\") {\n                var quoteType = currentChar;\n                // double quoted string literal - find end of string\n                position++;\n                var qstr = \"\";\n                while (position < length) {\n                    currentChar = path.charAt(position);\n                    if (currentChar === '\\\\') { // escape sequence\n                        position++;\n                        currentChar = path.charAt(position);\n                        if (Object.prototype.hasOwnProperty.call(escapes, currentChar)) {\n                            qstr += escapes[currentChar];\n                        } else if (currentChar === 'u') {\n                            // \\u should be followed by 4 hex digits\n                            var octets = path.substr(position + 1, 4);\n                            if (/^[0-9a-fA-F]+$/.test(octets)) {\n                                var codepoint = parseInt(octets, 16);\n                                qstr += String.fromCharCode(codepoint);\n                                position += 4;\n                            } else {\n                                throw {\n                                    code: \"S0104\",\n                                    stack: (new Error()).stack,\n                                    position: position\n                                };\n                            }\n                        } else {\n                            // illegal escape sequence\n                            throw {\n                                code: \"S0103\",\n                                stack: (new Error()).stack,\n                                position: position,\n                                token: currentChar\n                            };\n\n                        }\n                    } else if (currentChar === quoteType) {\n                        position++;\n                        return create('string', qstr);\n                    } else {\n                        qstr += currentChar;\n                    }\n                    position++;\n                }\n                throw {\n                    code: \"S0101\",\n                    stack: (new Error()).stack,\n                    position: position\n                };\n            }\n            // test for numbers\n            var numregex = /^-?(0|([1-9][0-9]*))(\\.[0-9]+)?([Ee][-+]?[0-9]+)?/;\n            var match = numregex.exec(path.substring(position));\n            if (match !== null) {\n                var num = parseFloat(match[0]);\n                if (!isNaN(num) && isFinite(num)) {\n                    position += match[0].length;\n                    return create('number', num);\n                } else {\n                    throw {\n                        code: \"S0102\",\n                        stack: (new Error()).stack,\n                        position: position,\n                        token: match[0]\n                    };\n                }\n            }\n            // test for quoted names (backticks)\n            var name;\n            if (currentChar === '`') {\n                // scan for closing quote\n                position++;\n                var end = path.indexOf('`', position);\n                if (end !== -1) {\n                    name = path.substring(position, end);\n                    position = end + 1;\n                    return create('name', name);\n                }\n                position = length;\n                throw {\n                    code: \"S0105\",\n                    stack: (new Error()).stack,\n                    position: position\n                };\n            }\n            // test for names\n            var i = position;\n            var ch;\n            for (; ;) {\n                ch = path.charAt(i);\n                if (i === length || ' \\t\\n\\r\\v'.indexOf(ch) > -1 || Object.prototype.hasOwnProperty.call(operators, ch)) {\n                    if (path.charAt(position) === '$') {\n                        // variable reference\n                        name = path.substring(position + 1, i);\n                        position = i;\n                        return create('variable', name);\n                    } else {\n                        name = path.substring(position, i);\n                        position = i;\n                        switch (name) {\n                            case 'or':\n                            case 'in':\n                            case 'and':\n                                return create('operator', name);\n                            case 'true':\n                                return create('value', true);\n                            case 'false':\n                                return create('value', false);\n                            case 'null':\n                                return create('value', null);\n                            default:\n                                if (position === length && name === '') {\n                                    // whitespace at end of input\n                                    return null;\n                                }\n                                return create('name', name);\n                        }\n                    }\n                } else {\n                    i++;\n                }\n            }\n        };\n\n        return next;\n    };\n\n    // This parser implements the 'Top down operator precedence' algorithm developed by Vaughan R Pratt; http://dl.acm.org/citation.cfm?id=512931.\n    // and builds on the Javascript framework described by Douglas Crockford at http://javascript.crockford.com/tdop/tdop.html\n    // and in 'Beautiful Code', edited by Andy Oram and Greg Wilson, Copyright 2007 O'Reilly Media, Inc. 798-0-596-51004-6\n\n    var parser = function (source, recover) {\n        var node;\n        var lexer;\n\n        var symbol_table = {};\n        var errors = [];\n\n        var remainingTokens = function () {\n            var remaining = [];\n            if (node.id !== '(end)') {\n                remaining.push({type: node.type, value: node.value, position: node.position});\n            }\n            var nxt = lexer();\n            while (nxt !== null) {\n                remaining.push(nxt);\n                nxt = lexer();\n            }\n            return remaining;\n        };\n\n        var base_symbol = {\n            nud: function () {\n                // error - symbol has been invoked as a unary operator\n                var err = {\n                    code: 'S0211',\n                    token: this.value,\n                    position: this.position\n                };\n\n                if (recover) {\n                    err.remaining = remainingTokens();\n                    err.type = 'error';\n                    errors.push(err);\n                    return err;\n                } else {\n                    err.stack = (new Error()).stack;\n                    throw err;\n                }\n            }\n        };\n\n        var symbol = function (id, bp) {\n            var s = symbol_table[id];\n            bp = bp || 0;\n            if (s) {\n                if (bp >= s.lbp) {\n                    s.lbp = bp;\n                }\n            } else {\n                s = Object.create(base_symbol);\n                s.id = s.value = id;\n                s.lbp = bp;\n                symbol_table[id] = s;\n            }\n            return s;\n        };\n\n        var handleError = function (err) {\n            if (recover) {\n                // tokenize the rest of the buffer and add it to an error token\n                err.remaining = remainingTokens();\n                errors.push(err);\n                var symbol = symbol_table[\"(error)\"];\n                node = Object.create(symbol);\n                node.error = err;\n                node.type = \"(error)\";\n                return node;\n            } else {\n                err.stack = (new Error()).stack;\n                throw err;\n            }\n        };\n\n        var advance = function (id, infix) {\n            if (id && node.id !== id) {\n                var code;\n                if (node.id === '(end)') {\n                    // unexpected end of buffer\n                    code = \"S0203\";\n                } else {\n                    code = \"S0202\";\n                }\n                var err = {\n                    code: code,\n                    position: node.position,\n                    token: node.value,\n                    value: id\n                };\n                return handleError(err);\n            }\n            var next_token = lexer(infix);\n            if (next_token === null) {\n                node = symbol_table[\"(end)\"];\n                node.position = source.length;\n                return node;\n            }\n            var value = next_token.value;\n            var type = next_token.type;\n            var symbol;\n            switch (type) {\n                case 'name':\n                case 'variable':\n                    symbol = symbol_table[\"(name)\"];\n                    break;\n                case 'operator':\n                    symbol = symbol_table[value];\n                    if (!symbol) {\n                        return handleError({\n                            code: \"S0204\",\n                            stack: (new Error()).stack,\n                            position: next_token.position,\n                            token: value\n                        });\n                    }\n                    break;\n                case 'string':\n                case 'number':\n                case 'value':\n                    symbol = symbol_table[\"(literal)\"];\n                    break;\n                case 'regex':\n                    type = \"regex\";\n                    symbol = symbol_table[\"(regex)\"];\n                    break;\n                /* istanbul ignore next */\n                default:\n                    return handleError({\n                        code: \"S0205\",\n                        stack: (new Error()).stack,\n                        position: next_token.position,\n                        token: value\n                    });\n            }\n\n            node = Object.create(symbol);\n            node.value = value;\n            node.type = type;\n            node.position = next_token.position;\n            return node;\n        };\n\n        // Pratt's algorithm\n        var expression = function (rbp) {\n            var left;\n            var t = node;\n            advance(null, true);\n            left = t.nud();\n            while (rbp < node.lbp) {\n                t = node;\n                advance();\n                left = t.led(left);\n            }\n            return left;\n        };\n\n        var terminal = function (id) {\n            var s = symbol(id, 0);\n            s.nud = function () {\n                return this;\n            };\n        };\n\n        // match infix operators\n        // <expression> <operator> <expression>\n        // left associative\n        var infix = function (id, bp, led) {\n            var bindingPower = bp || operators[id];\n            var s = symbol(id, bindingPower);\n            s.led = led || function (left) {\n                this.lhs = left;\n                this.rhs = expression(bindingPower);\n                this.type = \"binary\";\n                return this;\n            };\n            return s;\n        };\n\n        // match infix operators\n        // <expression> <operator> <expression>\n        // right associative\n        var infixr = function (id, bp, led) {\n            var s = symbol(id, bp);\n            s.led = led;\n            return s;\n        };\n\n        // match prefix operators\n        // <operator> <expression>\n        var prefix = function (id, nud) {\n            var s = symbol(id);\n            s.nud = nud || function () {\n                this.expression = expression(70);\n                this.type = \"unary\";\n                return this;\n            };\n            return s;\n        };\n\n        terminal(\"(end)\");\n        terminal(\"(name)\");\n        terminal(\"(literal)\");\n        terminal(\"(regex)\");\n        symbol(\":\");\n        symbol(\";\");\n        symbol(\",\");\n        symbol(\")\");\n        symbol(\"]\");\n        symbol(\"}\");\n        symbol(\"..\"); // range operator\n        infix(\".\"); // map operator\n        infix(\"+\"); // numeric addition\n        infix(\"-\"); // numeric subtraction\n        infix(\"*\"); // numeric multiplication\n        infix(\"/\"); // numeric division\n        infix(\"%\"); // numeric modulus\n        infix(\"=\"); // equality\n        infix(\"<\"); // less than\n        infix(\">\"); // greater than\n        infix(\"!=\"); // not equal to\n        infix(\"<=\"); // less than or equal\n        infix(\">=\"); // greater than or equal\n        infix(\"&\"); // string concatenation\n        infix(\"and\"); // Boolean AND\n        infix(\"or\"); // Boolean OR\n        infix(\"in\"); // is member of array\n        terminal(\"and\"); // the 'keywords' can also be used as terminals (field names)\n        terminal(\"or\"); //\n        terminal(\"in\"); //\n        prefix(\"-\"); // unary numeric negation\n        infix(\"~>\"); // function application\n\n        infixr(\"(error)\", 10, function (left) {\n            this.lhs = left;\n\n            this.error = node.error;\n            this.remaining = remainingTokens();\n            this.type = 'error';\n            return this;\n        });\n\n        // field wildcard (single level)\n        prefix('*', function () {\n            this.type = \"wildcard\";\n            return this;\n        });\n\n        // descendant wildcard (multi-level)\n        prefix('**', function () {\n            this.type = \"descendant\";\n            return this;\n        });\n\n        // parent operator\n        prefix('%', function () {\n            this.type = \"parent\";\n            return this;\n        });\n\n        // function invocation\n        infix(\"(\", operators['('], function (left) {\n            // left is is what we are trying to invoke\n            this.procedure = left;\n            this.type = 'function';\n            this.arguments = [];\n            if (node.id !== ')') {\n                for (; ;) {\n                    if (node.type === 'operator' && node.id === '?') {\n                        // partial function application\n                        this.type = 'partial';\n                        this.arguments.push(node);\n                        advance('?');\n                    } else {\n                        this.arguments.push(expression(0));\n                    }\n                    if (node.id !== ',') break;\n                    advance(',');\n                }\n            }\n            advance(\")\", true);\n            // if the name of the function is 'function' or λ, then this is function definition (lambda function)\n            if (left.type === 'name' && (left.value === 'function' || left.value === '\\u03BB')) {\n                // all of the args must be VARIABLE tokens\n                this.arguments.forEach(function (arg, index) {\n                    if (arg.type !== 'variable') {\n                        return handleError({\n                            code: \"S0208\",\n                            stack: (new Error()).stack,\n                            position: arg.position,\n                            token: arg.value,\n                            value: index + 1\n                        });\n                    }\n                });\n                this.type = 'lambda';\n                // is the next token a '<' - if so, parse the function signature\n                if (node.id === '<') {\n                    var sigPos = node.position;\n                    var depth = 1;\n                    var sig = '<';\n                    while (depth > 0 && node.id !== '{' && node.id !== '(end)') {\n                        var tok = advance();\n                        if (tok.id === '>') {\n                            depth--;\n                        } else if (tok.id === '<') {\n                            depth++;\n                        }\n                        sig += tok.value;\n                    }\n                    advance('>');\n                    try {\n                        this.signature = parseSignature(sig);\n                    } catch (err) {\n                        // insert the position into this error\n                        err.position = sigPos + err.offset;\n                        return handleError(err);\n                    }\n                }\n                // parse the function body\n                advance('{');\n                this.body = expression(0);\n                advance('}');\n            }\n            return this;\n        });\n\n        // parenthesis - block expression\n        prefix(\"(\", function () {\n            var expressions = [];\n            while (node.id !== \")\") {\n                expressions.push(expression(0));\n                if (node.id !== \";\") {\n                    break;\n                }\n                advance(\";\");\n            }\n            advance(\")\", true);\n            this.type = 'block';\n            this.expressions = expressions;\n            return this;\n        });\n\n        // array constructor\n        prefix(\"[\", function () {\n            var a = [];\n            if (node.id !== \"]\") {\n                for (; ;) {\n                    var item = expression(0);\n                    if (node.id === \"..\") {\n                        // range operator\n                        var range = {type: \"binary\", value: \"..\", position: node.position, lhs: item};\n                        advance(\"..\");\n                        range.rhs = expression(0);\n                        item = range;\n                    }\n                    a.push(item);\n                    if (node.id !== \",\") {\n                        break;\n                    }\n                    advance(\",\");\n                }\n            }\n            advance(\"]\", true);\n            this.expressions = a;\n            this.type = \"unary\";\n            return this;\n        });\n\n        // filter - predicate or array index\n        infix(\"[\", operators['['], function (left) {\n            if (node.id === \"]\") {\n                // empty predicate means maintain singleton arrays in the output\n                var step = left;\n                while (step && step.type === 'binary' && step.value === '[') {\n                    step = step.lhs;\n                }\n                step.keepArray = true;\n                advance(\"]\");\n                return left;\n            } else {\n                this.lhs = left;\n                this.rhs = expression(operators[']']);\n                this.type = 'binary';\n                advance(\"]\", true);\n                return this;\n            }\n        });\n\n        // order-by\n        infix(\"^\", operators['^'], function (left) {\n            advance(\"(\");\n            var terms = [];\n            for (; ;) {\n                var term = {\n                    descending: false\n                };\n                if (node.id === \"<\") {\n                    // ascending sort\n                    advance(\"<\");\n                } else if (node.id === \">\") {\n                    // descending sort\n                    term.descending = true;\n                    advance(\">\");\n                } else {\n                    //unspecified - default to ascending\n                }\n                term.expression = expression(0);\n                terms.push(term);\n                if (node.id !== \",\") {\n                    break;\n                }\n                advance(\",\");\n            }\n            advance(\")\");\n            this.lhs = left;\n            this.rhs = terms;\n            this.type = 'binary';\n            return this;\n        });\n\n        var objectParser = function (left) {\n            var a = [];\n            if (node.id !== \"}\") {\n                for (; ;) {\n                    var n = expression(0);\n                    advance(\":\");\n                    var v = expression(0);\n                    a.push([n, v]); // holds an array of name/value expression pairs\n                    if (node.id !== \",\") {\n                        break;\n                    }\n                    advance(\",\");\n                }\n            }\n            advance(\"}\", true);\n            if (typeof left === 'undefined') {\n                // NUD - unary prefix form\n                this.lhs = a;\n                this.type = \"unary\";\n            } else {\n                // LED - binary infix form\n                this.lhs = left;\n                this.rhs = a;\n                this.type = 'binary';\n            }\n            return this;\n        };\n\n        // object constructor\n        prefix(\"{\", objectParser);\n\n        // object grouping\n        infix(\"{\", operators['{'], objectParser);\n\n        // bind variable\n        infixr(\":=\", operators[':='], function (left) {\n            if (left.type !== 'variable') {\n                return handleError({\n                    code: \"S0212\",\n                    stack: (new Error()).stack,\n                    position: left.position,\n                    token: left.value\n                });\n            }\n            this.lhs = left;\n            this.rhs = expression(operators[':='] - 1); // subtract 1 from bindingPower for right associative operators\n            this.type = \"binary\";\n            return this;\n        });\n\n        // focus variable bind\n        infix(\"@\", operators['@'], function (left) {\n            this.lhs = left;\n            this.rhs = expression(operators['@']);\n            if(this.rhs.type !== 'variable') {\n                return handleError({\n                    code: \"S0214\",\n                    stack: (new Error()).stack,\n                    position: this.rhs.position,\n                    token: \"@\"\n                });\n            }\n            this.type = \"binary\";\n            return this;\n        });\n\n        // index (position) variable bind\n        infix(\"#\", operators['#'], function (left) {\n            this.lhs = left;\n            this.rhs = expression(operators['#']);\n            if(this.rhs.type !== 'variable') {\n                return handleError({\n                    code: \"S0214\",\n                    stack: (new Error()).stack,\n                    position: this.rhs.position,\n                    token: \"#\"\n                });\n            }\n            this.type = \"binary\";\n            return this;\n        });\n\n        // if/then/else ternary operator ?:\n        infix(\"?\", operators['?'], function (left) {\n            this.type = 'condition';\n            this.condition = left;\n            this.then = expression(0);\n            if (node.id === ':') {\n                // else condition\n                advance(\":\");\n                this.else = expression(0);\n            }\n            return this;\n        });\n\n        // object transformer\n        prefix(\"|\", function () {\n            this.type = 'transform';\n            this.pattern = expression(0);\n            advance('|');\n            this.update = expression(0);\n            if (node.id === ',') {\n                advance(',');\n                this.delete = expression(0);\n            }\n            advance('|');\n            return this;\n        });\n\n        // tail call optimization\n        // this is invoked by the post parser to analyse lambda functions to see\n        // if they make a tail call.  If so, it is replaced by a thunk which will\n        // be invoked by the trampoline loop during function application.\n        // This enables tail-recursive functions to be written without growing the stack\n        var tailCallOptimize = function (expr) {\n            var result;\n            if (expr.type === 'function' && !expr.predicate) {\n                var thunk = {type: 'lambda', thunk: true, arguments: [], position: expr.position};\n                thunk.body = expr;\n                result = thunk;\n            } else if (expr.type === 'condition') {\n                // analyse both branches\n                expr.then = tailCallOptimize(expr.then);\n                if (typeof expr.else !== 'undefined') {\n                    expr.else = tailCallOptimize(expr.else);\n                }\n                result = expr;\n            } else if (expr.type === 'block') {\n                // only the last expression in the block\n                var length = expr.expressions.length;\n                if (length > 0) {\n                    expr.expressions[length - 1] = tailCallOptimize(expr.expressions[length - 1]);\n                }\n                result = expr;\n            } else {\n                result = expr;\n            }\n            return result;\n        };\n\n        var ancestorLabel = 0;\n        var ancestorIndex = 0;\n        var ancestry = [];\n\n        var seekParent = function (node, slot) {\n            switch (node.type) {\n                case 'name':\n                case 'wildcard':\n                    slot.level--;\n                    if(slot.level === 0) {\n                        if (typeof node.ancestor === 'undefined') {\n                            node.ancestor = slot;\n                        } else {\n                            // reuse the existing label\n                            ancestry[slot.index].slot.label = node.ancestor.label;\n                            node.ancestor = slot;\n                        }\n                        node.tuple = true;\n                    }\n                    break;\n                case 'parent':\n                    slot.level++;\n                    break;\n                case 'block':\n                    // look in last expression in the block\n                    if(node.expressions.length > 0) {\n                        node.tuple = true;\n                        slot = seekParent(node.expressions[node.expressions.length - 1], slot);\n                    }\n                    break;\n                case 'path':\n                    // last step in path\n                    node.tuple = true;\n                    var index = node.steps.length - 1;\n                    slot = seekParent(node.steps[index--], slot);\n                    while (slot.level > 0 && index >= 0) {\n                        // check previous steps\n                        slot = seekParent(node.steps[index--], slot);\n                    }\n                    break;\n                default:\n                    // error - can't derive ancestor\n                    throw {\n                        code: \"S0217\",\n                        token: node.type,\n                        position: node.position\n                    };\n            }\n            return slot;\n        };\n\n        var pushAncestry = function(result, value) {\n            if(typeof value.seekingParent !== 'undefined' || value.type === 'parent') {\n                var slots = (typeof value.seekingParent !== 'undefined') ? value.seekingParent : [];\n                if (value.type === 'parent') {\n                    slots.push(value.slot);\n                }\n                if(typeof result.seekingParent === 'undefined') {\n                    result.seekingParent = slots;\n                } else {\n                    Array.prototype.push.apply(result.seekingParent, slots);\n                }\n            }\n        };\n\n        var resolveAncestry = function(path) {\n            var index = path.steps.length - 1;\n            var laststep = path.steps[index];\n            var slots = (typeof laststep.seekingParent !== 'undefined') ? laststep.seekingParent : [];\n            if (laststep.type === 'parent') {\n                slots.push(laststep.slot);\n            }\n            for(var is = 0; is < slots.length; is++) {\n                var slot = slots[is];\n                index = path.steps.length - 2;\n                while (slot.level > 0) {\n                    if (index < 0) {\n                        if(typeof path.seekingParent === 'undefined') {\n                            path.seekingParent = [slot];\n                        } else {\n                            path.seekingParent.push(slot);\n                        }\n                        break;\n                    }\n                    // try previous step\n                    var step = path.steps[index--];\n                    // multiple contiguous steps that bind the focus should be skipped\n                    while(index >= 0 && step.focus && path.steps[index].focus) {\n                        step = path.steps[index--];\n                    }\n                    slot = seekParent(step, slot);\n                }\n            }\n        };\n\n        // post-parse stage\n        // the purpose of this is to add as much semantic value to the parse tree as possible\n        // in order to simplify the work of the evaluator.\n        // This includes flattening the parts of the AST representing location paths,\n        // converting them to arrays of steps which in turn may contain arrays of predicates.\n        // following this, nodes containing '.' and '[' should be eliminated from the AST.\n        var processAST = function (expr) {\n            var result;\n            switch (expr.type) {\n                case 'binary':\n                    switch (expr.value) {\n                        case '.':\n                            var lstep = processAST(expr.lhs);\n\n                            if (lstep.type === 'path') {\n                                result = lstep;\n                            } else {\n                                result = {type: 'path', steps: [lstep]};\n                            }\n                            if(lstep.type === 'parent') {\n                                result.seekingParent = [lstep.slot];\n                            }\n                            var rest = processAST(expr.rhs);\n                            if (rest.type === 'function' &&\n                                rest.procedure.type === 'path' &&\n                                rest.procedure.steps.length === 1 &&\n                                rest.procedure.steps[0].type === 'name' &&\n                                result.steps[result.steps.length - 1].type === 'function') {\n                                // next function in chain of functions - will override a thenable\n                                result.steps[result.steps.length - 1].nextFunction = rest.procedure.steps[0].value;\n                            }\n                            if (rest.type === 'path') {\n                                Array.prototype.push.apply(result.steps, rest.steps);\n                            } else {\n                                if(typeof rest.predicate !== 'undefined') {\n                                    rest.stages = rest.predicate;\n                                    delete rest.predicate;\n                                }\n                                result.steps.push(rest);\n                            }\n                            // any steps within a path that are string literals, should be changed to 'name'\n                            result.steps.filter(function (step) {\n                                if (step.type === 'number' || step.type === 'value') {\n                                    // don't allow steps to be numbers or the values true/false/null\n                                    throw {\n                                        code: \"S0213\",\n                                        stack: (new Error()).stack,\n                                        position: step.position,\n                                        value: step.value\n                                    };\n                                }\n                                return step.type === 'string';\n                            }).forEach(function (lit) {\n                                lit.type = 'name';\n                            });\n                            // any step that signals keeping a singleton array, should be flagged on the path\n                            if (result.steps.filter(function (step) {\n                                return step.keepArray === true;\n                            }).length > 0) {\n                                result.keepSingletonArray = true;\n                            }\n                            // if first step is a path constructor, flag it for special handling\n                            var firststep = result.steps[0];\n                            if (firststep.type === 'unary' && firststep.value === '[') {\n                                firststep.consarray = true;\n                            }\n                            // if the last step is an array constructor, flag it so it doesn't flatten\n                            var laststep = result.steps[result.steps.length - 1];\n                            if (laststep.type === 'unary' && laststep.value === '[') {\n                                laststep.consarray = true;\n                            }\n                            resolveAncestry(result);\n                            break;\n                        case '[':\n                            // predicated step\n                            // LHS is a step or a predicated step\n                            // RHS is the predicate expr\n                            result = processAST(expr.lhs);\n                            var step = result;\n                            var type = 'predicate';\n                            if (result.type === 'path') {\n                                step = result.steps[result.steps.length - 1];\n                                type = 'stages';\n                            }\n                            if (typeof step.group !== 'undefined') {\n                                throw {\n                                    code: \"S0209\",\n                                    stack: (new Error()).stack,\n                                    position: expr.position\n                                };\n                            }\n                            if (typeof step[type] === 'undefined') {\n                                step[type] = [];\n                            }\n                            var predicate = processAST(expr.rhs);\n                            if(typeof predicate.seekingParent !== 'undefined') {\n                                predicate.seekingParent.forEach(slot => {\n                                    if(slot.level === 1) {\n                                        seekParent(step, slot);\n                                    } else {\n                                        slot.level--;\n                                    }\n                                });\n                                pushAncestry(step, predicate);\n                            }\n                            step[type].push({type: 'filter', expr: predicate, position: expr.position});\n                            break;\n                        case '{':\n                            // group-by\n                            // LHS is a step or a predicated step\n                            // RHS is the object constructor expr\n                            result = processAST(expr.lhs);\n                            if (typeof result.group !== 'undefined') {\n                                throw {\n                                    code: \"S0210\",\n                                    stack: (new Error()).stack,\n                                    position: expr.position\n                                };\n                            }\n                            // object constructor - process each pair\n                            result.group = {\n                                lhs: expr.rhs.map(function (pair) {\n                                    return [processAST(pair[0]), processAST(pair[1])];\n                                }),\n                                position: expr.position\n                            };\n                            break;\n                        case '^':\n                            // order-by\n                            // LHS is the array to be ordered\n                            // RHS defines the terms\n                            result = processAST(expr.lhs);\n                            if (result.type !== 'path') {\n                                result = {type: 'path', steps: [result]};\n                            }\n                            var sortStep = {type: 'sort', position: expr.position};\n                            sortStep.terms = expr.rhs.map(function (terms) {\n                                var expression = processAST(terms.expression);\n                                pushAncestry(sortStep, expression);\n                                return {\n                                    descending: terms.descending,\n                                    expression: expression\n                                };\n                            });\n                            result.steps.push(sortStep);\n                            resolveAncestry(result);\n                            break;\n                        case ':=':\n                            result = {type: 'bind', value: expr.value, position: expr.position};\n                            result.lhs = processAST(expr.lhs);\n                            result.rhs = processAST(expr.rhs);\n                            pushAncestry(result, result.rhs);\n                            break;\n                        case '@':\n                            result = processAST(expr.lhs);\n                            step = result;\n                            if (result.type === 'path') {\n                                step = result.steps[result.steps.length - 1];\n                            }\n                            // throw error if there are any predicates defined at this point\n                            // at this point the only type of stages can be predicates\n                            if(typeof step.stages !== 'undefined' || typeof step.predicate !== 'undefined') {\n                                throw {\n                                    code: \"S0215\",\n                                    stack: (new Error()).stack,\n                                    position: expr.position\n                                };\n                            }\n                            // also throw if this is applied after an 'order-by' clause\n                            if(step.type === 'sort') {\n                                throw {\n                                    code: \"S0216\",\n                                    stack: (new Error()).stack,\n                                    position: expr.position\n                                };\n                            }\n                            if(expr.keepArray) {\n                                step.keepArray = true;\n                            }\n                            step.focus = expr.rhs.value;\n                            step.tuple = true;\n                            break;\n                        case '#':\n                            result = processAST(expr.lhs);\n                            step = result;\n                            if (result.type === 'path') {\n                                step = result.steps[result.steps.length - 1];\n                            } else {\n                                result = {type: 'path', steps: [result]};\n                                if (typeof step.predicate !== 'undefined') {\n                                    step.stages = step.predicate;\n                                    delete step.predicate;\n                                }\n                            }\n                            if (typeof step.stages === 'undefined') {\n                                step.index = expr.rhs.value;\n                            } else {\n                                step.stages.push({type: 'index', value: expr.rhs.value, position: expr.position});\n                            }\n                            step.tuple = true;\n                            break;\n                        case '~>':\n                            result = {type: 'apply', value: expr.value, position: expr.position};\n                            result.lhs = processAST(expr.lhs);\n                            result.rhs = processAST(expr.rhs);\n                            break;\n                        default:\n                            result = {type: expr.type, value: expr.value, position: expr.position};\n                            result.lhs = processAST(expr.lhs);\n                            result.rhs = processAST(expr.rhs);\n                            pushAncestry(result, result.lhs);\n                            pushAncestry(result, result.rhs);\n                    }\n                    break;\n                case 'unary':\n                    result = {type: expr.type, value: expr.value, position: expr.position};\n                    if (expr.value === '[') {\n                        // array constructor - process each item\n                        result.expressions = expr.expressions.map(function (item) {\n                            var value = processAST(item);\n                            pushAncestry(result, value);\n                            return value;\n                        });\n                    } else if (expr.value === '{') {\n                        // object constructor - process each pair\n                        result.lhs = expr.lhs.map(function (pair) {\n                            var key = processAST(pair[0]);\n                            pushAncestry(result, key);\n                            var value = processAST(pair[1]);\n                            pushAncestry(result, value);\n                            return [key, value];\n                        });\n                    } else {\n                        // all other unary expressions - just process the expression\n                        result.expression = processAST(expr.expression);\n                        // if unary minus on a number, then pre-process\n                        if (expr.value === '-' && result.expression.type === 'number') {\n                            result = result.expression;\n                            result.value = -result.value;\n                        } else {\n                            pushAncestry(result, result.expression);\n                        }\n                    }\n                    break;\n                case 'function':\n                case 'partial':\n                    result = {type: expr.type, name: expr.name, value: expr.value, position: expr.position};\n                    result.arguments = expr.arguments.map(function (arg) {\n                        var argAST = processAST(arg);\n                        pushAncestry(result, argAST);\n                        return argAST;\n                    });\n                    result.procedure = processAST(expr.procedure);\n                    break;\n                case 'lambda':\n                    result = {\n                        type: expr.type,\n                        arguments: expr.arguments,\n                        signature: expr.signature,\n                        position: expr.position\n                    };\n                    var body = processAST(expr.body);\n                    result.body = tailCallOptimize(body);\n                    break;\n                case 'condition':\n                    result = {type: expr.type, position: expr.position};\n                    result.condition = processAST(expr.condition);\n                    pushAncestry(result, result.condition);\n                    result.then = processAST(expr.then);\n                    pushAncestry(result, result.then);\n                    if (typeof expr.else !== 'undefined') {\n                        result.else = processAST(expr.else);\n                        pushAncestry(result, result.else);\n                    }\n                    break;\n                case 'transform':\n                    result = {type: expr.type, position: expr.position};\n                    result.pattern = processAST(expr.pattern);\n                    result.update = processAST(expr.update);\n                    if (typeof expr.delete !== 'undefined') {\n                        result.delete = processAST(expr.delete);\n                    }\n                    break;\n                case 'block':\n                    result = {type: expr.type, position: expr.position};\n                    // array of expressions - process each one\n                    result.expressions = expr.expressions.map(function (item) {\n                        var part = processAST(item);\n                        pushAncestry(result, part);\n                        if (part.consarray || (part.type === 'path' && part.steps[0].consarray)) {\n                            result.consarray = true;\n                        }\n                        return part;\n                    });\n                    // TODO scan the array of expressions to see if any of them assign variables\n                    // if so, need to mark the block as one that needs to create a new frame\n                    break;\n                case 'name':\n                    result = {type: 'path', steps: [expr]};\n                    if (expr.keepArray) {\n                        result.keepSingletonArray = true;\n                    }\n                    break;\n                case 'parent':\n                    result = {type: 'parent', slot: { label: '!' + ancestorLabel++, level: 1, index: ancestorIndex++ } };\n                    ancestry.push(result);\n                    break;\n                case 'string':\n                case 'number':\n                case 'value':\n                case 'wildcard':\n                case 'descendant':\n                case 'variable':\n                case 'regex':\n                    result = expr;\n                    break;\n                case 'operator':\n                    // the tokens 'and' and 'or' might have been used as a name rather than an operator\n                    if (expr.value === 'and' || expr.value === 'or' || expr.value === 'in') {\n                        expr.type = 'name';\n                        result = processAST(expr);\n                    } else /* istanbul ignore else */ if (expr.value === '?') {\n                        // partial application\n                        result = expr;\n                    } else {\n                        throw {\n                            code: \"S0201\",\n                            stack: (new Error()).stack,\n                            position: expr.position,\n                            token: expr.value\n                        };\n                    }\n                    break;\n                case 'error':\n                    result = expr;\n                    if (expr.lhs) {\n                        result = processAST(expr.lhs);\n                    }\n                    break;\n                default:\n                    var code = \"S0206\";\n                    /* istanbul ignore else */\n                    if (expr.id === '(end)') {\n                        code = \"S0207\";\n                    }\n                    var err = {\n                        code: code,\n                        position: expr.position,\n                        token: expr.value\n                    };\n                    if (recover) {\n                        errors.push(err);\n                        return {type: 'error', error: err};\n                    } else {\n                        err.stack = (new Error()).stack;\n                        throw err;\n                    }\n            }\n            if (expr.keepArray) {\n                result.keepArray = true;\n            }\n            return result;\n        };\n\n        // now invoke the tokenizer and the parser and return the syntax tree\n        lexer = tokenizer(source);\n        advance();\n        // parse the tokens\n        var expr = expression(0);\n        if (node.id !== '(end)') {\n            var err = {\n                code: \"S0201\",\n                position: node.position,\n                token: node.value\n            };\n            handleError(err);\n        }\n        expr = processAST(expr);\n\n        if(expr.type === 'parent' || typeof expr.seekingParent !== 'undefined') {\n            // error - trying to derive ancestor at top level\n            throw {\n                code: \"S0217\",\n                token: expr.type,\n                position: expr.position\n            };\n        }\n\n        if (errors.length > 0) {\n            expr.errors = errors;\n        }\n\n        return expr;\n    };\n\n    return parser;\n})();\n\nmodule.exports = parser;\n\n},{\"./signature\":5}],5:[function(require,module,exports){\n/**\n * © Copyright IBM Corp. 2016, 2018 All Rights Reserved\n *   Project name: JSONata\n *   This project is licensed under the MIT License, see LICENSE\n */\n\nvar utils = require('./utils');\n\nconst signature = (() => {\n    'use strict';\n\n    // A mapping between the function signature symbols and the full plural of the type\n    // Expected to be used in error messages\n    var arraySignatureMapping = {\n        \"a\": \"arrays\",\n        \"b\": \"booleans\",\n        \"f\": \"functions\",\n        \"n\": \"numbers\",\n        \"o\": \"objects\",\n        \"s\": \"strings\"\n    };\n\n    /**\n     * Parses a function signature definition and returns a validation function\n     * @param {string} signature - the signature between the <angle brackets>\n     * @returns {Function} validation function\n     */\n    function parseSignature(signature) {\n        // create a Regex that represents this signature and return a function that when invoked,\n        // returns the validated (possibly fixed-up) arguments, or throws a validation error\n        // step through the signature, one symbol at a time\n        var position = 1;\n        var params = [];\n        var param = {};\n        var prevParam = param;\n        while (position < signature.length) {\n            var symbol = signature.charAt(position);\n            if (symbol === ':') {\n                // TODO figure out what to do with the return type\n                // ignore it for now\n                break;\n            }\n\n            var next = function () {\n                params.push(param);\n                prevParam = param;\n                param = {};\n            };\n\n            var findClosingBracket = function (str, start, openSymbol, closeSymbol) {\n                // returns the position of the closing symbol (e.g. bracket) in a string\n                // that balances the opening symbol at position start\n                var depth = 1;\n                var position = start;\n                while (position < str.length) {\n                    position++;\n                    symbol = str.charAt(position);\n                    if (symbol === closeSymbol) {\n                        depth--;\n                        if (depth === 0) {\n                            // we're done\n                            break; // out of while loop\n                        }\n                    } else if (symbol === openSymbol) {\n                        depth++;\n                    }\n                }\n                return position;\n            };\n\n            switch (symbol) {\n                case 's': // string\n                case 'n': // number\n                case 'b': // boolean\n                case 'l': // not so sure about expecting null?\n                case 'o': // object\n                    param.regex = '[' + symbol + 'm]';\n                    param.type = symbol;\n                    next();\n                    break;\n                case 'a': // array\n                    //  normally treat any value as singleton array\n                    param.regex = '[asnblfom]';\n                    param.type = symbol;\n                    param.array = true;\n                    next();\n                    break;\n                case 'f': // function\n                    param.regex = 'f';\n                    param.type = symbol;\n                    next();\n                    break;\n                case 'j': // any JSON type\n                    param.regex = '[asnblom]';\n                    param.type = symbol;\n                    next();\n                    break;\n                case 'x': // any type\n                    param.regex = '[asnblfom]';\n                    param.type = symbol;\n                    next();\n                    break;\n                case '-': // use context if param not supplied\n                    prevParam.context = true;\n                    prevParam.contextRegex = new RegExp(prevParam.regex); // pre-compiled to test the context type at runtime\n                    prevParam.regex += '?';\n                    break;\n                case '?': // optional param\n                case '+': // one or more\n                    prevParam.regex += symbol;\n                    break;\n                case '(': // choice of types\n                    // search forward for matching ')'\n                    var endParen = findClosingBracket(signature, position, '(', ')');\n                    var choice = signature.substring(position + 1, endParen);\n                    if (choice.indexOf('<') === -1) {\n                        // no parameterized types, simple regex\n                        param.regex = '[' + choice + 'm]';\n                    } else {\n                        // TODO harder\n                        throw {\n                            code: \"S0402\",\n                            stack: (new Error()).stack,\n                            value: choice,\n                            offset: position\n                        };\n                    }\n                    param.type = '(' + choice + ')';\n                    position = endParen;\n                    next();\n                    break;\n                case '<': // type parameter - can only be applied to 'a' and 'f'\n                    if (prevParam.type === 'a' || prevParam.type === 'f') {\n                        // search forward for matching '>'\n                        var endPos = findClosingBracket(signature, position, '<', '>');\n                        prevParam.subtype = signature.substring(position + 1, endPos);\n                        position = endPos;\n                    } else {\n                        throw {\n                            code: \"S0401\",\n                            stack: (new Error()).stack,\n                            value: prevParam.type,\n                            offset: position\n                        };\n                    }\n                    break;\n            }\n            position++;\n        }\n        var regexStr = '^' +\n            params.map(function (param) {\n                return '(' + param.regex + ')';\n            }).join('') +\n            '$';\n        var regex = new RegExp(regexStr);\n        var getSymbol = function (value) {\n            var symbol;\n            if (utils.isFunction(value)) {\n                symbol = 'f';\n            } else {\n                var type = typeof value;\n                switch (type) {\n                    case 'string':\n                        symbol = 's';\n                        break;\n                    case 'number':\n                        symbol = 'n';\n                        break;\n                    case 'boolean':\n                        symbol = 'b';\n                        break;\n                    case 'object':\n                        if (value === null) {\n                            symbol = 'l';\n                        } else if (Array.isArray(value)) {\n                            symbol = 'a';\n                        } else {\n                            symbol = 'o';\n                        }\n                        break;\n                    case 'undefined':\n                    default:\n                        // any value can be undefined, but should be allowed to match\n                        symbol = 'm'; // m for missing\n                }\n            }\n            return symbol;\n        };\n\n        var throwValidationError = function (badArgs, badSig) {\n            // to figure out where this went wrong we need apply each component of the\n            // regex to each argument until we get to the one that fails to match\n            var partialPattern = '^';\n            var goodTo = 0;\n            for (var index = 0; index < params.length; index++) {\n                partialPattern += params[index].regex;\n                var match = badSig.match(partialPattern);\n                if (match === null) {\n                    // failed here\n                    throw {\n                        code: \"T0410\",\n                        stack: (new Error()).stack,\n                        value: badArgs[goodTo],\n                        index: goodTo + 1\n                    };\n                }\n                goodTo = match[0].length;\n            }\n            // if it got this far, it's probably because of extraneous arguments (we\n            // haven't added the trailing '$' in the regex yet.\n            throw {\n                code: \"T0410\",\n                stack: (new Error()).stack,\n                value: badArgs[goodTo],\n                index: goodTo + 1\n            };\n        };\n\n        return {\n            definition: signature,\n            validate: function (args, context) {\n                var suppliedSig = '';\n                args.forEach(function (arg) {\n                    suppliedSig += getSymbol(arg);\n                });\n                var isValid = regex.exec(suppliedSig);\n                if (isValid) {\n                    var validatedArgs = [];\n                    var argIndex = 0;\n                    params.forEach(function (param, index) {\n                        var arg = args[argIndex];\n                        var match = isValid[index + 1];\n                        if (match === '') {\n                            if (param.context && param.contextRegex) {\n                                // substitute context value for missing arg\n                                // first check that the context value is the right type\n                                var contextType = getSymbol(context);\n                                // test contextType against the regex for this arg (without the trailing ?)\n                                if (param.contextRegex.test(contextType)) {\n                                    validatedArgs.push(context);\n                                } else {\n                                    // context value not compatible with this argument\n                                    throw {\n                                        code: \"T0411\",\n                                        stack: (new Error()).stack,\n                                        value: context,\n                                        index: argIndex + 1\n                                    };\n                                }\n                            } else {\n                                validatedArgs.push(arg);\n                                argIndex++;\n                            }\n                        } else {\n                            // may have matched multiple args (if the regex ends with a '+'\n                            // split into single tokens\n                            match.split('').forEach(function (single) {\n                                if (param.type === 'a') {\n                                    if (single === 'm') {\n                                        // missing (undefined)\n                                        arg = undefined;\n                                    } else {\n                                        arg = args[argIndex];\n                                        var arrayOK = true;\n                                        // is there type information on the contents of the array?\n                                        if (typeof param.subtype !== 'undefined') {\n                                            if (single !== 'a' && match !== param.subtype) {\n                                                arrayOK = false;\n                                            } else if (single === 'a') {\n                                                if (arg.length > 0) {\n                                                    var itemType = getSymbol(arg[0]);\n                                                    if (itemType !== param.subtype.charAt(0)) { // TODO recurse further\n                                                        arrayOK = false;\n                                                    } else {\n                                                        // make sure every item in the array is this type\n                                                        var differentItems = arg.filter(function (val) {\n                                                            return (getSymbol(val) !== itemType);\n                                                        });\n                                                        arrayOK = (differentItems.length === 0);\n                                                    }\n                                                }\n                                            }\n                                        }\n                                        if (!arrayOK) {\n                                            throw {\n                                                code: \"T0412\",\n                                                stack: (new Error()).stack,\n                                                value: arg,\n                                                index: argIndex + 1,\n                                                type: arraySignatureMapping[param.subtype]\n                                            };\n                                        }\n                                        // the function expects an array. If it's not one, make it so\n                                        if (single !== 'a') {\n                                            arg = [arg];\n                                        }\n                                    }\n                                    validatedArgs.push(arg);\n                                    argIndex++;\n                                } else {\n                                    validatedArgs.push(arg);\n                                    argIndex++;\n                                }\n                            });\n                        }\n                    });\n                    return validatedArgs;\n                }\n                throwValidationError(args, suppliedSig);\n            }\n        };\n    }\n\n    return parseSignature;\n})();\n\nmodule.exports = signature;\n\n},{\"./utils\":6}],6:[function(require,module,exports){\n/**\n * © Copyright IBM Corp. 2016, 2018 All Rights Reserved\n *   Project name: JSONata\n *   This project is licensed under the MIT License, see LICENSE\n */\n\nconst utils = (() => {\n    'use strict';\n\n    /**\n     * Check if value is a finite number\n     * @param {float} n - number to evaluate\n     * @returns {boolean} True if n is a finite number\n     */\n    function isNumeric(n) {\n        var isNum = false;\n        if(typeof n === 'number') {\n            isNum = !isNaN(n);\n            if (isNum && !isFinite(n)) {\n                throw {\n                    code: \"D1001\",\n                    value: n,\n                    stack: (new Error()).stack\n                };\n            }\n        }\n        return isNum;\n    }\n\n    /**\n     * Returns true if the arg is an array of strings\n     * @param {*} arg - the item to test\n     * @returns {boolean} True if arg is an array of strings\n     */\n    function isArrayOfStrings(arg) {\n        var result = false;\n        /* istanbul ignore else */\n        if(Array.isArray(arg)) {\n            result = (arg.filter(function(item){return typeof item !== 'string';}).length === 0);\n        }\n        return result;\n    }\n\n    /**\n     * Returns true if the arg is an array of numbers\n     * @param {*} arg - the item to test\n     * @returns {boolean} True if arg is an array of numbers\n     */\n    function isArrayOfNumbers(arg) {\n        var result = false;\n        if(Array.isArray(arg)) {\n            result = (arg.filter(function(item){return !isNumeric(item);}).length === 0);\n        }\n        return result;\n    }\n\n    /**\n     * Create an empty sequence to contain query results\n     * @returns {Array} - empty sequence\n     */\n    function createSequence() {\n        var sequence = [];\n        sequence.sequence = true;\n        if (arguments.length === 1) {\n            sequence.push(arguments[0]);\n        }\n        return sequence;\n    }\n\n    /**\n     * Tests if a value is a sequence\n     * @param {*} value the value to test\n     * @returns {boolean} true if it's a sequence\n     */\n    function isSequence(value) {\n        return value.sequence === true && Array.isArray(value);\n    }\n\n    /**\n     *\n     * @param {Object} arg - expression to test\n     * @returns {boolean} - true if it is a function (lambda or built-in)\n     */\n    function isFunction(arg) {\n        return ((arg && (arg._jsonata_function === true || arg._jsonata_lambda === true)) || typeof arg === 'function');\n    }\n\n    /**\n     * Returns the arity (number of arguments) of the function\n     * @param {*} func - the function\n     * @returns {*} - the arity\n     */\n    function getFunctionArity(func) {\n        var arity = typeof func.arity === 'number' ? func.arity :\n            typeof func.implementation === 'function' ? func.implementation.length :\n                typeof func.length === 'number' ? func.length : func.arguments.length;\n        return arity;\n    }\n\n    /**\n     * Tests whether arg is a lambda function\n     * @param {*} arg - the value to test\n     * @returns {boolean} - true if it is a lambda function\n     */\n    function isLambda(arg) {\n        return arg && arg._jsonata_lambda === true;\n    }\n\n    // istanbul ignore next\n    var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n    // istanbul ignore next\n    var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n\n    /**\n     * @param {Object} arg - expression to test\n     * @returns {boolean} - true if it is iterable\n     */\n    function isIterable(arg) {\n        return (\n            typeof arg === 'object' &&\n            arg !== null &&\n            iteratorSymbol in arg &&\n            'next' in arg &&\n            typeof arg.next === 'function'\n        );\n    }\n\n    /**\n     * Compares two values for equality\n     * @param {*} lhs first value\n     * @param {*} rhs second value\n     * @returns {boolean} true if they are deep equal\n     */\n    function isDeepEqual(lhs, rhs) {\n        if (lhs === rhs) {\n            return true;\n        }\n        if(typeof lhs === 'object' && typeof rhs === 'object' && lhs !== null && rhs !== null) {\n            if(Array.isArray(lhs) && Array.isArray(rhs)) {\n                // both arrays (or sequences)\n                // must be the same length\n                if(lhs.length !== rhs.length) {\n                    return false;\n                }\n                // must contain same values in same order\n                for(var ii = 0; ii < lhs.length; ii++) {\n                    if(!isDeepEqual(lhs[ii], rhs[ii])) {\n                        return false;\n                    }\n                }\n                return true;\n            }\n            // both objects\n            // must have the same set of keys (in any order)\n            var lkeys = Object.getOwnPropertyNames(lhs);\n            var rkeys = Object.getOwnPropertyNames(rhs);\n            if(lkeys.length !== rkeys.length) {\n                return false;\n            }\n            lkeys = lkeys.sort();\n            rkeys = rkeys.sort();\n            for(ii=0; ii < lkeys.length; ii++) {\n                if(lkeys[ii] !== rkeys[ii]) {\n                    return false;\n                }\n            }\n            // must have the same values\n            for(ii=0; ii < lkeys.length; ii++) {\n                var key = lkeys[ii];\n                if(!isDeepEqual(lhs[key], rhs[key])) {\n                    return false;\n                }\n            }\n            return true;\n        }\n        return false;\n    }\n\n    /**\n     * converts a string to an array of characters\n     * @param {string} str - the input string\n     * @returns {Array} - the array of characters\n     */\n    function stringToArray(str) {\n        var arr = [];\n        for (let char of str) {\n            arr.push(char);\n        }\n        return arr;\n    }\n\n    return {\n        isNumeric,\n        isArrayOfStrings,\n        isArrayOfNumbers,\n        createSequence,\n        isSequence,\n        isFunction,\n        isLambda,\n        isIterable,\n        getFunctionArity,\n        isDeepEqual,\n        stringToArray\n    };\n})();\n\nmodule.exports = utils;\n\n},{}]},{},[3])(3)\n});\n","var root = require('./_root');\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\nmodule.exports = Symbol;\n","/**\n * A faster alternative to `Function#apply`, this function invokes `func`\n * with the `this` binding of `thisArg` and the arguments of `args`.\n *\n * @private\n * @param {Function} func The function to invoke.\n * @param {*} thisArg The `this` binding of `func`.\n * @param {Array} args The arguments to invoke `func` with.\n * @returns {*} Returns the result of `func`.\n */\nfunction apply(func, thisArg, args) {\n  switch (args.length) {\n    case 0: return func.call(thisArg);\n    case 1: return func.call(thisArg, args[0]);\n    case 2: return func.call(thisArg, args[0], args[1]);\n    case 3: return func.call(thisArg, args[0], args[1], args[2]);\n  }\n  return func.apply(thisArg, args);\n}\n\nmodule.exports = apply;\n","var baseTimes = require('./_baseTimes'),\n    isArguments = require('./isArguments'),\n    isArray = require('./isArray'),\n    isBuffer = require('./isBuffer'),\n    isIndex = require('./_isIndex'),\n    isTypedArray = require('./isTypedArray');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Creates an array of the enumerable property names of the array-like `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @param {boolean} inherited Specify returning inherited property names.\n * @returns {Array} Returns the array of property names.\n */\nfunction arrayLikeKeys(value, inherited) {\n  var isArr = isArray(value),\n      isArg = !isArr && isArguments(value),\n      isBuff = !isArr && !isArg && isBuffer(value),\n      isType = !isArr && !isArg && !isBuff && isTypedArray(value),\n      skipIndexes = isArr || isArg || isBuff || isType,\n      result = skipIndexes ? baseTimes(value.length, String) : [],\n      length = result.length;\n\n  for (var key in value) {\n    if ((inherited || hasOwnProperty.call(value, key)) &&\n        !(skipIndexes && (\n           // Safari 9 has enumerable `arguments.length` in strict mode.\n           key == 'length' ||\n           // Node.js 0.10 has enumerable non-index properties on buffers.\n           (isBuff && (key == 'offset' || key == 'parent')) ||\n           // PhantomJS 2 has enumerable non-index properties on typed arrays.\n           (isType && (key == 'buffer' || key == 'byteLength' || key == 'byteOffset')) ||\n           // Skip index properties.\n           isIndex(key, length)\n        ))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = arrayLikeKeys;\n","var Symbol = require('./_Symbol'),\n    getRawTag = require('./_getRawTag'),\n    objectToString = require('./_objectToString');\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\nmodule.exports = baseGetTag;\n","var baseGetTag = require('./_baseGetTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]';\n\n/**\n * The base implementation of `_.isArguments`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n */\nfunction baseIsArguments(value) {\n  return isObjectLike(value) && baseGetTag(value) == argsTag;\n}\n\nmodule.exports = baseIsArguments;\n","var isFunction = require('./isFunction'),\n    isMasked = require('./_isMasked'),\n    isObject = require('./isObject'),\n    toSource = require('./_toSource');\n\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\n\n/** Used to detect host constructors (Safari). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/**\n * The base implementation of `_.isNative` without bad shim checks.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function,\n *  else `false`.\n */\nfunction baseIsNative(value) {\n  if (!isObject(value) || isMasked(value)) {\n    return false;\n  }\n  var pattern = isFunction(value) ? reIsNative : reIsHostCtor;\n  return pattern.test(toSource(value));\n}\n\nmodule.exports = baseIsNative;\n","var baseGetTag = require('./_baseGetTag'),\n    isLength = require('./isLength'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    funcTag = '[object Function]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    objectTag = '[object Object]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    weakMapTag = '[object WeakMap]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/** Used to identify `toStringTag` values of typed arrays. */\nvar typedArrayTags = {};\ntypedArrayTags[float32Tag] = typedArrayTags[float64Tag] =\ntypedArrayTags[int8Tag] = typedArrayTags[int16Tag] =\ntypedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =\ntypedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =\ntypedArrayTags[uint32Tag] = true;\ntypedArrayTags[argsTag] = typedArrayTags[arrayTag] =\ntypedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =\ntypedArrayTags[dataViewTag] = typedArrayTags[dateTag] =\ntypedArrayTags[errorTag] = typedArrayTags[funcTag] =\ntypedArrayTags[mapTag] = typedArrayTags[numberTag] =\ntypedArrayTags[objectTag] = typedArrayTags[regexpTag] =\ntypedArrayTags[setTag] = typedArrayTags[stringTag] =\ntypedArrayTags[weakMapTag] = false;\n\n/**\n * The base implementation of `_.isTypedArray` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n */\nfunction baseIsTypedArray(value) {\n  return isObjectLike(value) &&\n    isLength(value.length) && !!typedArrayTags[baseGetTag(value)];\n}\n\nmodule.exports = baseIsTypedArray;\n","var isObject = require('./isObject'),\n    isPrototype = require('./_isPrototype'),\n    nativeKeysIn = require('./_nativeKeysIn');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * The base implementation of `_.keysIn` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeysIn(object) {\n  if (!isObject(object)) {\n    return nativeKeysIn(object);\n  }\n  var isProto = isPrototype(object),\n      result = [];\n\n  for (var key in object) {\n    if (!(key == 'constructor' && (isProto || !hasOwnProperty.call(object, key)))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseKeysIn;\n","var identity = require('./identity'),\n    overRest = require('./_overRest'),\n    setToString = require('./_setToString');\n\n/**\n * The base implementation of `_.rest` which doesn't validate or coerce arguments.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @returns {Function} Returns the new function.\n */\nfunction baseRest(func, start) {\n  return setToString(overRest(func, start, identity), func + '');\n}\n\nmodule.exports = baseRest;\n","var constant = require('./constant'),\n    defineProperty = require('./_defineProperty'),\n    identity = require('./identity');\n\n/**\n * The base implementation of `setToString` without support for hot loop shorting.\n *\n * @private\n * @param {Function} func The function to modify.\n * @param {Function} string The `toString` result.\n * @returns {Function} Returns `func`.\n */\nvar baseSetToString = !defineProperty ? identity : function(func, string) {\n  return defineProperty(func, 'toString', {\n    'configurable': true,\n    'enumerable': false,\n    'value': constant(string),\n    'writable': true\n  });\n};\n\nmodule.exports = baseSetToString;\n","/**\n * The base implementation of `_.times` without support for iteratee shorthands\n * or max array length checks.\n *\n * @private\n * @param {number} n The number of times to invoke `iteratee`.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the array of results.\n */\nfunction baseTimes(n, iteratee) {\n  var index = -1,\n      result = Array(n);\n\n  while (++index < n) {\n    result[index] = iteratee(index);\n  }\n  return result;\n}\n\nmodule.exports = baseTimes;\n","/**\n * The base implementation of `_.unary` without support for storing metadata.\n *\n * @private\n * @param {Function} func The function to cap arguments for.\n * @returns {Function} Returns the new capped function.\n */\nfunction baseUnary(func) {\n  return function(value) {\n    return func(value);\n  };\n}\n\nmodule.exports = baseUnary;\n","var root = require('./_root');\n\n/** Used to detect overreaching core-js shims. */\nvar coreJsData = root['__core-js_shared__'];\n\nmodule.exports = coreJsData;\n","var getNative = require('./_getNative');\n\nvar defineProperty = (function() {\n  try {\n    var func = getNative(Object, 'defineProperty');\n    func({}, '', {});\n    return func;\n  } catch (e) {}\n}());\n\nmodule.exports = defineProperty;\n","/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\nmodule.exports = freeGlobal;\n","var baseIsNative = require('./_baseIsNative'),\n    getValue = require('./_getValue');\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = getValue(object, key);\n  return baseIsNative(value) ? value : undefined;\n}\n\nmodule.exports = getNative;\n","var Symbol = require('./_Symbol');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nmodule.exports = getRawTag;\n","/**\n * Gets the value at `key` of `object`.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction getValue(object, key) {\n  return object == null ? undefined : object[key];\n}\n\nmodule.exports = getValue;\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/** Used to detect unsigned integer values. */\nvar reIsUint = /^(?:0|[1-9]\\d*)$/;\n\n/**\n * Checks if `value` is a valid array-like index.\n *\n * @private\n * @param {*} value The value to check.\n * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.\n * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.\n */\nfunction isIndex(value, length) {\n  var type = typeof value;\n  length = length == null ? MAX_SAFE_INTEGER : length;\n\n  return !!length &&\n    (type == 'number' ||\n      (type != 'symbol' && reIsUint.test(value))) &&\n        (value > -1 && value % 1 == 0 && value < length);\n}\n\nmodule.exports = isIndex;\n","var eq = require('./eq'),\n    isArrayLike = require('./isArrayLike'),\n    isIndex = require('./_isIndex'),\n    isObject = require('./isObject');\n\n/**\n * Checks if the given arguments are from an iteratee call.\n *\n * @private\n * @param {*} value The potential iteratee value argument.\n * @param {*} index The potential iteratee index or key argument.\n * @param {*} object The potential iteratee object argument.\n * @returns {boolean} Returns `true` if the arguments are from an iteratee call,\n *  else `false`.\n */\nfunction isIterateeCall(value, index, object) {\n  if (!isObject(object)) {\n    return false;\n  }\n  var type = typeof index;\n  if (type == 'number'\n        ? (isArrayLike(object) && isIndex(index, object.length))\n        : (type == 'string' && index in object)\n      ) {\n    return eq(object[index], value);\n  }\n  return false;\n}\n\nmodule.exports = isIterateeCall;\n","var coreJsData = require('./_coreJsData');\n\n/** Used to detect methods masquerading as native. */\nvar maskSrcKey = (function() {\n  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n  return uid ? ('Symbol(src)_1.' + uid) : '';\n}());\n\n/**\n * Checks if `func` has its source masked.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n */\nfunction isMasked(func) {\n  return !!maskSrcKey && (maskSrcKey in func);\n}\n\nmodule.exports = isMasked;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Checks if `value` is likely a prototype object.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.\n */\nfunction isPrototype(value) {\n  var Ctor = value && value.constructor,\n      proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;\n\n  return value === proto;\n}\n\nmodule.exports = isPrototype;\n","/**\n * This function is like\n * [`Object.keys`](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * except that it includes inherited enumerable properties.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction nativeKeysIn(object) {\n  var result = [];\n  if (object != null) {\n    for (var key in Object(object)) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = nativeKeysIn;\n","var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Detect free variable `process` from Node.js. */\nvar freeProcess = moduleExports && freeGlobal.process;\n\n/** Used to access faster Node.js helpers. */\nvar nodeUtil = (function() {\n  try {\n    // Use `util.types` for Node.js 10+.\n    var types = freeModule && freeModule.require && freeModule.require('util').types;\n\n    if (types) {\n      return types;\n    }\n\n    // Legacy `process.binding('util')` for Node.js < 10.\n    return freeProcess && freeProcess.binding && freeProcess.binding('util');\n  } catch (e) {}\n}());\n\nmodule.exports = nodeUtil;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nmodule.exports = objectToString;\n","var apply = require('./_apply');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max;\n\n/**\n * A specialized version of `baseRest` which transforms the rest array.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @param {Function} transform The rest array transform.\n * @returns {Function} Returns the new function.\n */\nfunction overRest(func, start, transform) {\n  start = nativeMax(start === undefined ? (func.length - 1) : start, 0);\n  return function() {\n    var args = arguments,\n        index = -1,\n        length = nativeMax(args.length - start, 0),\n        array = Array(length);\n\n    while (++index < length) {\n      array[index] = args[start + index];\n    }\n    index = -1;\n    var otherArgs = Array(start + 1);\n    while (++index < start) {\n      otherArgs[index] = args[index];\n    }\n    otherArgs[start] = transform(array);\n    return apply(func, this, otherArgs);\n  };\n}\n\nmodule.exports = overRest;\n","var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\nmodule.exports = root;\n","var baseSetToString = require('./_baseSetToString'),\n    shortOut = require('./_shortOut');\n\n/**\n * Sets the `toString` method of `func` to return `string`.\n *\n * @private\n * @param {Function} func The function to modify.\n * @param {Function} string The `toString` result.\n * @returns {Function} Returns `func`.\n */\nvar setToString = shortOut(baseSetToString);\n\nmodule.exports = setToString;\n","/** Used to detect hot functions by number of calls within a span of milliseconds. */\nvar HOT_COUNT = 800,\n    HOT_SPAN = 16;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeNow = Date.now;\n\n/**\n * Creates a function that'll short out and invoke `identity` instead\n * of `func` when it's called `HOT_COUNT` or more times in `HOT_SPAN`\n * milliseconds.\n *\n * @private\n * @param {Function} func The function to restrict.\n * @returns {Function} Returns the new shortable function.\n */\nfunction shortOut(func) {\n  var count = 0,\n      lastCalled = 0;\n\n  return function() {\n    var stamp = nativeNow(),\n        remaining = HOT_SPAN - (stamp - lastCalled);\n\n    lastCalled = stamp;\n    if (remaining > 0) {\n      if (++count >= HOT_COUNT) {\n        return arguments[0];\n      }\n    } else {\n      count = 0;\n    }\n    return func.apply(undefined, arguments);\n  };\n}\n\nmodule.exports = shortOut;\n","/** Used for built-in method references. */\nvar funcProto = Function.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/**\n * Converts `func` to its source code.\n *\n * @private\n * @param {Function} func The function to convert.\n * @returns {string} Returns the source code.\n */\nfunction toSource(func) {\n  if (func != null) {\n    try {\n      return funcToString.call(func);\n    } catch (e) {}\n    try {\n      return (func + '');\n    } catch (e) {}\n  }\n  return '';\n}\n\nmodule.exports = toSource;\n","/**\n * Creates a function that returns `value`.\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Util\n * @param {*} value The value to return from the new function.\n * @returns {Function} Returns the new constant function.\n * @example\n *\n * var objects = _.times(2, _.constant({ 'a': 1 }));\n *\n * console.log(objects);\n * // => [{ 'a': 1 }, { 'a': 1 }]\n *\n * console.log(objects[0] === objects[1]);\n * // => true\n */\nfunction constant(value) {\n  return function() {\n    return value;\n  };\n}\n\nmodule.exports = constant;\n","var baseRest = require('./_baseRest'),\n    eq = require('./eq'),\n    isIterateeCall = require('./_isIterateeCall'),\n    keysIn = require('./keysIn');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Assigns own and inherited enumerable string keyed properties of source\n * objects to the destination object for all destination properties that\n * resolve to `undefined`. Source objects are applied from left to right.\n * Once a property is set, additional values of the same property are ignored.\n *\n * **Note:** This method mutates `object`.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The destination object.\n * @param {...Object} [sources] The source objects.\n * @returns {Object} Returns `object`.\n * @see _.defaultsDeep\n * @example\n *\n * _.defaults({ 'a': 1 }, { 'b': 2 }, { 'a': 3 });\n * // => { 'a': 1, 'b': 2 }\n */\nvar defaults = baseRest(function(object, sources) {\n  object = Object(object);\n\n  var index = -1;\n  var length = sources.length;\n  var guard = length > 2 ? sources[2] : undefined;\n\n  if (guard && isIterateeCall(sources[0], sources[1], guard)) {\n    length = 1;\n  }\n\n  while (++index < length) {\n    var source = sources[index];\n    var props = keysIn(source);\n    var propsIndex = -1;\n    var propsLength = props.length;\n\n    while (++propsIndex < propsLength) {\n      var key = props[propsIndex];\n      var value = object[key];\n\n      if (value === undefined ||\n          (eq(value, objectProto[key]) && !hasOwnProperty.call(object, key))) {\n        object[key] = source[key];\n      }\n    }\n  }\n\n  return object;\n});\n\nmodule.exports = defaults;\n","/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\nmodule.exports = eq;\n","/**\n * This method returns the first argument it receives.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Util\n * @param {*} value Any value.\n * @returns {*} Returns `value`.\n * @example\n *\n * var object = { 'a': 1 };\n *\n * console.log(_.identity(object) === object);\n * // => true\n */\nfunction identity(value) {\n  return value;\n}\n\nmodule.exports = identity;\n","var baseIsArguments = require('./_baseIsArguments'),\n    isObjectLike = require('./isObjectLike');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/**\n * Checks if `value` is likely an `arguments` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n *  else `false`.\n * @example\n *\n * _.isArguments(function() { return arguments; }());\n * // => true\n *\n * _.isArguments([1, 2, 3]);\n * // => false\n */\nvar isArguments = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {\n  return isObjectLike(value) && hasOwnProperty.call(value, 'callee') &&\n    !propertyIsEnumerable.call(value, 'callee');\n};\n\nmodule.exports = isArguments;\n","/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\nmodule.exports = isArray;\n","var isFunction = require('./isFunction'),\n    isLength = require('./isLength');\n\n/**\n * Checks if `value` is array-like. A value is considered array-like if it's\n * not a function and has a `value.length` that's an integer greater than or\n * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n * @example\n *\n * _.isArrayLike([1, 2, 3]);\n * // => true\n *\n * _.isArrayLike(document.body.children);\n * // => true\n *\n * _.isArrayLike('abc');\n * // => true\n *\n * _.isArrayLike(_.noop);\n * // => false\n */\nfunction isArrayLike(value) {\n  return value != null && isLength(value.length) && !isFunction(value);\n}\n\nmodule.exports = isArrayLike;\n","var root = require('./_root'),\n    stubFalse = require('./stubFalse');\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Built-in value references. */\nvar Buffer = moduleExports ? root.Buffer : undefined;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeIsBuffer = Buffer ? Buffer.isBuffer : undefined;\n\n/**\n * Checks if `value` is a buffer.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a buffer, else `false`.\n * @example\n *\n * _.isBuffer(new Buffer(2));\n * // => true\n *\n * _.isBuffer(new Uint8Array(2));\n * // => false\n */\nvar isBuffer = nativeIsBuffer || stubFalse;\n\nmodule.exports = isBuffer;\n","var baseGetTag = require('./_baseGetTag'),\n    isObject = require('./isObject');\n\n/** `Object#toString` result references. */\nvar asyncTag = '[object AsyncFunction]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    proxyTag = '[object Proxy]';\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  if (!isObject(value)) {\n    return false;\n  }\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 9 which returns 'object' for typed arrays and other constructors.\n  var tag = baseGetTag(value);\n  return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;\n}\n\nmodule.exports = isFunction;\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/**\n * Checks if `value` is a valid array-like length.\n *\n * **Note:** This method is loosely based on\n * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n * @example\n *\n * _.isLength(3);\n * // => true\n *\n * _.isLength(Number.MIN_VALUE);\n * // => false\n *\n * _.isLength(Infinity);\n * // => false\n *\n * _.isLength('3');\n * // => false\n */\nfunction isLength(value) {\n  return typeof value == 'number' &&\n    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n}\n\nmodule.exports = isLength;\n","/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\nmodule.exports = isObject;\n","/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nmodule.exports = isObjectLike;\n","var baseIsTypedArray = require('./_baseIsTypedArray'),\n    baseUnary = require('./_baseUnary'),\n    nodeUtil = require('./_nodeUtil');\n\n/* Node.js helper references. */\nvar nodeIsTypedArray = nodeUtil && nodeUtil.isTypedArray;\n\n/**\n * Checks if `value` is classified as a typed array.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n * @example\n *\n * _.isTypedArray(new Uint8Array);\n * // => true\n *\n * _.isTypedArray([]);\n * // => false\n */\nvar isTypedArray = nodeIsTypedArray ? baseUnary(nodeIsTypedArray) : baseIsTypedArray;\n\nmodule.exports = isTypedArray;\n","var arrayLikeKeys = require('./_arrayLikeKeys'),\n    baseKeysIn = require('./_baseKeysIn'),\n    isArrayLike = require('./isArrayLike');\n\n/**\n * Creates an array of the own and inherited enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keysIn(new Foo);\n * // => ['a', 'b', 'c'] (iteration order is not guaranteed)\n */\nfunction keysIn(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object, true) : baseKeysIn(object);\n}\n\nmodule.exports = keysIn;\n","/**\n * This method returns `false`.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {boolean} Returns `false`.\n * @example\n *\n * _.times(2, _.stubFalse);\n * // => [false, false]\n */\nfunction stubFalse() {\n  return false;\n}\n\nmodule.exports = stubFalse;\n","'use strict';\n\nfunction Cache () {\n  var _cache = Object.create(null);\n  var _hitCount = 0;\n  var _missCount = 0;\n  var _size = 0;\n  var _debug = false;\n\n  this.put = function(key, value, time, timeoutCallback) {\n    if (_debug) {\n      console.log('caching: %s = %j (@%s)', key, value, time);\n    }\n\n    if (typeof time !== 'undefined' && (typeof time !== 'number' || isNaN(time) || time <= 0)) {\n      throw new Error('Cache timeout must be a positive number');\n    } else if (typeof timeoutCallback !== 'undefined' && typeof timeoutCallback !== 'function') {\n      throw new Error('Cache timeout callback must be a function');\n    }\n\n    var oldRecord = _cache[key];\n    if (oldRecord) {\n      clearTimeout(oldRecord.timeout);\n    } else {\n      _size++;\n    }\n\n    var record = {\n      value: value,\n      expire: time + Date.now()\n    };\n\n    if (!isNaN(record.expire)) {\n      record.timeout = setTimeout(function() {\n        _del(key);\n        if (timeoutCallback) {\n          timeoutCallback(key, value);\n        }\n      }.bind(this), time);\n    }\n\n    _cache[key] = record;\n\n    return value;\n  };\n\n  this.del = function(key) {\n    var canDelete = true;\n\n    var oldRecord = _cache[key];\n    if (oldRecord) {\n      clearTimeout(oldRecord.timeout);\n      if (!isNaN(oldRecord.expire) && oldRecord.expire < Date.now()) {\n        canDelete = false;\n      }\n    } else {\n      canDelete = false;\n    }\n\n    if (canDelete) {\n      _del(key);\n    }\n\n    return canDelete;\n  };\n\n  function _del(key){\n    _size--;\n    delete _cache[key];\n  }\n\n  this.clear = function() {\n    for (var key in _cache) {\n      clearTimeout(_cache[key].timeout);\n    }\n    _size = 0;\n    _cache = Object.create(null);\n    if (_debug) {\n      _hitCount = 0;\n      _missCount = 0;\n    }\n  };\n\n  this.get = function(key) {\n    var data = _cache[key];\n    if (typeof data != \"undefined\") {\n      if (isNaN(data.expire) || data.expire >= Date.now()) {\n        if (_debug) _hitCount++;\n        return data.value;\n      } else {\n        // free some space\n        if (_debug) _missCount++;\n        _size--;\n        delete _cache[key];\n      }\n    } else if (_debug) {\n      _missCount++;\n    }\n    return null;\n  };\n\n  this.size = function() {\n    return _size;\n  };\n\n  this.memsize = function() {\n    var size = 0,\n      key;\n    for (key in _cache) {\n      size++;\n    }\n    return size;\n  };\n\n  this.debug = function(bool) {\n    _debug = bool;\n  };\n\n  this.hits = function() {\n    return _hitCount;\n  };\n\n  this.misses = function() {\n    return _missCount;\n  };\n\n  this.keys = function() {\n    return Object.keys(_cache);\n  };\n\n  this.exportJson = function() {\n    var plainJsCache = {};\n\n    // Discard the `timeout` property.\n    // Note: JSON doesn't support `NaN`, so convert it to `'NaN'`.\n    for (var key in _cache) {\n      var record = _cache[key];\n      plainJsCache[key] = {\n        value: record.value,\n        expire: record.expire || 'NaN',\n      };\n    }\n\n    return JSON.stringify(plainJsCache);\n  };\n\n  this.importJson = function(jsonToImport, options) {\n    var cacheToImport = JSON.parse(jsonToImport);\n    var currTime = Date.now();\n\n    var skipDuplicates = options && options.skipDuplicates;\n\n    for (var key in cacheToImport) {\n      if (cacheToImport.hasOwnProperty(key)) {\n        if (skipDuplicates) {\n          var existingRecord = _cache[key];\n          if (existingRecord) {\n            if (_debug) {\n              console.log('Skipping duplicate imported key \\'%s\\'', key);\n            }\n            continue;\n          }\n        }\n\n        var record = cacheToImport[key];\n\n        // record.expire could be `'NaN'` if no expiry was set.\n        // Try to subtract from it; a string minus a number is `NaN`, which is perfectly fine here.\n        var remainingTime = record.expire - currTime;\n\n        if (remainingTime <= 0) {\n          // Delete any record that might exist with the same key, since this key is expired.\n          this.del(key);\n          continue;\n        }\n\n        // Remaining time must now be either positive or `NaN`,\n        // but `put` will throw an error if we try to give it `NaN`.\n        remainingTime = remainingTime > 0 ? remainingTime : undefined;\n\n        this.put(key, record.value, remainingTime);\n      }\n    }\n\n    return this.size();\n  };\n}\n\nmodule.exports = new Cache();\nmodule.exports.Cache = Cache;\n","module.exports = __WEBPACK_EXTERNAL_MODULE__7644__;","module.exports = __WEBPACK_EXTERNAL_MODULE__3305__;","module.exports = __WEBPACK_EXTERNAL_MODULE__3545__;","module.exports = __WEBPACK_EXTERNAL_MODULE__7388__;","module.exports = __WEBPACK_EXTERNAL_MODULE__5980__;","module.exports = __WEBPACK_EXTERNAL_MODULE__8283__;","module.exports = __WEBPACK_EXTERNAL_MODULE__2650__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.nmd = (module) => {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","import React__default from 'react';\nimport { css, cx } from '@emotion/css';\nimport { useTheme2 } from '@grafana/ui';\n\nvar __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nconst DataSourceDescription = ({ dataSourceName, docsLink, hasRequiredFields = true, className }) => {\n  const theme = useTheme2();\n  const styles = {\n    container: css({\n      p: {\n        margin: 0\n      },\n      \"p + p\": {\n        marginTop: theme.spacing(2)\n      }\n    }),\n    text: css(__spreadProps(__spreadValues({}, theme.typography.body), {\n      color: theme.colors.text.secondary,\n      a: css({\n        color: theme.colors.text.link,\n        textDecoration: \"underline\",\n        \"&:hover\": {\n          textDecoration: \"none\"\n        }\n      })\n    }))\n  };\n  return /* @__PURE__ */ React__default.createElement(\"div\", { className: cx(styles.container, className) }, /* @__PURE__ */ React__default.createElement(\"p\", { className: styles.text }, \"Before you can use the \", dataSourceName, \" data source, you must configure it below or in the config file. For detailed instructions,\", \" \", /* @__PURE__ */ React__default.createElement(\"a\", { href: docsLink, target: \"_blank\", rel: \"noreferrer\" }, \"view the documentation\"), \".\"), hasRequiredFields && /* @__PURE__ */ React__default.createElement(\"p\", { className: styles.text }, /* @__PURE__ */ React__default.createElement(\"i\", null, \"Fields marked with * are required\")));\n};\n\nexport { DataSourceDescription };\n//# sourceMappingURL=DataSourceDescription.js.map\n","import React__default, { useState } from 'react';\nimport { css } from '@emotion/css';\nimport { useTheme2, IconButton } from '@grafana/ui';\n\nvar __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nconst GenericConfigSection = ({\n  children,\n  title,\n  description,\n  isCollapsible = false,\n  isInitiallyOpen = true,\n  kind = \"section\",\n  className\n}) => {\n  const { colors, typography, spacing } = useTheme2();\n  const [isOpen, setIsOpen] = useState(isCollapsible ? isInitiallyOpen : true);\n  const iconName = isOpen ? \"angle-up\" : \"angle-down\";\n  const isSubSection = kind === \"sub-section\";\n  const collapsibleButtonAriaLabel = `${isOpen ? \"Collapse\" : \"Expand\"} section ${title}`;\n  const styles = {\n    header: css({\n      display: \"flex\",\n      justifyContent: \"space-between\",\n      alignItems: \"center\"\n    }),\n    title: css({\n      margin: 0\n    }),\n    subtitle: css({\n      margin: 0,\n      fontWeight: typography.fontWeightRegular\n    }),\n    descriptionText: css(__spreadProps(__spreadValues({\n      marginTop: spacing(isSubSection ? 0.25 : 0.5),\n      marginBottom: 0\n    }, typography.bodySmall), {\n      color: colors.text.secondary\n    })),\n    content: css({\n      marginTop: spacing(2)\n    })\n  };\n  return /* @__PURE__ */ React__default.createElement(\"div\", { className }, /* @__PURE__ */ React__default.createElement(\"div\", { className: styles.header }, kind === \"section\" ? /* @__PURE__ */ React__default.createElement(\"h3\", { className: styles.title }, title) : /* @__PURE__ */ React__default.createElement(\"h6\", { className: styles.subtitle }, title), isCollapsible && /* @__PURE__ */ React__default.createElement(\n    IconButton,\n    {\n      name: iconName,\n      onClick: () => setIsOpen(!isOpen),\n      type: \"button\",\n      size: \"xl\",\n      \"aria-label\": collapsibleButtonAriaLabel\n    }\n  )), description && /* @__PURE__ */ React__default.createElement(\"p\", { className: styles.descriptionText }, description), isOpen && /* @__PURE__ */ React__default.createElement(\"div\", { className: styles.content }, children));\n};\n\nexport { GenericConfigSection };\n//# sourceMappingURL=GenericConfigSection.js.map\n","import React__default from 'react';\nimport { GenericConfigSection } from './GenericConfigSection.js';\n\nvar __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nvar __objRest = (source, exclude) => {\n  var target = {};\n  for (var prop in source)\n    if (__hasOwnProp.call(source, prop) && exclude.indexOf(prop) < 0)\n      target[prop] = source[prop];\n  if (source != null && __getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(source)) {\n      if (exclude.indexOf(prop) < 0 && __propIsEnum.call(source, prop))\n        target[prop] = source[prop];\n    }\n  return target;\n};\nconst ConfigSection = (_a) => {\n  var _b = _a, { children } = _b, props = __objRest(_b, [\"children\"]);\n  return /* @__PURE__ */ React__default.createElement(GenericConfigSection, __spreadProps(__spreadValues({}, props), { kind: \"section\" }), children);\n};\n\nexport { ConfigSection };\n//# sourceMappingURL=ConfigSection.js.map\n","import React__default from 'react';\nimport { css, cx } from '@emotion/css';\nimport { InlineField, Input } from '@grafana/ui';\nimport { ConfigSection } from '../ConfigSection/ConfigSection.js';\n\nvar __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nconst ConnectionSettings = ({\n  config,\n  onChange,\n  description,\n  urlPlaceholder,\n  urlTooltip,\n  urlLabel,\n  className\n}) => {\n  const isValidUrl = /^(ftp|http|https):\\/\\/(\\w+:{0,1}\\w*@)?(\\S+)(:[0-9]+)?(\\/|\\/([\\w#!:.?+=&%@!\\-\\/]))?$/.test(\n    config.url\n  );\n  const styles = {\n    container: css({\n      maxWidth: 578\n    })\n  };\n  return /* @__PURE__ */ React__default.createElement(React__default.Fragment, null, /* @__PURE__ */ React__default.createElement(ConfigSection, { title: \"Connection\", description, className: cx(styles.container, className) }, /* @__PURE__ */ React__default.createElement(\n    InlineField,\n    {\n      htmlFor: \"connection-url\",\n      label: urlLabel || \"URL\",\n      labelWidth: 24,\n      tooltip: urlTooltip || /* @__PURE__ */ React__default.createElement(React__default.Fragment, null, \"Specify a complete HTTP URL\", /* @__PURE__ */ React__default.createElement(\"br\", null), \"(for example https://example.com:8080)\"),\n      grow: true,\n      disabled: config.readOnly,\n      required: true,\n      invalid: !isValidUrl && !config.readOnly,\n      error: isValidUrl ? \"\" : \"Please enter a valid URL\",\n      interactive: true\n    },\n    /* @__PURE__ */ React__default.createElement(\n      Input,\n      {\n        id: \"connection-url\",\n        \"aria-label\": \"Data source connection URL\",\n        onChange: (event) => onChange(__spreadProps(__spreadValues({}, config), {\n          url: event.currentTarget.value\n        })),\n        value: config.url || \"\",\n        placeholder: urlPlaceholder || \"URL\"\n      }\n    )\n  )));\n};\n\nexport { ConnectionSettings };\n//# sourceMappingURL=ConnectionSettings.js.map\n","import * as React from 'react';\nimport { HorizontalGroup, Input, Button } from '@grafana/ui';\n\nvar __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nvar __objRest = (source, exclude) => {\n  var target = {};\n  for (var prop in source)\n    if (__hasOwnProp.call(source, prop) && exclude.indexOf(prop) < 0)\n      target[prop] = source[prop];\n  if (source != null && __getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(source)) {\n      if (exclude.indexOf(prop) < 0 && __propIsEnum.call(source, prop))\n        target[prop] = source[prop];\n    }\n  return target;\n};\nconst CONFIGURED_TEXT = \"configured\";\nconst RESET_BUTTON_TEXT = \"Reset\";\nconst SecretInput = (_a) => {\n  var _b = _a, { isConfigured, onReset } = _b, props = __objRest(_b, [\"isConfigured\", \"onReset\"]);\n  return /* @__PURE__ */ React.createElement(HorizontalGroup, null, !isConfigured && /* @__PURE__ */ React.createElement(Input, __spreadProps(__spreadValues({}, props), { type: \"password\" })), isConfigured && /* @__PURE__ */ React.createElement(Input, __spreadProps(__spreadValues({}, props), { type: \"text\", disabled: true, value: CONFIGURED_TEXT })), isConfigured && /* @__PURE__ */ React.createElement(Button, { onClick: onReset, variant: \"secondary\" }, RESET_BUTTON_TEXT));\n};\n\nexport { CONFIGURED_TEXT, RESET_BUTTON_TEXT, SecretInput };\n//# sourceMappingURL=SecretInput.js.map\n","import { css } from '@emotion/css';\n\nconst useCommonStyles = () => {\n  return {\n    inlineFieldNoMarginRight: css({\n      marginRight: 0\n    }),\n    // This is dirty hack to make configured secret input grow\n    inlineFieldWithSecret: css({\n      '[class$=\"layoutChildrenWrapper\"]:first-child': {\n        flexGrow: 1\n      }\n    })\n  };\n};\n\nexport { useCommonStyles };\n//# sourceMappingURL=styles.js.map\n","import React__default from 'react';\nimport { css, cx } from '@emotion/css';\nimport { InlineField, Input } from '@grafana/ui';\nimport { SecretInput } from '../common/SecretInput.js';\nimport { useCommonStyles } from '../styles.js';\n\nconst BasicAuth = ({\n  user,\n  passwordConfigured,\n  userTooltip = \"The username of the data source account\",\n  passwordTooltip = \"The password of the data source account\",\n  onUserChange,\n  onPasswordChange,\n  onPasswordReset,\n  readOnly\n}) => {\n  const commonStyles = useCommonStyles();\n  const styles = {\n    lastInlineField: css({\n      marginBottom: 0\n    })\n  };\n  return /* @__PURE__ */ React__default.createElement(React__default.Fragment, null, /* @__PURE__ */ React__default.createElement(\n    InlineField,\n    {\n      className: commonStyles.inlineFieldNoMarginRight,\n      label: \"User\",\n      labelWidth: 24,\n      tooltip: userTooltip,\n      required: true,\n      htmlFor: \"basic-auth-user-input\",\n      interactive: true,\n      grow: true,\n      disabled: readOnly\n    },\n    /* @__PURE__ */ React__default.createElement(\n      Input,\n      {\n        id: \"basic-auth-user-input\",\n        placeholder: \"User\",\n        value: user,\n        onChange: (e) => onUserChange(e.currentTarget.value),\n        required: true\n      }\n    )\n  ), /* @__PURE__ */ React__default.createElement(\n    InlineField,\n    {\n      className: cx(\n        commonStyles.inlineFieldNoMarginRight,\n        commonStyles.inlineFieldWithSecret,\n        styles.lastInlineField\n      ),\n      label: \"Password\",\n      labelWidth: 24,\n      tooltip: passwordTooltip,\n      required: true,\n      htmlFor: \"basic-auth-password-input\",\n      interactive: true,\n      grow: true,\n      disabled: readOnly\n    },\n    /* @__PURE__ */ React__default.createElement(\n      SecretInput,\n      {\n        id: \"basic-auth-password-input\",\n        isConfigured: passwordConfigured,\n        onReset: readOnly ? () => {\n        } : onPasswordReset,\n        placeholder: \"Password\",\n        onChange: (e) => onPasswordChange(e.currentTarget.value),\n        required: true\n      }\n    )\n  ));\n};\n\nexport { BasicAuth };\n//# sourceMappingURL=BasicAuth.js.map\n","import React__default from 'react';\nimport { GenericConfigSection } from './GenericConfigSection.js';\n\nvar __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nvar __objRest = (source, exclude) => {\n  var target = {};\n  for (var prop in source)\n    if (__hasOwnProp.call(source, prop) && exclude.indexOf(prop) < 0)\n      target[prop] = source[prop];\n  if (source != null && __getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(source)) {\n      if (exclude.indexOf(prop) < 0 && __propIsEnum.call(source, prop))\n        target[prop] = source[prop];\n    }\n  return target;\n};\nconst ConfigSubSection = (_a) => {\n  var _b = _a, { children } = _b, props = __objRest(_b, [\"children\"]);\n  return /* @__PURE__ */ React__default.createElement(GenericConfigSection, __spreadProps(__spreadValues({}, props), { kind: \"sub-section\" }), children);\n};\n\nexport { ConfigSubSection };\n//# sourceMappingURL=ConfigSubSection.js.map\n","var AuthMethod = /* @__PURE__ */ ((AuthMethod2) => {\n  AuthMethod2[\"NoAuth\"] = \"NoAuth\";\n  AuthMethod2[\"BasicAuth\"] = \"BasicAuth\";\n  AuthMethod2[\"OAuthForward\"] = \"OAuthForward\";\n  AuthMethod2[\"CrossSiteCredentials\"] = \"CrossSiteCredentials\";\n  return AuthMethod2;\n})(AuthMethod || {});\n\nexport { AuthMethod };\n//# sourceMappingURL=types.js.map\n","import React__default, { useState, useMemo } from 'react';\nimport { css } from '@emotion/css';\nimport { useTheme2, Select } from '@grafana/ui';\nimport { BasicAuth } from './BasicAuth.js';\nimport { ConfigSubSection } from '../../ConfigSection/ConfigSubSection.js';\nimport { AuthMethod } from '../types.js';\n\nvar __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nconst defaultOptions = {\n  [AuthMethod.BasicAuth]: {\n    label: \"Basic authentication\",\n    value: AuthMethod.BasicAuth,\n    description: \"Authenticate with your data source username and password\"\n  },\n  [AuthMethod.CrossSiteCredentials]: {\n    label: \"Enable cross-site access control requests\",\n    value: AuthMethod.CrossSiteCredentials,\n    description: \"Allow cross-site Access-Control requests with your existing credentials and cookies. This enables the server to authenticate the user and perform authorized requests on their behalf on other domains.\"\n  },\n  [AuthMethod.OAuthForward]: {\n    label: \"Forward OAuth Identity\",\n    value: AuthMethod.OAuthForward,\n    description: \"Forward the OAuth access token (and if available: the OIDC ID token) of the user querying to the data source\"\n  },\n  [AuthMethod.NoAuth]: {\n    label: \"No Authentication\",\n    value: AuthMethod.NoAuth,\n    description: \"Data source is available without authentication\"\n  }\n};\nconst AuthMethodSettings = ({\n  selectedMethod,\n  mostCommonMethod,\n  visibleMethods: visibleMethodsFromProps,\n  extendedDefaultOptions,\n  customMethods,\n  onAuthMethodSelect,\n  basicAuth,\n  readOnly\n}) => {\n  var _a, _b, _c, _d;\n  const [authMethodChanged, setAuthMethodChanged] = useState(false);\n  const { colors, spacing } = useTheme2();\n  const visibleMethods = useMemo(\n    () => {\n      var _a2;\n      return visibleMethodsFromProps != null ? visibleMethodsFromProps : [\n        AuthMethod.BasicAuth,\n        AuthMethod.OAuthForward,\n        AuthMethod.NoAuth,\n        ...(_a2 = customMethods == null ? void 0 : customMethods.map((m) => m.id)) != null ? _a2 : []\n      ];\n    },\n    [customMethods, visibleMethodsFromProps]\n  );\n  const hasSelect = visibleMethods.length > 1;\n  const preparedOptions = useMemo(() => {\n    var _a2;\n    const customOptions = (_a2 = customMethods == null ? void 0 : customMethods.reduce((acc, method) => {\n      acc[method.id] = {\n        label: method.label,\n        value: method.id,\n        description: method.description\n      };\n      return acc;\n    }, {})) != null ? _a2 : {};\n    const preparedDefaultOptions = {};\n    let k;\n    for (k in defaultOptions) {\n      if (extendedDefaultOptions && extendedDefaultOptions[k]) {\n        preparedDefaultOptions[k] = __spreadValues(__spreadValues({}, defaultOptions[k]), extendedDefaultOptions[k]);\n      } else {\n        preparedDefaultOptions[k] = defaultOptions[k];\n      }\n    }\n    const allOptions = __spreadValues(__spreadValues({}, customOptions), preparedDefaultOptions);\n    return visibleMethods.filter((method) => Boolean(allOptions[method])).map((method) => {\n      const option = allOptions[method];\n      if (method === mostCommonMethod && hasSelect) {\n        return __spreadProps(__spreadValues({}, option), {\n          label: `${option.label} (most common)`\n        });\n      }\n      return option;\n    });\n  }, [visibleMethods, customMethods, extendedDefaultOptions, mostCommonMethod, hasSelect]);\n  let selected = selectedMethod;\n  if (!hasSelect) {\n    selected = visibleMethods[0];\n  } else if (selectedMethod === AuthMethod.NoAuth && mostCommonMethod && !authMethodChanged) {\n    selected = mostCommonMethod;\n  }\n  let AuthFieldsComponent = null;\n  if (selected === AuthMethod.BasicAuth && basicAuth) {\n    AuthFieldsComponent = /* @__PURE__ */ React__default.createElement(BasicAuth, __spreadProps(__spreadValues({}, basicAuth), { readOnly }));\n  } else if (selected.startsWith(\"custom-\")) {\n    AuthFieldsComponent = (_b = (_a = customMethods == null ? void 0 : customMethods.find((m) => m.id === selected)) == null ? void 0 : _a.component) != null ? _b : null;\n  }\n  const title = hasSelect ? \"Authentication methods\" : (_c = preparedOptions[0].label) != null ? _c : \"\";\n  const description = hasSelect ? \"Choose an authentication method to access the data source\" : (_d = preparedOptions[0].description) != null ? _d : \"\";\n  const styles = {\n    authMethods: css(__spreadValues({\n      marginTop: spacing(2.5)\n    }, hasSelect && {\n      padding: spacing(2),\n      border: `1px solid ${colors.border.weak}`\n    })),\n    selectedMethodFields: css({\n      marginTop: spacing(1.5)\n    })\n  };\n  return /* @__PURE__ */ React__default.createElement(ConfigSubSection, { title, description }, /* @__PURE__ */ React__default.createElement(\"div\", { className: styles.authMethods }, hasSelect && /* @__PURE__ */ React__default.createElement(\n    Select,\n    {\n      options: preparedOptions,\n      value: selected,\n      onChange: (option) => {\n        setAuthMethodChanged(true);\n        onAuthMethodSelect(option.value);\n      },\n      disabled: readOnly\n    }\n  ), AuthFieldsComponent && /* @__PURE__ */ React__default.createElement(\"div\", { className: styles.selectedMethodFields }, AuthFieldsComponent)));\n};\n\nexport { AuthMethodSettings };\n//# sourceMappingURL=AuthMethodSettings.js.map\n","import { cx, css } from '@emotion/css';\nimport * as React from 'react';\nimport { useStyles2, HorizontalGroup, TextArea, Button } from '@grafana/ui';\n\nvar __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nvar __objRest = (source, exclude) => {\n  var target = {};\n  for (var prop in source)\n    if (__hasOwnProp.call(source, prop) && exclude.indexOf(prop) < 0)\n      target[prop] = source[prop];\n  if (source != null && __getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(source)) {\n      if (exclude.indexOf(prop) < 0 && __propIsEnum.call(source, prop))\n        target[prop] = source[prop];\n    }\n  return target;\n};\nconst CONFIGURED_TEXT = \"configured\";\nconst RESET_BUTTON_TEXT = \"Reset\";\nconst getStyles = (theme) => {\n  return {\n    configuredStyle: css`\n      min-height: ${theme.spacing(theme.components.height.md)};\n      padding-top: ${theme.spacing(0.5)};\n      resize: none;\n    `\n  };\n};\nconst SecretTextArea = (_a) => {\n  var _b = _a, { isConfigured, onReset } = _b, props = __objRest(_b, [\"isConfigured\", \"onReset\"]);\n  const styles = useStyles2(getStyles);\n  return /* @__PURE__ */ React.createElement(HorizontalGroup, null, !isConfigured && /* @__PURE__ */ React.createElement(TextArea, __spreadValues({}, props)), isConfigured && /* @__PURE__ */ React.createElement(TextArea, __spreadProps(__spreadValues({}, props), { rows: 1, disabled: true, value: CONFIGURED_TEXT, className: cx(styles.configuredStyle) })), isConfigured && /* @__PURE__ */ React.createElement(Button, { onClick: onReset, variant: \"secondary\" }, RESET_BUTTON_TEXT));\n};\n\nexport { CONFIGURED_TEXT, RESET_BUTTON_TEXT, SecretTextArea };\n//# sourceMappingURL=SecretTextarea.js.map\n","import React__default from 'react';\nimport { css } from '@emotion/css';\nimport { useTheme2, Checkbox, Tooltip, Icon } from '@grafana/ui';\n\nconst TLSSettingsSection = ({ children, enabled, label, tooltipText, onToggle, readOnly }) => {\n  const { colors, spacing } = useTheme2();\n  const styles = {\n    container: css({\n      marginTop: 3\n    }),\n    checkboxContainer: css({\n      display: \"flex\",\n      alignItems: \"center\"\n    }),\n    infoIcon: css({\n      marginTop: -2,\n      marginLeft: 5,\n      color: colors.text.secondary\n    }),\n    content: css({\n      margin: spacing(1, 0, 2, 3)\n    })\n  };\n  return /* @__PURE__ */ React__default.createElement(\"div\", { className: styles.container }, /* @__PURE__ */ React__default.createElement(\"div\", { className: styles.checkboxContainer }, /* @__PURE__ */ React__default.createElement(Checkbox, { value: enabled, label, onChange: () => onToggle(!enabled), disabled: readOnly }), /* @__PURE__ */ React__default.createElement(Tooltip, { placement: \"top\", content: tooltipText, interactive: true }, /* @__PURE__ */ React__default.createElement(Icon, { name: \"info-circle\", className: styles.infoIcon, size: \"sm\" }))), enabled && children && /* @__PURE__ */ React__default.createElement(\"div\", { className: styles.content }, children));\n};\n\nexport { TLSSettingsSection };\n//# sourceMappingURL=TLSSettingsSection.js.map\n","import React__default from 'react';\nimport { cx } from '@emotion/css';\nimport { InlineField } from '@grafana/ui';\nimport { SecretTextArea } from '../common/SecretTextarea.js';\nimport { TLSSettingsSection } from './TLSSettingsSection.js';\nimport { useCommonStyles } from '../styles.js';\n\nconst SelfSignedCertificate = ({\n  enabled,\n  certificateConfigured,\n  onToggle,\n  onCertificateChange,\n  onCertificateReset,\n  tooltips,\n  readOnly\n}) => {\n  var _a;\n  const commonStyles = useCommonStyles();\n  return /* @__PURE__ */ React__default.createElement(\n    TLSSettingsSection,\n    {\n      enabled,\n      label: \"Add self-signed certificate\",\n      tooltipText: \"Add your own Certificate Authority (CA) certificate on top of one generated by the certificate authorities for additional security measures\",\n      onToggle: (newEnabled) => onToggle(newEnabled),\n      readOnly\n    },\n    /* @__PURE__ */ React__default.createElement(\n      InlineField,\n      {\n        label: \"CA Certificate\",\n        labelWidth: 24,\n        tooltip: (_a = tooltips == null ? void 0 : tooltips.certificateLabel) != null ? _a : \"Your self-signed certificate\",\n        required: true,\n        htmlFor: \"self-signed-certificate-input\",\n        interactive: true,\n        grow: true,\n        className: cx(commonStyles.inlineFieldNoMarginRight, commonStyles.inlineFieldWithSecret),\n        disabled: readOnly\n      },\n      /* @__PURE__ */ React__default.createElement(\n        SecretTextArea,\n        {\n          id: \"self-signed-certificate-input\",\n          isConfigured: certificateConfigured,\n          onChange: (e) => onCertificateChange(e.currentTarget.value),\n          onReset: readOnly ? () => {\n          } : onCertificateReset,\n          placeholder: \"Begins with --- BEGIN CERTIFICATE ---\",\n          rows: 6,\n          required: true\n        }\n      )\n    )\n  );\n};\n\nexport { SelfSignedCertificate };\n//# sourceMappingURL=SelfSignedCertificate.js.map\n","import React__default from 'react';\nimport { cx } from '@emotion/css';\nimport { InlineField, Input } from '@grafana/ui';\nimport { SecretTextArea } from '../common/SecretTextarea.js';\nimport { TLSSettingsSection } from './TLSSettingsSection.js';\nimport { useCommonStyles } from '../styles.js';\n\nconst TLSClientAuth = ({\n  enabled,\n  serverName,\n  clientCertificateConfigured,\n  clientKeyConfigured,\n  onToggle,\n  onServerNameChange,\n  onClientCertificateChange,\n  onClientKeyChange,\n  onClientCertificateReset,\n  onClientKeyReset,\n  tooltips,\n  readOnly\n}) => {\n  var _a, _b, _c;\n  const commonStyles = useCommonStyles();\n  return /* @__PURE__ */ React__default.createElement(\n    TLSSettingsSection,\n    {\n      enabled,\n      label: \"TLS Client Authentication\",\n      tooltipText: \"Validate using TLS client authentication, in which the server authenticates the client\",\n      onToggle: (newEnabled) => onToggle(newEnabled),\n      readOnly\n    },\n    /* @__PURE__ */ React__default.createElement(\n      InlineField,\n      {\n        label: \"ServerName\",\n        labelWidth: 24,\n        tooltip: (_a = tooltips == null ? void 0 : tooltips.serverNameLabel) != null ? _a : \"A Servername is used to verify the hostname on the returned certificate\",\n        required: true,\n        htmlFor: \"client-auth-servername-input\",\n        interactive: true,\n        grow: true,\n        className: commonStyles.inlineFieldNoMarginRight,\n        disabled: readOnly\n      },\n      /* @__PURE__ */ React__default.createElement(\n        Input,\n        {\n          id: \"client-auth-servername-input\",\n          placeholder: \"domain.example.com\",\n          value: serverName,\n          onChange: (e) => onServerNameChange(e.currentTarget.value),\n          required: true\n        }\n      )\n    ),\n    /* @__PURE__ */ React__default.createElement(\n      InlineField,\n      {\n        label: \"Client Certificate\",\n        labelWidth: 24,\n        tooltip: (_b = tooltips == null ? void 0 : tooltips.certificateLabel) != null ? _b : \"The client certificate can be generated from a Certificate Authority or be self-signed\",\n        required: true,\n        htmlFor: \"client-auth-client-certificate-input\",\n        interactive: true,\n        grow: true,\n        className: cx(commonStyles.inlineFieldNoMarginRight, commonStyles.inlineFieldWithSecret),\n        disabled: readOnly\n      },\n      /* @__PURE__ */ React__default.createElement(\n        SecretTextArea,\n        {\n          id: \"client-auth-client-certificate-input\",\n          isConfigured: clientCertificateConfigured,\n          onChange: (e) => onClientCertificateChange(e.currentTarget.value),\n          onReset: readOnly ? () => {\n          } : onClientCertificateReset,\n          placeholder: \"Begins with --- BEGIN CERTIFICATE ---\",\n          rows: 6,\n          required: true\n        }\n      )\n    ),\n    /* @__PURE__ */ React__default.createElement(\n      InlineField,\n      {\n        label: \"Client Key\",\n        labelWidth: 24,\n        tooltip: (_c = tooltips == null ? void 0 : tooltips.keyLabel) != null ? _c : \"The client key can be generated from a Certificate Authority or be self-signed\",\n        required: true,\n        htmlFor: \"client-auth-client-key-input\",\n        interactive: true,\n        grow: true,\n        className: cx(commonStyles.inlineFieldNoMarginRight, commonStyles.inlineFieldWithSecret),\n        disabled: readOnly\n      },\n      /* @__PURE__ */ React__default.createElement(\n        SecretTextArea,\n        {\n          id: \"client-auth-client-key-input\",\n          isConfigured: clientKeyConfigured,\n          onChange: (e) => onClientKeyChange(e.currentTarget.value),\n          onReset: readOnly ? () => {\n          } : onClientKeyReset,\n          placeholder: `Begins with --- RSA PRIVATE KEY CERTIFICATE ---`,\n          rows: 6,\n          required: true\n        }\n      )\n    )\n  );\n};\n\nexport { TLSClientAuth };\n//# sourceMappingURL=TLSClientAuth.js.map\n","import React__default from 'react';\nimport { TLSSettingsSection } from './TLSSettingsSection.js';\n\nconst SkipTLSVerification = ({ enabled, onToggle, readOnly }) => {\n  return /* @__PURE__ */ React__default.createElement(\n    TLSSettingsSection,\n    {\n      enabled,\n      label: \"Skip TLS certificate validation\",\n      tooltipText: \"Skipping TLS certificate validation is not recommended unless absolutely necessary or for testing\",\n      onToggle: (newEnabled) => onToggle(newEnabled),\n      readOnly\n    }\n  );\n};\n\nexport { SkipTLSVerification };\n//# sourceMappingURL=SkipTLSVerification.js.map\n","import React__default from 'react';\nimport { css } from '@emotion/css';\nimport { useTheme2 } from '@grafana/ui';\nimport { SelfSignedCertificate } from './SelfSignedCertificate.js';\nimport { TLSClientAuth } from './TLSClientAuth.js';\nimport { SkipTLSVerification } from './SkipTLSVerification.js';\nimport { ConfigSubSection } from '../../ConfigSection/ConfigSubSection.js';\n\nvar __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nconst TLSSettings = ({\n  selfSignedCertificate,\n  TLSClientAuth: TLSClientAuth$1,\n  skipTLSVerification,\n  readOnly\n}) => {\n  const { spacing } = useTheme2();\n  const styles = {\n    container: css({\n      marginTop: spacing(3)\n    })\n  };\n  return /* @__PURE__ */ React__default.createElement(\n    ConfigSubSection,\n    {\n      className: styles.container,\n      title: \"TLS settings\",\n      description: \"Additional security measures that can be applied on top of authentication\"\n    },\n    /* @__PURE__ */ React__default.createElement(SelfSignedCertificate, __spreadProps(__spreadValues({}, selfSignedCertificate), { readOnly })),\n    /* @__PURE__ */ React__default.createElement(TLSClientAuth, __spreadProps(__spreadValues({}, TLSClientAuth$1), { readOnly })),\n    /* @__PURE__ */ React__default.createElement(SkipTLSVerification, __spreadProps(__spreadValues({}, skipTLSVerification), { readOnly }))\n  );\n};\n\nexport { TLSSettings };\n//# sourceMappingURL=TLSSettings.js.map\n","import React__default from 'react';\nimport { css, cx } from '@emotion/css';\nimport { useTheme2, InlineFieldRow, InlineField, Input, IconButton } from '@grafana/ui';\nimport { SecretInput } from '../common/SecretInput.js';\nimport { useCommonStyles } from '../styles.js';\n\nvar __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nconst CustomHeader = ({ header, onChange, onBlur, onDelete, readOnly }) => {\n  const { spacing } = useTheme2();\n  const commonStyles = useCommonStyles();\n  const styles = {\n    container: css({\n      alignItems: \"center\"\n    }),\n    input: css({\n      minWidth: \"100%\"\n    }),\n    headerNameField: css({\n      width: \"40%\",\n      marginRight: 0,\n      paddingRight: spacing(1)\n    }),\n    headerValueField: css({\n      width: \"45%\",\n      marginRight: 0\n    }),\n    removeHeaderBtn: css({\n      margin: `0 0 3px 10px`\n    })\n  };\n  return /* @__PURE__ */ React__default.createElement(React__default.Fragment, null, /* @__PURE__ */ React__default.createElement(InlineFieldRow, { className: styles.container }, /* @__PURE__ */ React__default.createElement(\n    InlineField,\n    {\n      label: \"Header\",\n      labelWidth: 9,\n      grow: true,\n      className: styles.headerNameField,\n      htmlFor: `custom-header-${header.id}-name-input`,\n      disabled: readOnly\n    },\n    /* @__PURE__ */ React__default.createElement(\n      Input,\n      {\n        id: `custom-header-${header.id}-name-input`,\n        placeholder: \"X-Custom-Header\",\n        value: header.name,\n        width: 12,\n        onChange: (e) => onChange(__spreadProps(__spreadValues({}, header), { name: e.currentTarget.value })),\n        onBlur,\n        className: styles.input\n      }\n    )\n  ), /* @__PURE__ */ React__default.createElement(\n    InlineField,\n    {\n      label: \"Value\",\n      labelWidth: 9,\n      grow: true,\n      className: cx(commonStyles.inlineFieldWithSecret, styles.headerValueField),\n      htmlFor: `custom-header-${header.id}-value-input`,\n      disabled: readOnly\n    },\n    /* @__PURE__ */ React__default.createElement(\n      SecretInput,\n      {\n        id: `custom-header-${header.id}-value-input`,\n        isConfigured: header.configured,\n        placeholder: \"Header value\",\n        value: header.value,\n        width: 12,\n        onChange: (e) => onChange(__spreadProps(__spreadValues({}, header), { value: e.currentTarget.value })),\n        onReset: readOnly ? () => {\n        } : () => onChange(__spreadProps(__spreadValues({}, header), { configured: false, value: \"\" })),\n        onBlur,\n        className: styles.input\n      }\n    )\n  ), /* @__PURE__ */ React__default.createElement(\n    IconButton,\n    {\n      name: \"trash-alt\",\n      tooltip: \"Remove header\",\n      tooltipPlacement: \"top\",\n      className: styles.removeHeaderBtn,\n      onClick: onDelete,\n      type: \"button\",\n      disabled: readOnly\n    }\n  )));\n};\n\nexport { CustomHeader };\n//# sourceMappingURL=CustomHeader.js.map\n","import React__default, { useState, useEffect } from 'react';\nimport { css } from '@emotion/css';\nimport { useTheme2, Button } from '@grafana/ui';\nimport { CustomHeader } from './CustomHeader.js';\nimport { ConfigSubSection } from '../../ConfigSection/ConfigSubSection.js';\n\nvar __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nconst CustomHeaders = ({ headers: headersFromProps, onChange, readOnly }) => {\n  const { spacing } = useTheme2();\n  const [headers, setHeaders] = useState(\n    headersFromProps.map((header) => __spreadProps(__spreadValues({}, header), {\n      id: uniqueId(),\n      value: \"\"\n    }))\n  );\n  useEffect(() => {\n    setHeaders((headers2) => {\n      let changed = false;\n      const newHeaders = headers2.map((header) => {\n        var _a;\n        const configured = (_a = headersFromProps.find((h) => h.name === header.name)) == null ? void 0 : _a.configured;\n        if (typeof configured !== \"undefined\" && header.configured !== configured) {\n          changed = true;\n          return __spreadProps(__spreadValues({}, header), { configured });\n        }\n        return header;\n      });\n      if (changed) {\n        return newHeaders;\n      }\n      return headers2;\n    });\n  }, [headersFromProps]);\n  const onHeaderAdd = () => {\n    setHeaders([...headers, { id: uniqueId(), name: \"\", value: \"\", configured: false }]);\n  };\n  const onHeaderChange = (id, header) => {\n    setHeaders(headers.map((h) => h.id === id ? __spreadValues({}, header) : h));\n  };\n  const onHeaderDelete = (id) => {\n    const index = headers.findIndex((h) => h.id === id);\n    if (index === -1) {\n      return;\n    }\n    const newHeaders = [...headers];\n    newHeaders.splice(index, 1);\n    setHeaders(newHeaders);\n    onChange(\n      newHeaders.map(({ name, value, configured }) => ({\n        name,\n        value,\n        configured\n      }))\n    );\n  };\n  const onBlur = () => {\n    onChange(\n      headers.map(({ name, value, configured }) => ({\n        name,\n        value,\n        configured\n      }))\n    );\n  };\n  const styles = {\n    container: css({\n      marginTop: spacing(3)\n    }),\n    addHeaderButton: css({\n      marginTop: spacing(1.5)\n    })\n  };\n  return /* @__PURE__ */ React__default.createElement(\"div\", { className: styles.container }, /* @__PURE__ */ React__default.createElement(\n    ConfigSubSection,\n    {\n      title: \"HTTP headers\",\n      description: \"Pass along additional context and metadata about the request/response\",\n      isCollapsible: true,\n      isInitiallyOpen: headers.length > 0\n    },\n    /* @__PURE__ */ React__default.createElement(\"div\", null, headers.map((header) => /* @__PURE__ */ React__default.createElement(\n      CustomHeader,\n      {\n        key: header.id,\n        header,\n        onChange: (header2) => onHeaderChange(header2.id, header2),\n        onDelete: () => onHeaderDelete(header.id),\n        onBlur,\n        readOnly\n      }\n    ))),\n    /* @__PURE__ */ React__default.createElement(\"div\", { className: styles.addHeaderButton }, /* @__PURE__ */ React__default.createElement(Button, { icon: \"plus\", variant: \"secondary\", fill: \"outline\", onClick: onHeaderAdd, disabled: readOnly }, headers.length === 0 ? \"Add header\" : \"Add another header\"))\n  ));\n};\nfunction uniqueId() {\n  return Math.random().toString(16).slice(2);\n}\n\nexport { CustomHeaders };\n//# sourceMappingURL=CustomHeaders.js.map\n","import React__default from 'react';\nimport { css } from '@emotion/css';\nimport { AuthMethodSettings } from './auth-method/AuthMethodSettings.js';\nimport { TLSSettings } from './tls/TLSSettings.js';\nimport { CustomHeaders } from './custom-headers/CustomHeaders.js';\nimport { ConfigSection } from '../ConfigSection/ConfigSection.js';\nimport '@grafana/ui';\n\nvar __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nconst Auth = ({\n  selectedMethod,\n  mostCommonMethod,\n  visibleMethods,\n  extendedDefaultOptions,\n  customMethods,\n  onAuthMethodSelect,\n  basicAuth,\n  TLS,\n  customHeaders,\n  readOnly = false\n}) => {\n  const styles = {\n    container: css({\n      maxWidth: 578\n    })\n  };\n  return /* @__PURE__ */ React__default.createElement(\"div\", { className: styles.container }, /* @__PURE__ */ React__default.createElement(ConfigSection, { title: \"Authentication\" }, /* @__PURE__ */ React__default.createElement(\n    AuthMethodSettings,\n    {\n      selectedMethod,\n      mostCommonMethod,\n      customMethods,\n      visibleMethods,\n      extendedDefaultOptions,\n      onAuthMethodSelect,\n      basicAuth,\n      readOnly\n    }\n  ), TLS && /* @__PURE__ */ React__default.createElement(TLSSettings, __spreadProps(__spreadValues({}, TLS), { readOnly })), customHeaders && /* @__PURE__ */ React__default.createElement(CustomHeaders, __spreadProps(__spreadValues({}, customHeaders), { readOnly }))));\n};\n\nexport { Auth };\n//# sourceMappingURL=Auth.js.map\n","import { AuthMethod } from './types.js';\n\nvar __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nconst headerNamePrefix = \"httpHeaderName\";\nconst headerValuePrefix = \"httpHeaderValue\";\nfunction convertLegacyAuthProps({\n  config,\n  onChange\n}) {\n  const props = {\n    selectedMethod: getSelectedMethod(config),\n    onAuthMethodSelect: getOnAuthMethodSelectHandler(config, onChange),\n    basicAuth: getBasicAuthProps(config, onChange),\n    TLS: getTLSProps(config, onChange),\n    customHeaders: getCustomHeaders(config, onChange),\n    readOnly: config.readOnly\n  };\n  return props;\n}\nfunction getSelectedMethod(config) {\n  if (config.basicAuth) {\n    return AuthMethod.BasicAuth;\n  }\n  if (config.withCredentials) {\n    return AuthMethod.CrossSiteCredentials;\n  }\n  if (config.jsonData.oauthPassThru) {\n    return AuthMethod.OAuthForward;\n  }\n  return AuthMethod.NoAuth;\n}\nfunction getOnAuthMethodSelectHandler(config, onChange) {\n  return (method) => {\n    onChange(__spreadProps(__spreadValues({}, config), {\n      basicAuth: method === AuthMethod.BasicAuth,\n      withCredentials: method === AuthMethod.CrossSiteCredentials,\n      jsonData: __spreadProps(__spreadValues({}, config.jsonData), {\n        oauthPassThru: method === AuthMethod.OAuthForward\n      })\n    }));\n  };\n}\nfunction getBasicAuthProps(config, onChange) {\n  return {\n    user: config.basicAuthUser,\n    passwordConfigured: config.secureJsonFields.basicAuthPassword,\n    onUserChange: (user) => onChange(__spreadProps(__spreadValues({}, config), { basicAuthUser: user })),\n    onPasswordChange: (password) => onChange(__spreadProps(__spreadValues({}, config), {\n      secureJsonData: __spreadProps(__spreadValues({}, config.secureJsonData), {\n        basicAuthPassword: password\n      })\n    })),\n    onPasswordReset: () => onChange(__spreadProps(__spreadValues({}, config), {\n      secureJsonData: __spreadProps(__spreadValues({}, config.secureJsonData), { basicAuthPassword: \"\" }),\n      secureJsonFields: __spreadProps(__spreadValues({}, config.secureJsonFields), {\n        basicAuthPassword: false\n      })\n    }))\n  };\n}\nfunction getTLSProps(config, onChange) {\n  return {\n    selfSignedCertificate: {\n      enabled: Boolean(config.jsonData.tlsAuthWithCACert),\n      certificateConfigured: config.secureJsonFields.tlsCACert,\n      onToggle: (enabled) => onChange(__spreadProps(__spreadValues({}, config), {\n        jsonData: __spreadProps(__spreadValues({}, config.jsonData), { tlsAuthWithCACert: enabled })\n      })),\n      onCertificateChange: (certificate) => onChange(__spreadProps(__spreadValues({}, config), {\n        secureJsonData: __spreadProps(__spreadValues({}, config.secureJsonData), { tlsCACert: certificate })\n      })),\n      onCertificateReset: () => onChange(__spreadProps(__spreadValues({}, config), {\n        secureJsonData: __spreadProps(__spreadValues({}, config.secureJsonData), { tlsCACert: \"\" }),\n        secureJsonFields: __spreadProps(__spreadValues({}, config.secureJsonFields), { tlsCACert: false })\n      }))\n    },\n    TLSClientAuth: {\n      enabled: config.jsonData.tlsAuth,\n      serverName: config.jsonData.serverName,\n      clientCertificateConfigured: config.secureJsonFields.tlsClientCert,\n      clientKeyConfigured: config.secureJsonFields.tlsClientKey,\n      onToggle: (enabled) => onChange(__spreadProps(__spreadValues({}, config), {\n        jsonData: __spreadProps(__spreadValues({}, config.jsonData), { tlsAuth: enabled })\n      })),\n      onServerNameChange: (serverName) => onChange(__spreadProps(__spreadValues({}, config), {\n        jsonData: __spreadProps(__spreadValues({}, config.jsonData), { serverName })\n      })),\n      onClientCertificateChange: (clientCertificate) => onChange(__spreadProps(__spreadValues({}, config), {\n        secureJsonData: __spreadProps(__spreadValues({}, config.secureJsonData), {\n          tlsClientCert: clientCertificate\n        })\n      })),\n      onClientCertificateReset: () => onChange(__spreadProps(__spreadValues({}, config), {\n        secureJsonData: __spreadProps(__spreadValues({}, config.secureJsonData), {\n          tlsClientCert: \"\"\n        }),\n        secureJsonFields: __spreadProps(__spreadValues({}, config.secureJsonFields), {\n          tlsClientCert: false\n        })\n      })),\n      onClientKeyChange: (clientKey) => onChange(__spreadProps(__spreadValues({}, config), {\n        secureJsonData: __spreadProps(__spreadValues({}, config.secureJsonData), {\n          tlsClientKey: clientKey\n        })\n      })),\n      onClientKeyReset: () => onChange(__spreadProps(__spreadValues({}, config), {\n        secureJsonData: __spreadProps(__spreadValues({}, config.secureJsonData), {\n          tlsClientKey: \"\"\n        }),\n        secureJsonFields: __spreadProps(__spreadValues({}, config.secureJsonFields), {\n          tlsClientKey: false\n        })\n      }))\n    },\n    skipTLSVerification: {\n      enabled: config.jsonData.tlsSkipVerify,\n      onToggle: (enabled) => onChange(__spreadProps(__spreadValues({}, config), {\n        jsonData: __spreadProps(__spreadValues({}, config.jsonData), { tlsSkipVerify: enabled })\n      }))\n    }\n  };\n}\nfunction getCustomHeaders(config, onChange) {\n  const headers = Object.keys(config.jsonData).filter((key) => key.startsWith(headerNamePrefix)).sort().map((key) => {\n    var _a;\n    const index = key.slice(headerNamePrefix.length);\n    return {\n      name: config.jsonData[key],\n      configured: (_a = config.secureJsonFields[`${headerValuePrefix}${index}`]) != null ? _a : false\n    };\n  });\n  return {\n    headers,\n    onChange: (headers2) => {\n      const newJsonData = Object.fromEntries(\n        Object.entries(config.jsonData).filter(([key]) => !key.startsWith(headerNamePrefix))\n      );\n      const newSecureJsonData = Object.fromEntries(\n        Object.entries(config.secureJsonData || {}).filter(([key]) => !key.startsWith(headerValuePrefix))\n      );\n      const newSecureJsonFields = Object.fromEntries(\n        Object.entries(config.secureJsonFields).filter(([key]) => !key.startsWith(headerValuePrefix))\n      );\n      headers2.forEach((header, index) => {\n        newJsonData[`${headerNamePrefix}${index + 1}`] = header.name;\n        if (header.configured) {\n          newSecureJsonFields[`${headerValuePrefix}${index + 1}`] = true;\n        } else {\n          newSecureJsonData[`${headerValuePrefix}${index + 1}`] = header.value;\n        }\n      });\n      onChange(__spreadProps(__spreadValues({}, config), {\n        jsonData: newJsonData,\n        secureJsonData: newSecureJsonData,\n        secureJsonFields: newSecureJsonFields\n      }));\n    }\n  };\n}\n\nexport { convertLegacyAuthProps, getBasicAuthProps, getCustomHeaders, getOnAuthMethodSelectHandler, getSelectedMethod, getTLSProps };\n//# sourceMappingURL=utils.js.map\n","import React__default from 'react';\nimport { css, cx } from '@emotion/css';\nimport { InlineField, TagsInput, Input } from '@grafana/ui';\nimport { ConfigSubSection } from '../ConfigSection/ConfigSubSection.js';\n\nvar __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nconst AdvancedHttpSettings = ({\n  config,\n  onChange,\n  className\n}) => {\n  const onCookiesChange = (cookies) => {\n    onChange(__spreadProps(__spreadValues({}, config), {\n      jsonData: __spreadProps(__spreadValues({}, config.jsonData), {\n        keepCookies: cookies\n      })\n    }));\n  };\n  const onTimeoutChange = (event) => {\n    onChange(__spreadProps(__spreadValues({}, config), {\n      jsonData: __spreadProps(__spreadValues({}, config.jsonData), {\n        timeout: parseInt(event.currentTarget.value, 10)\n      })\n    }));\n  };\n  const styles = {\n    container: css({\n      maxWidth: 578\n    })\n  };\n  return /* @__PURE__ */ React__default.createElement(ConfigSubSection, { title: \"Advanced HTTP settings\", className: cx(styles.container, className) }, /* @__PURE__ */ React__default.createElement(\n    InlineField,\n    {\n      htmlFor: \"advanced-http-cookies\",\n      label: \"Allowed cookies\",\n      labelWidth: 24,\n      tooltip: \"Grafana proxy deletes forwarded cookies by default. Specify cookies by name that should be forwarded to the data source.\",\n      disabled: config.readOnly,\n      grow: true\n    },\n    /* @__PURE__ */ React__default.createElement(\n      TagsInput,\n      {\n        id: \"advanced-http-cookies\",\n        placeholder: \"New cookie (hit enter to add)\",\n        tags: config.jsonData.keepCookies,\n        onChange: onCookiesChange\n      }\n    )\n  ), /* @__PURE__ */ React__default.createElement(\n    InlineField,\n    {\n      htmlFor: \"advanced-http-timeout\",\n      label: \"Timeout\",\n      labelWidth: 24,\n      tooltip: \"HTTP request timeout in seconds\",\n      disabled: config.readOnly,\n      grow: true\n    },\n    /* @__PURE__ */ React__default.createElement(\n      Input,\n      {\n        id: \"advanced-http-timeout\",\n        type: \"number\",\n        min: 0,\n        placeholder: \"Timeout in seconds\",\n        \"aria-label\": \"Timeout in seconds\",\n        value: config.jsonData.timeout,\n        onChange: onTimeoutChange\n      }\n    )\n  ));\n};\n\nexport { AdvancedHttpSettings };\n//# sourceMappingURL=AdvancedHttpSettings.js.map\n","import { css } from '@emotion/css';\nimport React from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { useStyles2 } from '@grafana/ui';\n\n// this custom component is necessary because the Grafana UI <Divider /> component is not backwards compatible with Grafana < 10.1.0\nexport const Divider = () => {\n  const styles = useStyles2(getStyles);\n  return <hr className={styles.horizontalDivider} />;\n};\n\nconst getStyles = (theme: GrafanaTheme2) => {\n  return {\n    horizontalDivider: css({\n      borderTop: `1px solid ${theme.colors.border.weak}`,\n      margin: theme.spacing(2, 0),\n      width: '100%',\n    }),\n  };\n};\n","import { DataSourcePluginOptionsEditorProps, GrafanaTheme2 } from '@grafana/data';\nimport { Field, Input, useStyles2 } from '@grafana/ui';\nimport React, { ChangeEvent } from 'react';\nimport { JsonApiDataSourceOptions } from '../types';\nimport {\n  AdvancedHttpSettings,\n  Auth,\n  ConfigSection,\n  ConnectionSettings,\n  DataSourceDescription,\n  convertLegacyAuthProps,\n} from '@grafana/experimental';\nimport { css } from '@emotion/css';\nimport { Divider } from './Divider';\n\ntype Props = DataSourcePluginOptionsEditorProps<JsonApiDataSourceOptions>;\n\n/**\n * ConfigEditor lets the user configure connection details like the URL or\n * authentication.\n */\nexport const ConfigEditor: React.FC<Props> = ({ options, onOptionsChange }) => {\n  const styles = useStyles2(getStyles);\n\n  const onParamsChange = (e: ChangeEvent<HTMLInputElement>) => {\n    onOptionsChange({\n      ...options,\n      jsonData: {\n        ...options.jsonData,\n        queryParams: e.currentTarget.value,\n      },\n    });\n  };\n\n  return (\n    <>\n      <DataSourceDescription\n        dataSourceName=\"JSON API\"\n        docsLink=\"https://grafana.com/docs/plugins/marcusolsson-json-datasource/latest/\"\n        hasRequiredFields={false}\n      />\n\n      <Divider />\n\n      <ConnectionSettings config={options} onChange={onOptionsChange} urlPlaceholder=\"http://localhost:8080\" />\n\n      <Divider />\n\n      <Auth\n        {...convertLegacyAuthProps({\n          config: options,\n          onChange: onOptionsChange,\n        })}\n      />\n\n      <Divider />\n\n      <ConfigSection title=\"Additional settings\" isCollapsible>\n        <AdvancedHttpSettings config={options} onChange={onOptionsChange} />\n\n        <div className={styles.space} />\n\n        <Field label=\"Query string\" description=\"Add a custom query string to your queries.\">\n          <Input\n            width={40}\n            value={options.jsonData.queryParams}\n            onChange={onParamsChange}\n            spellCheck={false}\n            placeholder=\"limit=100\"\n          />\n        </Field>\n      </ConfigSection>\n    </>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => {\n  return {\n    space: css({\n      width: '100%',\n      height: theme.spacing(2),\n    }),\n  };\n};\n","function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function (obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function (obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _construct(Parent, args, Class) {\n  if (_isNativeReflectConstruct()) {\n    _construct = Reflect.construct;\n  } else {\n    _construct = function _construct(Parent, args, Class) {\n      var a = [null];\n      a.push.apply(a, args);\n      var Constructor = Function.bind.apply(Parent, a);\n      var instance = new Constructor();\n      if (Class) _setPrototypeOf(instance, Class.prototype);\n      return instance;\n    };\n  }\n\n  return _construct.apply(null, arguments);\n}\n\nfunction _isNativeFunction(fn) {\n  return Function.toString.call(fn).indexOf(\"[native code]\") !== -1;\n}\n\nfunction _wrapNativeSuper(Class) {\n  var _cache = typeof Map === \"function\" ? new Map() : undefined;\n\n  _wrapNativeSuper = function _wrapNativeSuper(Class) {\n    if (Class === null || !_isNativeFunction(Class)) return Class;\n\n    if (typeof Class !== \"function\") {\n      throw new TypeError(\"Super expression must either be null or a function\");\n    }\n\n    if (typeof _cache !== \"undefined\") {\n      if (_cache.has(Class)) return _cache.get(Class);\n\n      _cache.set(Class, Wrapper);\n    }\n\n    function Wrapper() {\n      return _construct(Class, arguments, _getPrototypeOf(this).constructor);\n    }\n\n    Wrapper.prototype = Object.create(Class.prototype, {\n      constructor: {\n        value: Wrapper,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n    return _setPrototypeOf(Wrapper, Class);\n  };\n\n  return _wrapNativeSuper(Class);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (typeof call === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\n\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n  return arr2;\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) {\n  var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"];\n\n  if (!it) {\n    if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n      if (it) o = it;\n      var i = 0;\n\n      var F = function () {};\n\n      return {\n        s: F,\n        n: function () {\n          if (i >= o.length) return {\n            done: true\n          };\n          return {\n            done: false,\n            value: o[i++]\n          };\n        },\n        e: function (e) {\n          throw e;\n        },\n        f: F\n      };\n    }\n\n    throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n\n  var normalCompletion = true,\n      didErr = false,\n      err;\n  return {\n    s: function () {\n      it = it.call(o);\n    },\n    n: function () {\n      var step = it.next();\n      normalCompletion = step.done;\n      return step;\n    },\n    e: function (e) {\n      didErr = true;\n      err = e;\n    },\n    f: function () {\n      try {\n        if (!normalCompletion && it.return != null) it.return();\n      } finally {\n        if (didErr) throw err;\n      }\n    }\n  };\n}\n\nvar hasOwnProp = Object.prototype.hasOwnProperty;\n/**\n* @typedef {null|boolean|number|string|PlainObject|GenericArray} JSONObject\n*/\n\n/**\n * Copies array and then pushes item into it.\n * @param {GenericArray} arr Array to copy and into which to push\n * @param {any} item Array item to add (to end)\n * @returns {GenericArray} Copy of the original array\n */\n\nfunction push(arr, item) {\n  arr = arr.slice();\n  arr.push(item);\n  return arr;\n}\n/**\n * Copies array and then unshifts item into it.\n * @param {any} item Array item to add (to beginning)\n * @param {GenericArray} arr Array to copy and into which to unshift\n * @returns {GenericArray} Copy of the original array\n */\n\n\nfunction unshift(item, arr) {\n  arr = arr.slice();\n  arr.unshift(item);\n  return arr;\n}\n/**\n * Caught when JSONPath is used without `new` but rethrown if with `new`\n * @extends Error\n */\n\n\nvar NewError = /*#__PURE__*/function (_Error) {\n  _inherits(NewError, _Error);\n\n  var _super = _createSuper(NewError);\n\n  /**\n   * @param {any} value The evaluated scalar value\n   */\n  function NewError(value) {\n    var _this;\n\n    _classCallCheck(this, NewError);\n\n    _this = _super.call(this, 'JSONPath should not be called with \"new\" (it prevents return ' + 'of (unwrapped) scalar values)');\n    _this.avoidNew = true;\n    _this.value = value;\n    _this.name = 'NewError';\n    return _this;\n  }\n\n  return NewError;\n}( /*#__PURE__*/_wrapNativeSuper(Error));\n/**\n* @typedef {PlainObject} ReturnObject\n* @property {string} path\n* @property {JSONObject} value\n* @property {PlainObject|GenericArray} parent\n* @property {string} parentProperty\n*/\n\n/**\n* @callback JSONPathCallback\n* @param {string|PlainObject} preferredOutput\n* @param {\"value\"|\"property\"} type\n* @param {ReturnObject} fullRetObj\n* @returns {void}\n*/\n\n/**\n* @callback OtherTypeCallback\n* @param {JSONObject} val\n* @param {string} path\n* @param {PlainObject|GenericArray} parent\n* @param {string} parentPropName\n* @returns {boolean}\n*/\n\n/* eslint-disable max-len -- Can make multiline type after https://github.com/syavorsky/comment-parser/issues/109 */\n\n/**\n * @typedef {PlainObject} JSONPathOptions\n * @property {JSON} json\n * @property {string|string[]} path\n * @property {\"value\"|\"path\"|\"pointer\"|\"parent\"|\"parentProperty\"|\"all\"} [resultType=\"value\"]\n * @property {boolean} [flatten=false]\n * @property {boolean} [wrap=true]\n * @property {PlainObject} [sandbox={}]\n * @property {boolean} [preventEval=false]\n * @property {PlainObject|GenericArray|null} [parent=null]\n * @property {string|null} [parentProperty=null]\n * @property {JSONPathCallback} [callback]\n * @property {OtherTypeCallback} [otherTypeCallback] Defaults to\n *   function which throws on encountering `@other`\n * @property {boolean} [autostart=true]\n */\n\n/* eslint-enable max-len -- Can make multiline type after https://github.com/syavorsky/comment-parser/issues/109 */\n\n/**\n * @param {string|JSONPathOptions} opts If a string, will be treated as `expr`\n * @param {string} [expr] JSON path to evaluate\n * @param {JSON} [obj] JSON object to evaluate against\n * @param {JSONPathCallback} [callback] Passed 3 arguments: 1) desired payload\n *     per `resultType`, 2) `\"value\"|\"property\"`, 3) Full returned object with\n *     all payloads\n * @param {OtherTypeCallback} [otherTypeCallback] If `@other()` is at the end\n *   of one's query, this will be invoked with the value of the item, its\n *   path, its parent, and its parent's property name, and it should return\n *   a boolean indicating whether the supplied value belongs to the \"other\"\n *   type or not (or it may handle transformations and return `false`).\n * @returns {JSONPath}\n * @class\n */\n\n\nfunction JSONPath(opts, expr, obj, callback, otherTypeCallback) {\n  // eslint-disable-next-line no-restricted-syntax\n  if (!(this instanceof JSONPath)) {\n    try {\n      return new JSONPath(opts, expr, obj, callback, otherTypeCallback);\n    } catch (e) {\n      if (!e.avoidNew) {\n        throw e;\n      }\n\n      return e.value;\n    }\n  }\n\n  if (typeof opts === 'string') {\n    otherTypeCallback = callback;\n    callback = obj;\n    obj = expr;\n    expr = opts;\n    opts = null;\n  }\n\n  var optObj = opts && _typeof(opts) === 'object';\n  opts = opts || {};\n  this.json = opts.json || obj;\n  this.path = opts.path || expr;\n  this.resultType = opts.resultType || 'value';\n  this.flatten = opts.flatten || false;\n  this.wrap = hasOwnProp.call(opts, 'wrap') ? opts.wrap : true;\n  this.sandbox = opts.sandbox || {};\n  this.preventEval = opts.preventEval || false;\n  this.parent = opts.parent || null;\n  this.parentProperty = opts.parentProperty || null;\n  this.callback = opts.callback || callback || null;\n\n  this.otherTypeCallback = opts.otherTypeCallback || otherTypeCallback || function () {\n    throw new TypeError('You must supply an otherTypeCallback callback option ' + 'with the @other() operator.');\n  };\n\n  if (opts.autostart !== false) {\n    var args = {\n      path: optObj ? opts.path : expr\n    };\n\n    if (!optObj) {\n      args.json = obj;\n    } else if ('json' in opts) {\n      args.json = opts.json;\n    }\n\n    var ret = this.evaluate(args);\n\n    if (!ret || _typeof(ret) !== 'object') {\n      throw new NewError(ret);\n    }\n\n    return ret;\n  }\n} // PUBLIC METHODS\n\n\nJSONPath.prototype.evaluate = function (expr, json, callback, otherTypeCallback) {\n  var _this2 = this;\n\n  var currParent = this.parent,\n      currParentProperty = this.parentProperty;\n  var flatten = this.flatten,\n      wrap = this.wrap;\n  this.currResultType = this.resultType;\n  this.currPreventEval = this.preventEval;\n  this.currSandbox = this.sandbox;\n  callback = callback || this.callback;\n  this.currOtherTypeCallback = otherTypeCallback || this.otherTypeCallback;\n  json = json || this.json;\n  expr = expr || this.path;\n\n  if (expr && _typeof(expr) === 'object' && !Array.isArray(expr)) {\n    if (!expr.path && expr.path !== '') {\n      throw new TypeError('You must supply a \"path\" property when providing an object ' + 'argument to JSONPath.evaluate().');\n    }\n\n    if (!hasOwnProp.call(expr, 'json')) {\n      throw new TypeError('You must supply a \"json\" property when providing an object ' + 'argument to JSONPath.evaluate().');\n    }\n\n    var _expr = expr;\n    json = _expr.json;\n    flatten = hasOwnProp.call(expr, 'flatten') ? expr.flatten : flatten;\n    this.currResultType = hasOwnProp.call(expr, 'resultType') ? expr.resultType : this.currResultType;\n    this.currSandbox = hasOwnProp.call(expr, 'sandbox') ? expr.sandbox : this.currSandbox;\n    wrap = hasOwnProp.call(expr, 'wrap') ? expr.wrap : wrap;\n    this.currPreventEval = hasOwnProp.call(expr, 'preventEval') ? expr.preventEval : this.currPreventEval;\n    callback = hasOwnProp.call(expr, 'callback') ? expr.callback : callback;\n    this.currOtherTypeCallback = hasOwnProp.call(expr, 'otherTypeCallback') ? expr.otherTypeCallback : this.currOtherTypeCallback;\n    currParent = hasOwnProp.call(expr, 'parent') ? expr.parent : currParent;\n    currParentProperty = hasOwnProp.call(expr, 'parentProperty') ? expr.parentProperty : currParentProperty;\n    expr = expr.path;\n  }\n\n  currParent = currParent || null;\n  currParentProperty = currParentProperty || null;\n\n  if (Array.isArray(expr)) {\n    expr = JSONPath.toPathString(expr);\n  }\n\n  if (!expr && expr !== '' || !json) {\n    return undefined;\n  }\n\n  var exprList = JSONPath.toPathArray(expr);\n\n  if (exprList[0] === '$' && exprList.length > 1) {\n    exprList.shift();\n  }\n\n  this._hasParentSelector = null;\n\n  var result = this._trace(exprList, json, ['$'], currParent, currParentProperty, callback).filter(function (ea) {\n    return ea && !ea.isParentSelector;\n  });\n\n  if (!result.length) {\n    return wrap ? [] : undefined;\n  }\n\n  if (!wrap && result.length === 1 && !result[0].hasArrExpr) {\n    return this._getPreferredOutput(result[0]);\n  }\n\n  return result.reduce(function (rslt, ea) {\n    var valOrPath = _this2._getPreferredOutput(ea);\n\n    if (flatten && Array.isArray(valOrPath)) {\n      rslt = rslt.concat(valOrPath);\n    } else {\n      rslt.push(valOrPath);\n    }\n\n    return rslt;\n  }, []);\n}; // PRIVATE METHODS\n\n\nJSONPath.prototype._getPreferredOutput = function (ea) {\n  var resultType = this.currResultType;\n\n  switch (resultType) {\n    case 'all':\n      {\n        var path = Array.isArray(ea.path) ? ea.path : JSONPath.toPathArray(ea.path);\n        ea.pointer = JSONPath.toPointer(path);\n        ea.path = typeof ea.path === 'string' ? ea.path : JSONPath.toPathString(ea.path);\n        return ea;\n      }\n\n    case 'value':\n    case 'parent':\n    case 'parentProperty':\n      return ea[resultType];\n\n    case 'path':\n      return JSONPath.toPathString(ea[resultType]);\n\n    case 'pointer':\n      return JSONPath.toPointer(ea.path);\n\n    default:\n      throw new TypeError('Unknown result type');\n  }\n};\n\nJSONPath.prototype._handleCallback = function (fullRetObj, callback, type) {\n  if (callback) {\n    var preferredOutput = this._getPreferredOutput(fullRetObj);\n\n    fullRetObj.path = typeof fullRetObj.path === 'string' ? fullRetObj.path : JSONPath.toPathString(fullRetObj.path); // eslint-disable-next-line node/callback-return\n\n    callback(preferredOutput, type, fullRetObj);\n  }\n};\n/**\n *\n * @param {string} expr\n * @param {JSONObject} val\n * @param {string} path\n * @param {PlainObject|GenericArray} parent\n * @param {string} parentPropName\n * @param {JSONPathCallback} callback\n * @param {boolean} hasArrExpr\n * @param {boolean} literalPriority\n * @returns {ReturnObject|ReturnObject[]}\n */\n\n\nJSONPath.prototype._trace = function (expr, val, path, parent, parentPropName, callback, hasArrExpr, literalPriority) {\n  var _this3 = this;\n\n  // No expr to follow? return path and value as the result of\n  //  this trace branch\n  var retObj;\n\n  if (!expr.length) {\n    retObj = {\n      path: path,\n      value: val,\n      parent: parent,\n      parentProperty: parentPropName,\n      hasArrExpr: hasArrExpr\n    };\n\n    this._handleCallback(retObj, callback, 'value');\n\n    return retObj;\n  }\n\n  var loc = expr[0],\n      x = expr.slice(1); // We need to gather the return value of recursive trace calls in order to\n  // do the parent sel computation.\n\n  var ret = [];\n  /**\n   *\n   * @param {ReturnObject|ReturnObject[]} elems\n   * @returns {void}\n   */\n\n  function addRet(elems) {\n    if (Array.isArray(elems)) {\n      // This was causing excessive stack size in Node (with or\n      //  without Babel) against our performance test:\n      //  `ret.push(...elems);`\n      elems.forEach(function (t) {\n        ret.push(t);\n      });\n    } else {\n      ret.push(elems);\n    }\n  }\n\n  if ((typeof loc !== 'string' || literalPriority) && val && hasOwnProp.call(val, loc)) {\n    // simple case--directly follow property\n    addRet(this._trace(x, val[loc], push(path, loc), val, loc, callback, hasArrExpr)); // eslint-disable-next-line unicorn/prefer-switch -- Part of larger `if`\n  } else if (loc === '*') {\n    // all child properties\n    this._walk(loc, x, val, path, parent, parentPropName, callback, function (m, l, _x, v, p, par, pr, cb) {\n      addRet(_this3._trace(unshift(m, _x), v, p, par, pr, cb, true, true));\n    });\n  } else if (loc === '..') {\n    // all descendent parent properties\n    // Check remaining expression with val's immediate children\n    addRet(this._trace(x, val, path, parent, parentPropName, callback, hasArrExpr));\n\n    this._walk(loc, x, val, path, parent, parentPropName, callback, function (m, l, _x, v, p, par, pr, cb) {\n      // We don't join m and x here because we only want parents,\n      //   not scalar values\n      if (_typeof(v[m]) === 'object') {\n        // Keep going with recursive descent on val's\n        //   object children\n        addRet(_this3._trace(unshift(l, _x), v[m], push(p, m), v, m, cb, true));\n      }\n    }); // The parent sel computation is handled in the frame above using the\n    // ancestor object of val\n\n  } else if (loc === '^') {\n    // This is not a final endpoint, so we do not invoke the callback here\n    this._hasParentSelector = true;\n    return {\n      path: path.slice(0, -1),\n      expr: x,\n      isParentSelector: true\n    };\n  } else if (loc === '~') {\n    // property name\n    retObj = {\n      path: push(path, loc),\n      value: parentPropName,\n      parent: parent,\n      parentProperty: null\n    };\n\n    this._handleCallback(retObj, callback, 'property');\n\n    return retObj;\n  } else if (loc === '$') {\n    // root only\n    addRet(this._trace(x, val, path, null, null, callback, hasArrExpr));\n  } else if (/^(\\x2D?[0-9]*):(\\x2D?[0-9]*):?([0-9]*)$/.test(loc)) {\n    // [start:end:step]  Python slice syntax\n    addRet(this._slice(loc, x, val, path, parent, parentPropName, callback));\n  } else if (loc.indexOf('?(') === 0) {\n    // [?(expr)] (filtering)\n    if (this.currPreventEval) {\n      throw new Error('Eval [?(expr)] prevented in JSONPath expression.');\n    }\n\n    this._walk(loc, x, val, path, parent, parentPropName, callback, function (m, l, _x, v, p, par, pr, cb) {\n      if (_this3._eval(l.replace(/^\\?\\(((?:[\\0-\\t\\x0B\\f\\x0E-\\u2027\\u202A-\\uD7FF\\uE000-\\uFFFF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF])*?)\\)$/, '$1'), v[m], m, p, par, pr)) {\n        addRet(_this3._trace(unshift(m, _x), v, p, par, pr, cb, true));\n      }\n    });\n  } else if (loc[0] === '(') {\n    // [(expr)] (dynamic property/index)\n    if (this.currPreventEval) {\n      throw new Error('Eval [(expr)] prevented in JSONPath expression.');\n    } // As this will resolve to a property name (but we don't know it\n    //  yet), property and parent information is relative to the\n    //  parent of the property to which this expression will resolve\n\n\n    addRet(this._trace(unshift(this._eval(loc, val, path[path.length - 1], path.slice(0, -1), parent, parentPropName), x), val, path, parent, parentPropName, callback, hasArrExpr));\n  } else if (loc[0] === '@') {\n    // value type: @boolean(), etc.\n    var addType = false;\n    var valueType = loc.slice(1, -2);\n\n    switch (valueType) {\n      case 'scalar':\n        if (!val || !['object', 'function'].includes(_typeof(val))) {\n          addType = true;\n        }\n\n        break;\n\n      case 'boolean':\n      case 'string':\n      case 'undefined':\n      case 'function':\n        // eslint-disable-next-line valid-typeof\n        if (_typeof(val) === valueType) {\n          addType = true;\n        }\n\n        break;\n\n      case 'integer':\n        if (Number.isFinite(val) && !(val % 1)) {\n          addType = true;\n        }\n\n        break;\n\n      case 'number':\n        if (Number.isFinite(val)) {\n          addType = true;\n        }\n\n        break;\n\n      case 'nonFinite':\n        if (typeof val === 'number' && !Number.isFinite(val)) {\n          addType = true;\n        }\n\n        break;\n\n      case 'object':\n        // eslint-disable-next-line valid-typeof\n        if (val && _typeof(val) === valueType) {\n          addType = true;\n        }\n\n        break;\n\n      case 'array':\n        if (Array.isArray(val)) {\n          addType = true;\n        }\n\n        break;\n\n      case 'other':\n        addType = this.currOtherTypeCallback(val, path, parent, parentPropName);\n        break;\n\n      case 'null':\n        if (val === null) {\n          addType = true;\n        }\n\n        break;\n\n      /* c8 ignore next 2 */\n\n      default:\n        throw new TypeError('Unknown value type ' + valueType);\n    }\n\n    if (addType) {\n      retObj = {\n        path: path,\n        value: val,\n        parent: parent,\n        parentProperty: parentPropName\n      };\n\n      this._handleCallback(retObj, callback, 'value');\n\n      return retObj;\n    } // `-escaped property\n\n  } else if (loc[0] === '`' && val && hasOwnProp.call(val, loc.slice(1))) {\n    var locProp = loc.slice(1);\n    addRet(this._trace(x, val[locProp], push(path, locProp), val, locProp, callback, hasArrExpr, true));\n  } else if (loc.includes(',')) {\n    // [name1,name2,...]\n    var parts = loc.split(',');\n\n    var _iterator = _createForOfIteratorHelper(parts),\n        _step;\n\n    try {\n      for (_iterator.s(); !(_step = _iterator.n()).done;) {\n        var part = _step.value;\n        addRet(this._trace(unshift(part, x), val, path, parent, parentPropName, callback, true));\n      } // simple case--directly follow property\n\n    } catch (err) {\n      _iterator.e(err);\n    } finally {\n      _iterator.f();\n    }\n  } else if (!literalPriority && val && hasOwnProp.call(val, loc)) {\n    addRet(this._trace(x, val[loc], push(path, loc), val, loc, callback, hasArrExpr, true));\n  } // We check the resulting values for parent selections. For parent\n  // selections we discard the value object and continue the trace with the\n  // current val object\n\n\n  if (this._hasParentSelector) {\n    for (var t = 0; t < ret.length; t++) {\n      var rett = ret[t];\n\n      if (rett && rett.isParentSelector) {\n        var tmp = this._trace(rett.expr, val, rett.path, parent, parentPropName, callback, hasArrExpr);\n\n        if (Array.isArray(tmp)) {\n          ret[t] = tmp[0];\n          var tl = tmp.length;\n\n          for (var tt = 1; tt < tl; tt++) {\n            t++;\n            ret.splice(t, 0, tmp[tt]);\n          }\n        } else {\n          ret[t] = tmp;\n        }\n      }\n    }\n  }\n\n  return ret;\n};\n\nJSONPath.prototype._walk = function (loc, expr, val, path, parent, parentPropName, callback, f) {\n  if (Array.isArray(val)) {\n    var n = val.length;\n\n    for (var i = 0; i < n; i++) {\n      f(i, loc, expr, val, path, parent, parentPropName, callback);\n    }\n  } else if (val && _typeof(val) === 'object') {\n    Object.keys(val).forEach(function (m) {\n      f(m, loc, expr, val, path, parent, parentPropName, callback);\n    });\n  }\n};\n\nJSONPath.prototype._slice = function (loc, expr, val, path, parent, parentPropName, callback) {\n  if (!Array.isArray(val)) {\n    return undefined;\n  }\n\n  var len = val.length,\n      parts = loc.split(':'),\n      step = parts[2] && Number.parseInt(parts[2]) || 1;\n  var start = parts[0] && Number.parseInt(parts[0]) || 0,\n      end = parts[1] && Number.parseInt(parts[1]) || len;\n  start = start < 0 ? Math.max(0, start + len) : Math.min(len, start);\n  end = end < 0 ? Math.max(0, end + len) : Math.min(len, end);\n  var ret = [];\n\n  for (var i = start; i < end; i += step) {\n    var tmp = this._trace(unshift(i, expr), val, path, parent, parentPropName, callback, true); // Should only be possible to be an array here since first part of\n    //   ``unshift(i, expr)` passed in above would not be empty, nor `~`,\n    //     nor begin with `@` (as could return objects)\n    // This was causing excessive stack size in Node (with or\n    //  without Babel) against our performance test: `ret.push(...tmp);`\n\n\n    tmp.forEach(function (t) {\n      ret.push(t);\n    });\n  }\n\n  return ret;\n};\n\nJSONPath.prototype._eval = function (code, _v, _vname, path, parent, parentPropName) {\n  if (code.includes('@parentProperty')) {\n    this.currSandbox._$_parentProperty = parentPropName;\n    code = code.replace(/@parentProperty/g, '_$_parentProperty');\n  }\n\n  if (code.includes('@parent')) {\n    this.currSandbox._$_parent = parent;\n    code = code.replace(/@parent/g, '_$_parent');\n  }\n\n  if (code.includes('@property')) {\n    this.currSandbox._$_property = _vname;\n    code = code.replace(/@property/g, '_$_property');\n  }\n\n  if (code.includes('@path')) {\n    this.currSandbox._$_path = JSONPath.toPathString(path.concat([_vname]));\n    code = code.replace(/@path/g, '_$_path');\n  }\n\n  if (code.includes('@root')) {\n    this.currSandbox._$_root = this.json;\n    code = code.replace(/@root/g, '_$_root');\n  }\n\n  if (/@([\\t-\\r \\)\\.\\[\\xA0\\u1680\\u2000-\\u200A\\u2028\\u2029\\u202F\\u205F\\u3000\\uFEFF])/.test(code)) {\n    this.currSandbox._$_v = _v;\n    code = code.replace(/@([\\t-\\r \\)\\.\\[\\xA0\\u1680\\u2000-\\u200A\\u2028\\u2029\\u202F\\u205F\\u3000\\uFEFF])/g, '_$_v$1');\n  }\n\n  try {\n    return this.vm.runInNewContext(code, this.currSandbox);\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.log(e);\n    throw new Error('jsonPath: ' + e.message + ': ' + code);\n  }\n}; // PUBLIC CLASS PROPERTIES AND METHODS\n// Could store the cache object itself\n\n\nJSONPath.cache = {};\n/**\n * @param {string[]} pathArr Array to convert\n * @returns {string} The path string\n */\n\nJSONPath.toPathString = function (pathArr) {\n  var x = pathArr,\n      n = x.length;\n  var p = '$';\n\n  for (var i = 1; i < n; i++) {\n    if (!/^(~|\\^|@(?:[\\0-\\t\\x0B\\f\\x0E-\\u2027\\u202A-\\uD7FF\\uE000-\\uFFFF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF])*?\\(\\))$/.test(x[i])) {\n      p += /^[\\*0-9]+$/.test(x[i]) ? '[' + x[i] + ']' : \"['\" + x[i] + \"']\";\n    }\n  }\n\n  return p;\n};\n/**\n * @param {string} pointer JSON Path\n * @returns {string} JSON Pointer\n */\n\n\nJSONPath.toPointer = function (pointer) {\n  var x = pointer,\n      n = x.length;\n  var p = '';\n\n  for (var i = 1; i < n; i++) {\n    if (!/^(~|\\^|@(?:[\\0-\\t\\x0B\\f\\x0E-\\u2027\\u202A-\\uD7FF\\uE000-\\uFFFF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF])*?\\(\\))$/.test(x[i])) {\n      p += '/' + x[i].toString().replace(/~/g, '~0').replace(/\\//g, '~1');\n    }\n  }\n\n  return p;\n};\n/**\n * @param {string} expr Expression to convert\n * @returns {string[]}\n */\n\n\nJSONPath.toPathArray = function (expr) {\n  var cache = JSONPath.cache;\n\n  if (cache[expr]) {\n    return cache[expr].concat();\n  }\n\n  var subx = [];\n  var normalized = expr // Properties\n  .replace(/@(?:null|boolean|number|string|integer|undefined|nonFinite|scalar|array|object|function|other)\\(\\)/g, ';$&;') // Parenthetical evaluations (filtering and otherwise), directly\n  //   within brackets or single quotes\n  .replace(/['\\[](\\??\\((?:[\\0-\\t\\x0B\\f\\x0E-\\u2027\\u202A-\\uD7FF\\uE000-\\uFFFF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF])*?\\))['\\]]/g, function ($0, $1) {\n    return '[#' + (subx.push($1) - 1) + ']';\n  }) // Escape periods and tildes within properties\n  .replace(/\\[[\"']((?:(?!['\\]])[\\s\\S])*)[\"']\\]/g, function ($0, prop) {\n    return \"['\" + prop.replace(/\\./g, '%@%').replace(/~/g, '%%@@%%') + \"']\";\n  }) // Properties operator\n  .replace(/~/g, ';~;') // Split by property boundaries\n  .replace(/[\"']?\\.[\"']?(?!(?:(?!\\[)[\\s\\S])*\\])|\\[[\"']?/g, ';') // Reinsert periods within properties\n  .replace(/%@%/g, '.') // Reinsert tildes within properties\n  .replace(/%%@@%%/g, '~') // Parent\n  .replace(/(?:;)?(\\^+)(?:;)?/g, function ($0, ups) {\n    return ';' + ups.split('').join(';') + ';';\n  }) // Descendents\n  .replace(/;;;|;;/g, ';..;') // Remove trailing\n  .replace(/;$|'?\\]|'$/g, '');\n  var exprList = normalized.split(';').map(function (exp) {\n    var match = exp.match(/#([0-9]+)/);\n    return !match || !match[1] ? exp : subx[match[1]];\n  });\n  cache[expr] = exprList;\n  return cache[expr].concat();\n};\n\n/**\n* @callback ConditionCallback\n* @param {any} item\n* @returns {boolean}\n*/\n\n/**\n * Copy items out of one array into another.\n * @param {GenericArray} source Array with items to copy\n * @param {GenericArray} target Array to which to copy\n * @param {ConditionCallback} conditionCb Callback passed the current item;\n *     will move item if evaluates to `true`\n * @returns {void}\n */\n\nvar moveToAnotherArray = function moveToAnotherArray(source, target, conditionCb) {\n  var il = source.length;\n\n  for (var i = 0; i < il; i++) {\n    var item = source[i];\n\n    if (conditionCb(item)) {\n      target.push(source.splice(i--, 1)[0]);\n    }\n  }\n};\n\nJSONPath.prototype.vm = {\n  /**\n   * @param {string} expr Expression to evaluate\n   * @param {PlainObject} context Object whose items will be added\n   *   to evaluation\n   * @returns {any} Result of evaluated code\n   */\n  runInNewContext: function runInNewContext(expr, context) {\n    var keys = Object.keys(context);\n    var funcs = [];\n    moveToAnotherArray(keys, funcs, function (key) {\n      return typeof context[key] === 'function';\n    });\n    var values = keys.map(function (vr, i) {\n      return context[vr];\n    });\n    var funcString = funcs.reduce(function (s, func) {\n      var fString = context[func].toString();\n\n      if (!/function/.test(fString)) {\n        fString = 'function ' + fString;\n      }\n\n      return 'var ' + func + '=' + fString + ';' + s;\n    }, '');\n    expr = funcString + expr; // Mitigate http://perfectionkills.com/global-eval-what-are-the-options/#new_function\n\n    if (!/([\"'])use strict\\1/.test(expr) && !keys.includes('arguments')) {\n      expr = 'var arguments = undefined;' + expr;\n    } // Remove last semi so `return` will be inserted before\n    //  the previous one instead, allowing for the return\n    //  of a bare ending expression\n\n\n    expr = expr.replace(/;[\\t-\\r \\xA0\\u1680\\u2000-\\u200A\\u2028\\u2029\\u202F\\u205F\\u3000\\uFEFF]*$/, ''); // Insert `return`\n\n    var lastStatementEnd = expr.lastIndexOf(';');\n    var code = lastStatementEnd > -1 ? expr.slice(0, lastStatementEnd + 1) + ' return ' + expr.slice(lastStatementEnd + 1) : ' return ' + expr; // eslint-disable-next-line no-new-func\n\n    return _construct(Function, _toConsumableArray(keys).concat([code])).apply(void 0, _toConsumableArray(values));\n  }\n};\n\nexport { JSONPath };\n","import { InfoBox, InlineField, InlineFieldRow, Select } from '@grafana/ui';\nimport { JSONPath } from 'jsonpath-plus';\nimport React from 'react';\nimport { JsonApiQuery } from 'types';\n\ninterface Props {\n  query: JsonApiQuery;\n  onChange: (query: JsonApiQuery) => void;\n  onRunQuery: () => void;\n  editorContext: string;\n}\n\nexport const ExperimentalEditor = ({ query, onChange, onRunQuery, editorContext }: Props) => {\n  // Group by\n  const { experimentalGroupByField: groupByField } = query;\n\n  const onGroupByChange = (field?: string) => {\n    onChange({ ...query, experimentalGroupByField: field });\n    onRunQuery();\n  };\n\n  // Metric\n  const { experimentalMetricField: metricField } = query;\n\n  const onMetricChange = (field?: string) => {\n    onChange({ ...query, experimentalMetricField: field });\n    onRunQuery();\n  };\n\n  // Variable label\n  const { experimentalVariableTextField: variableTextField } = query;\n\n  const onVariableLabelChange = (field?: string) => {\n    onChange({ ...query, experimentalVariableTextField: field });\n    onRunQuery();\n  };\n\n  // Variable value\n  const { experimentalVariableValueField: variableValueField } = query;\n\n  const onVariableValueChange = (field?: string) => {\n    onChange({ ...query, experimentalVariableValueField: field });\n    onRunQuery();\n  };\n\n  // TODO: Extract field names from the actual result.\n  const fieldNames = query.fields\n    .map((field) => {\n      if (field.language === 'jsonpath') {\n        if (field.name) {\n          return field.name;\n        }\n\n        const pathArray = (JSONPath as any).toPathArray(field.jsonPath);\n        return pathArray[pathArray.length - 1];\n      }\n\n      return field.name;\n    })\n    .filter((name) => name)\n    .map((path) => ({ label: path, value: path }));\n\n  return (\n    <>\n      <InfoBox severity=\"warning\" style={{ maxWidth: '700px', whiteSpace: 'normal' }}>\n        <p>\n          {`The features listed here are experimental. They might change or be removed without notice. In the tooltip for\n          each feature, there's a link to a pull request where you can submit feedback for that feature.`}\n        </p>\n      </InfoBox>\n      {editorContext === 'default' && (\n        <>\n          <InlineFieldRow>\n            <InlineField\n              labelWidth={12}\n              label=\"Group by\"\n              tooltip={\n                <>\n                  <p>\n                    {\n                      'Groups the query result into multiple results. This can be useful when you want to graph multiple time series in the same panel.'\n                    }\n                  </p>\n                  <a\n                    href=\"https://github.com/grafana/grafana-json-datasource/issues/36\"\n                    target=\"_blank\"\n                    rel=\"noreferrer\"\n                  >\n                    Share feedback\n                  </a>\n                </>\n              }\n            >\n              <Select\n                placeholder={'Field'}\n                width={20}\n                isClearable={true}\n                value={fieldNames.find((v) => v.value === groupByField)}\n                options={fieldNames}\n                onChange={(value) => onGroupByChange(value?.value)}\n              />\n            </InlineField>\n          </InlineFieldRow>\n          <InlineFieldRow>\n            <InlineField\n              labelWidth={12}\n              label=\"Metric\"\n              tooltip={\n                <>\n                  <p>{'Set the display name of the selected field to the name of the query result.'}</p>\n                  <a\n                    href=\"https://github.com/grafana/grafana-json-datasource/issues/36\"\n                    target=\"_blank\"\n                    rel=\"noreferrer\"\n                  >\n                    Share feedback\n                  </a>\n                </>\n              }\n            >\n              <Select\n                placeholder={'Field'}\n                width={20}\n                isClearable={true}\n                value={fieldNames.find((v) => v.value === metricField)}\n                options={fieldNames}\n                onChange={(value) => onMetricChange(value?.value)}\n              />\n            </InlineField>\n          </InlineFieldRow>\n        </>\n      )}\n      {editorContext === 'variables' && (\n        <>\n          <InlineFieldRow>\n            <InlineField\n              labelWidth={15}\n              label=\"Variable text\"\n              tooltip={\n                <>\n                  <p>{'Field to use for the text label of a variable query.'}</p>\n                  <a\n                    href=\"https://github.com/grafana/grafana-json-datasource/issues/79\"\n                    target=\"_blank\"\n                    rel=\"noreferrer\"\n                  >\n                    Share feedback\n                  </a>\n                </>\n              }\n            >\n              <Select\n                placeholder={'Field'}\n                width={20}\n                isClearable={true}\n                value={fieldNames.find((v) => v.value === variableTextField)}\n                options={fieldNames}\n                onChange={(value) => onVariableLabelChange(value?.value)}\n              />\n            </InlineField>\n          </InlineFieldRow>\n          <InlineFieldRow>\n            <InlineField\n              labelWidth={15}\n              label=\"Variable value\"\n              tooltip={\n                <>\n                  <p>{'Field to use for the value of a variable query.'}</p>\n                  <a\n                    href=\"https://github.com/grafana/grafana-json-datasource/issues/79\"\n                    target=\"_blank\"\n                    rel=\"noreferrer\"\n                  >\n                    Share feedback\n                  </a>\n                </>\n              }\n            >\n              <Select\n                placeholder={'Field'}\n                width={20}\n                isClearable={true}\n                value={fieldNames.find((v) => v.value === variableValueField)}\n                options={fieldNames}\n                onChange={(value) => onVariableValueChange(value?.value)}\n              />\n            </InlineField>\n          </InlineFieldRow>\n        </>\n      )}\n    </>\n  );\n};\n","import { BracesPlugin, QueryField, SlatePrism } from '@grafana/ui';\nimport React from 'react';\n\ninterface Props {\n  query: string;\n  onBlur: () => void;\n  onChange: (v: string) => void;\n}\n\n/**\n * JsonataQueryField is an editor for JSONata expressions.\n */\nexport const JsonataQueryField: React.FC<Props> = ({ query, onBlur, onChange }) => {\n  /**\n   * The QueryField supports Slate plugins, so let's add a few useful ones.\n   */\n  const plugins = [\n    BracesPlugin(),\n    SlatePrism({\n      onlyIn: (node: any) => node.type === 'code_block',\n      getSyntax: () => 'js',\n    }),\n  ];\n\n  return (\n    <QueryField\n      additionalPlugins={plugins}\n      query={query}\n      onRunQuery={onBlur}\n      onChange={onChange}\n      portalOrigin=\"jsonapi\"\n      placeholder=\"$sum(orders.(price*quantity))\"\n    />\n  );\n};\n","import { JSONPath, JSONPathOptions } from 'jsonpath-plus';\n\nexport function jp(options: JSONPathOptions): any {\n  return JSONPath({\n    ...options,\n    preventEval: true,\n  });\n}\n","import { TypeaheadInput, TypeaheadOutput } from '@grafana/ui';\nimport { jp } from './jsonpath';\n\n/**\n * onSuggest returns suggestions for the current JSON Path and cursor position.\n *\n * Normally you'd have to parse the query language here. This function\n * simplifies this by instead using JSON Path for getting the actual values.\n *\n * The onData provides the source data used when generating the suggestions.\n * This makes it easier to test the suggestions logic.\n */\nexport const onSuggest = async (input: TypeaheadInput, onData: () => Promise<any>): Promise<TypeaheadOutput> => {\n  const { value } = input;\n\n  const emptyResult: TypeaheadOutput = { suggestions: [] };\n\n  if (!value) {\n    return emptyResult;\n  }\n\n  const selectedLines = value.document.getTextsAtRange(value.selection);\n  const currentLine = selectedLines.size === 1 ? selectedLines.first().getText() : null;\n\n  if (!currentLine) {\n    return emptyResult;\n  }\n\n  const toCursor = currentLine.slice(0, value.selection.anchor.offset);\n\n  // $.dat|\n  const currIdentifier = /[a-zA-Z0-9]$/;\n\n  // $.data.|\n  const nextIdentifier = /[\\$\\]a-zA-Z0-9]\\.$/;\n\n  // $.data[|\n  const enterBrackets = /\\[$/;\n\n  // $.data[?(@.|\n  const currentNodeIdentifier = /@\\.$/;\n\n  // Here we check whether the cursor is in a position where it should\n  // suggest.\n  const shouldSuggest =\n    currIdentifier.test(toCursor) ||\n    nextIdentifier.test(toCursor) ||\n    currentNodeIdentifier.test(toCursor) ||\n    enterBrackets.test(toCursor);\n\n  if (!shouldSuggest) {\n    return emptyResult;\n  }\n\n  // Suggest operators inside brackets.\n  if (enterBrackets.test(toCursor)) {\n    return {\n      suggestions: [\n        {\n          label: 'Operators',\n          items: [\n            { label: '*', documentation: 'Returns all elements.' },\n            { label: ':', documentation: 'Returns a slice of the array.' },\n            {\n              label: '?',\n              insertText: '?()',\n              move: -1,\n              documentation: 'Returns elements based on a filter expression.',\n            },\n          ],\n        },\n      ],\n    };\n  }\n\n  const insideBrackets = toCursor.lastIndexOf('[') > toCursor.lastIndexOf(']');\n\n  // Construct a JSON Path that returns the items in the current context.\n  const path = insideBrackets\n    ? toCursor.slice(0, toCursor.lastIndexOf('[') + 1) + ':]'\n    : currentLine.slice(0, currentLine.lastIndexOf('.'));\n\n  // Get the actual JSON for parsing.\n  const response = await onData();\n\n  const values = jp({ path, json: response });\n\n  // Don't attempt to suggest if this is a leaf node, e.g. strings, numbers, and booleans.\n  if (typeof values[0] !== 'object') {\n    return emptyResult;\n  }\n\n  return {\n    suggestions: [\n      {\n        label: 'Elements', // Name of the suggestion group\n        items: Object.entries(values[0]).map(([key, value]) => {\n          return Array.isArray(value)\n            ? {\n                label: key, // Text to display in the suggestion list\n                insertText: key + '[]', // When selecting an array, we automatically insert the brackets ...\n                move: -1, // ... and put the cursor between them\n                documentation: `_array (${value.length})_`, // Markdown documentation for the suggestion\n              }\n            : {\n                label: key,\n                documentation: `_${typeof value}_\\n\\n**Preview:**\\n\\n\\`${value}\\``,\n              };\n        }),\n      },\n    ],\n  };\n};\n","import { BracesPlugin, QueryField, SlatePrism, TypeaheadInput } from '@grafana/ui';\nimport React from 'react';\nimport { onSuggest } from 'suggestions';\n\ninterface Props {\n  query: string;\n  onBlur: () => void;\n  onChange: (v: string) => void;\n  onData: () => Promise<any>;\n}\n\n/**\n * JsonPathQueryField is an editor for JSON Path.\n */\nexport const JsonPathQueryField: React.FC<Props> = ({ query, onBlur, onChange, onData }) => {\n  /**\n   * The QueryField supports Slate plugins, so let's add a few useful ones.\n   */\n  const plugins = [\n    BracesPlugin(),\n    SlatePrism({\n      onlyIn: (node: any) => node.type === 'code_block',\n      getSyntax: () => 'js',\n    }),\n  ];\n\n  // This is important if you don't want punctuation to interfere with your suggestions.\n  const cleanText = (s: string) => s.replace(/[{}[\\]=\"(),!~+\\-*/^%\\|\\$@\\.]/g, '').trim();\n\n  const onTypeahead = (input: TypeaheadInput) => onSuggest(input, onData);\n\n  return (\n    <QueryField\n      additionalPlugins={plugins}\n      query={query}\n      cleanText={cleanText}\n      onTypeahead={onTypeahead}\n      onRunQuery={onBlur}\n      onChange={onChange}\n      portalOrigin=\"jsonapi\"\n      placeholder=\"$.items[*].name\"\n    />\n  );\n};\n","import { FieldType, SelectableValue } from '@grafana/data';\nimport { Button, InlineField, InlineFieldRow, Input, Select } from '@grafana/ui';\nimport React from 'react';\nimport { JsonField, QueryLanguage } from 'types';\nimport { JsonataQueryField } from './JsonataQueryField';\nimport { JsonPathQueryField } from './JsonPathQueryField';\n\ninterface Props {\n  limit?: number;\n  onChange: (value: JsonField[]) => void;\n  onComplete: () => Promise<any>;\n  value: JsonField[];\n}\n\nexport const FieldEditor = ({ value = [], onChange, limit, onComplete }: Props) => {\n  const onChangePath = (i: number) => (e: string) => {\n    onChange(value.map((field, n) => (i === n ? { ...value[i], jsonPath: e } : field)));\n  };\n  const onLanguageChange = (i: number) => (e: SelectableValue<QueryLanguage>) => {\n    onChange(value.map((field, n) => (i === n ? { ...value[i], language: e.value } : field)));\n  };\n  const onChangeType = (i: number) => (e: SelectableValue<string>) => {\n    onChange(\n      value.map((field, n) =>\n        i === n ? { ...value[i], type: (e.value === 'auto' ? undefined : e.value) as FieldType } : field\n      )\n    );\n  };\n  const onAliasChange = (i: number) => (e: any) => {\n    onChange(value.map((field, n) => (i === n ? { ...value[i], name: e.currentTarget.value } : field)));\n  };\n\n  const addField = (i: number, defaults?: { language: QueryLanguage }) => () => {\n    if (!limit || value.length < limit) {\n      onChange([...value.slice(0, i + 1), { name: '', jsonPath: '', ...defaults }, ...value.slice(i + 1)]);\n    }\n  };\n  const removeField = (i: number) => () => {\n    onChange([...value.slice(0, i), ...value.slice(i + 1)]);\n  };\n\n  return (\n    <>\n      {value.map((field, index) => (\n        <InlineFieldRow key={index}>\n          <InlineField\n            label=\"Field\"\n            tooltip={\n              <div>\n                A <a href=\"https://goessner.net/articles/JsonPath/\">JSON Path</a> query that selects one or more values\n                from a JSON object.\n              </div>\n            }\n            grow\n          >\n            {field.language === 'jsonata' ? (\n              <JsonataQueryField onBlur={() => onChange(value)} onChange={onChangePath(index)} query={field.jsonPath} />\n            ) : (\n              <JsonPathQueryField\n                onBlur={() => onChange(value)}\n                onChange={onChangePath(index)}\n                query={field.jsonPath}\n                onData={onComplete}\n              />\n            )}\n          </InlineField>\n          <InlineField>\n            <Select\n              value={field.language ?? 'jsonpath'}\n              width={14}\n              onChange={onLanguageChange(index)}\n              options={[\n                { label: 'JSONPath', value: 'jsonpath' },\n                { label: 'JSONata', value: 'jsonata' },\n              ]}\n            />\n          </InlineField>\n          <InlineField label=\"Type\" tooltip=\"If Auto is set, the JSON property type is used to detect the field type.\">\n            <Select\n              value={field.type ?? 'auto'}\n              width={12}\n              onChange={onChangeType(index)}\n              options={[\n                { label: 'Auto', value: 'auto' },\n                { label: 'String', value: 'string' },\n                { label: 'Number', value: 'number' },\n                { label: 'Time', value: 'time' },\n                { label: 'Boolean', value: 'boolean' },\n              ]}\n            />\n          </InlineField>\n          <InlineField label=\"Alias\" tooltip=\"If left blank, the field uses the name of the queried element.\">\n            <Input width={12} value={field.name} onChange={onAliasChange(index)} />\n          </InlineField>\n\n          {(!limit || value.length < limit) && (\n            <Button\n              variant=\"secondary\"\n              onClick={addField(index, { language: field.language ?? 'jsonpath' })}\n              title=\"plus\"\n              icon=\"plus\"\n            />\n          )}\n\n          {value.length > 1 ? (\n            <Button variant=\"secondary\" onClick={removeField(index)} icon=\"minus\" title=\"minus\" />\n          ) : null}\n        </InlineFieldRow>\n      ))}\n    </>\n  );\n};\n","import { Component, createElement } from 'react';\n\n/**\n * Detect Element Resize.\n * https://github.com/sdecima/javascript-detect-element-resize\n * Sebastian Decima\n *\n * Forked from version 0.5.3; includes the following modifications:\n * 1) Guard against unsafe 'window' and 'document' references (to support SSR).\n * 2) Defer initialization code via a top-level function wrapper (to support SSR).\n * 3) Avoid unnecessary reflows by not measuring size for scroll events bubbling from children.\n * 4) Add nonce for style element.\n * 5) Use 'export' statement over 'module.exports' assignment\n **/\n\n// Check `document` and `window` in case of server-side rendering\nlet windowObject;\nif (typeof window !== \"undefined\") {\n  windowObject = window;\n\n  // eslint-disable-next-line no-restricted-globals\n} else if (typeof self !== \"undefined\") {\n  // eslint-disable-next-line no-restricted-globals\n  windowObject = self;\n} else {\n  windowObject = global;\n}\nlet cancelFrame = null;\nlet requestFrame = null;\nconst TIMEOUT_DURATION = 20;\nconst clearTimeoutFn = windowObject.clearTimeout;\nconst setTimeoutFn = windowObject.setTimeout;\nconst cancelAnimationFrameFn = windowObject.cancelAnimationFrame || windowObject.mozCancelAnimationFrame || windowObject.webkitCancelAnimationFrame;\nconst requestAnimationFrameFn = windowObject.requestAnimationFrame || windowObject.mozRequestAnimationFrame || windowObject.webkitRequestAnimationFrame;\nif (cancelAnimationFrameFn == null || requestAnimationFrameFn == null) {\n  // For environments that don't support animation frame,\n  // fallback to a setTimeout based approach.\n  cancelFrame = clearTimeoutFn;\n  requestFrame = function requestAnimationFrameViaSetTimeout(callback) {\n    return setTimeoutFn(callback, TIMEOUT_DURATION);\n  };\n} else {\n  // Counter intuitively, environments that support animation frames can be trickier.\n  // Chrome's \"Throttle non-visible cross-origin iframes\" flag can prevent rAFs from being called.\n  // In this case, we should fallback to a setTimeout() implementation.\n  cancelFrame = function cancelFrame([animationFrameID, timeoutID]) {\n    cancelAnimationFrameFn(animationFrameID);\n    clearTimeoutFn(timeoutID);\n  };\n  requestFrame = function requestAnimationFrameWithSetTimeoutFallback(callback) {\n    const animationFrameID = requestAnimationFrameFn(function animationFrameCallback() {\n      clearTimeoutFn(timeoutID);\n      callback();\n    });\n    const timeoutID = setTimeoutFn(function timeoutCallback() {\n      cancelAnimationFrameFn(animationFrameID);\n      callback();\n    }, TIMEOUT_DURATION);\n    return [animationFrameID, timeoutID];\n  };\n}\nfunction createDetectElementResize(nonce) {\n  let animationKeyframes;\n  let animationName;\n  let animationStartEvent;\n  let animationStyle;\n  let checkTriggers;\n  let resetTriggers;\n  let scrollListener;\n  const attachEvent = typeof document !== \"undefined\" && document.attachEvent;\n  if (!attachEvent) {\n    resetTriggers = function (element) {\n      const triggers = element.__resizeTriggers__,\n        expand = triggers.firstElementChild,\n        contract = triggers.lastElementChild,\n        expandChild = expand.firstElementChild;\n      contract.scrollLeft = contract.scrollWidth;\n      contract.scrollTop = contract.scrollHeight;\n      expandChild.style.width = expand.offsetWidth + 1 + \"px\";\n      expandChild.style.height = expand.offsetHeight + 1 + \"px\";\n      expand.scrollLeft = expand.scrollWidth;\n      expand.scrollTop = expand.scrollHeight;\n    };\n    checkTriggers = function (element) {\n      return element.offsetWidth !== element.__resizeLast__.width || element.offsetHeight !== element.__resizeLast__.height;\n    };\n    scrollListener = function (e) {\n      // Don't measure (which forces) reflow for scrolls that happen inside of children!\n      if (e.target.className && typeof e.target.className.indexOf === \"function\" && e.target.className.indexOf(\"contract-trigger\") < 0 && e.target.className.indexOf(\"expand-trigger\") < 0) {\n        return;\n      }\n      const element = this;\n      resetTriggers(this);\n      if (this.__resizeRAF__) {\n        cancelFrame(this.__resizeRAF__);\n      }\n      this.__resizeRAF__ = requestFrame(function animationFrame() {\n        if (checkTriggers(element)) {\n          element.__resizeLast__.width = element.offsetWidth;\n          element.__resizeLast__.height = element.offsetHeight;\n          element.__resizeListeners__.forEach(function forEachResizeListener(fn) {\n            fn.call(element, e);\n          });\n        }\n      });\n    };\n\n    /* Detect CSS Animations support to detect element display/re-attach */\n    let animation = false;\n    let keyframeprefix = \"\";\n    animationStartEvent = \"animationstart\";\n    const domPrefixes = \"Webkit Moz O ms\".split(\" \");\n    let startEvents = \"webkitAnimationStart animationstart oAnimationStart MSAnimationStart\".split(\" \");\n    let pfx = \"\";\n    {\n      const elm = document.createElement(\"fakeelement\");\n      if (elm.style.animationName !== undefined) {\n        animation = true;\n      }\n      if (animation === false) {\n        for (let i = 0; i < domPrefixes.length; i++) {\n          if (elm.style[domPrefixes[i] + \"AnimationName\"] !== undefined) {\n            pfx = domPrefixes[i];\n            keyframeprefix = \"-\" + pfx.toLowerCase() + \"-\";\n            animationStartEvent = startEvents[i];\n            animation = true;\n            break;\n          }\n        }\n      }\n    }\n    animationName = \"resizeanim\";\n    animationKeyframes = \"@\" + keyframeprefix + \"keyframes \" + animationName + \" { from { opacity: 0; } to { opacity: 0; } } \";\n    animationStyle = keyframeprefix + \"animation: 1ms \" + animationName + \"; \";\n  }\n  const createStyles = function (doc) {\n    if (!doc.getElementById(\"detectElementResize\")) {\n      //opacity:0 works around a chrome bug https://code.google.com/p/chromium/issues/detail?id=286360\n      const css = (animationKeyframes ? animationKeyframes : \"\") + \".resize-triggers { \" + (animationStyle ? animationStyle : \"\") + \"visibility: hidden; opacity: 0; } \" + '.resize-triggers, .resize-triggers > div, .contract-trigger:before { content: \" \"; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; z-index: -1; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',\n        head = doc.head || doc.getElementsByTagName(\"head\")[0],\n        style = doc.createElement(\"style\");\n      style.id = \"detectElementResize\";\n      style.type = \"text/css\";\n      if (nonce != null) {\n        style.setAttribute(\"nonce\", nonce);\n      }\n      if (style.styleSheet) {\n        style.styleSheet.cssText = css;\n      } else {\n        style.appendChild(doc.createTextNode(css));\n      }\n      head.appendChild(style);\n    }\n  };\n  const addResizeListener = function (element, fn) {\n    if (attachEvent) {\n      element.attachEvent(\"onresize\", fn);\n    } else {\n      if (!element.__resizeTriggers__) {\n        const doc = element.ownerDocument;\n        const elementStyle = windowObject.getComputedStyle(element);\n        if (elementStyle && elementStyle.position === \"static\") {\n          element.style.position = \"relative\";\n        }\n        createStyles(doc);\n        element.__resizeLast__ = {};\n        element.__resizeListeners__ = [];\n        (element.__resizeTriggers__ = doc.createElement(\"div\")).className = \"resize-triggers\";\n        const expandTrigger = doc.createElement(\"div\");\n        expandTrigger.className = \"expand-trigger\";\n        expandTrigger.appendChild(doc.createElement(\"div\"));\n        const contractTrigger = doc.createElement(\"div\");\n        contractTrigger.className = \"contract-trigger\";\n        element.__resizeTriggers__.appendChild(expandTrigger);\n        element.__resizeTriggers__.appendChild(contractTrigger);\n        element.appendChild(element.__resizeTriggers__);\n        resetTriggers(element);\n        element.addEventListener(\"scroll\", scrollListener, true);\n\n        /* Listen for a css animation to detect element display/re-attach */\n        if (animationStartEvent) {\n          element.__resizeTriggers__.__animationListener__ = function animationListener(e) {\n            if (e.animationName === animationName) {\n              resetTriggers(element);\n            }\n          };\n          element.__resizeTriggers__.addEventListener(animationStartEvent, element.__resizeTriggers__.__animationListener__);\n        }\n      }\n      element.__resizeListeners__.push(fn);\n    }\n  };\n  const removeResizeListener = function (element, fn) {\n    if (attachEvent) {\n      element.detachEvent(\"onresize\", fn);\n    } else {\n      element.__resizeListeners__.splice(element.__resizeListeners__.indexOf(fn), 1);\n      if (!element.__resizeListeners__.length) {\n        element.removeEventListener(\"scroll\", scrollListener, true);\n        if (element.__resizeTriggers__.__animationListener__) {\n          element.__resizeTriggers__.removeEventListener(animationStartEvent, element.__resizeTriggers__.__animationListener__);\n          element.__resizeTriggers__.__animationListener__ = null;\n        }\n        try {\n          element.__resizeTriggers__ = !element.removeChild(element.__resizeTriggers__);\n        } catch (e) {\n          // Preact compat; see developit/preact-compat/issues/228\n        }\n      }\n    }\n  };\n  return {\n    addResizeListener,\n    removeResizeListener\n  };\n}\n\nclass AutoSizer extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      height: this.props.defaultHeight || 0,\n      scaledHeight: this.props.defaultHeight || 0,\n      scaledWidth: this.props.defaultWidth || 0,\n      width: this.props.defaultWidth || 0\n    };\n    this._autoSizer = null;\n    this._detectElementResize = null;\n    this._parentNode = null;\n    this._resizeObserver = null;\n    this._timeoutId = null;\n    this._onResize = () => {\n      this._timeoutId = null;\n      const {\n        disableHeight,\n        disableWidth,\n        onResize\n      } = this.props;\n      if (this._parentNode) {\n        var _style$paddingLeft, _style$paddingRight, _style$paddingTop, _style$paddingBottom;\n        // Guard against AutoSizer component being removed from the DOM immediately after being added.\n        // This can result in invalid style values which can result in NaN values if we don't handle them.\n        // See issue #150 for more context.\n\n        const style = window.getComputedStyle(this._parentNode) || {};\n        const paddingLeft = parseFloat((_style$paddingLeft = style.paddingLeft) !== null && _style$paddingLeft !== void 0 ? _style$paddingLeft : \"0\");\n        const paddingRight = parseFloat((_style$paddingRight = style.paddingRight) !== null && _style$paddingRight !== void 0 ? _style$paddingRight : \"0\");\n        const paddingTop = parseFloat((_style$paddingTop = style.paddingTop) !== null && _style$paddingTop !== void 0 ? _style$paddingTop : \"0\");\n        const paddingBottom = parseFloat((_style$paddingBottom = style.paddingBottom) !== null && _style$paddingBottom !== void 0 ? _style$paddingBottom : \"0\");\n        const rect = this._parentNode.getBoundingClientRect();\n        const scaledHeight = rect.height - paddingTop - paddingBottom;\n        const scaledWidth = rect.width - paddingLeft - paddingRight;\n        const height = this._parentNode.offsetHeight - paddingTop - paddingBottom;\n        const width = this._parentNode.offsetWidth - paddingLeft - paddingRight;\n        if (!disableHeight && (this.state.height !== height || this.state.scaledHeight !== scaledHeight) || !disableWidth && (this.state.width !== width || this.state.scaledWidth !== scaledWidth)) {\n          this.setState({\n            height,\n            width,\n            scaledHeight,\n            scaledWidth\n          });\n          if (typeof onResize === \"function\") {\n            onResize({\n              height,\n              scaledHeight,\n              scaledWidth,\n              width\n            });\n          }\n        }\n      }\n    };\n    this._setRef = autoSizer => {\n      this._autoSizer = autoSizer;\n    };\n  }\n  componentDidMount() {\n    const {\n      nonce\n    } = this.props;\n    if (this._autoSizer && this._autoSizer.parentNode && this._autoSizer.parentNode.ownerDocument && this._autoSizer.parentNode.ownerDocument.defaultView && this._autoSizer.parentNode instanceof this._autoSizer.parentNode.ownerDocument.defaultView.HTMLElement) {\n      // Delay access of parentNode until mount.\n      // This handles edge-cases where the component has already been unmounted before its ref has been set,\n      // As well as libraries like react-lite which have a slightly different lifecycle.\n      this._parentNode = this._autoSizer.parentNode;\n\n      // Defer requiring resize handler in order to support server-side rendering.\n      // See issue #41\n      if (this._parentNode != null) {\n        if (typeof ResizeObserver !== \"undefined\") {\n          this._resizeObserver = new ResizeObserver(() => {\n            // Guard against \"ResizeObserver loop limit exceeded\" error;\n            // could be triggered if the state update causes the ResizeObserver handler to run long.\n            // See https://github.com/bvaughn/react-virtualized-auto-sizer/issues/55\n            this._timeoutId = setTimeout(this._onResize, 0);\n          });\n          this._resizeObserver.observe(this._parentNode);\n        } else {\n          this._detectElementResize = createDetectElementResize(nonce);\n          this._detectElementResize.addResizeListener(this._parentNode, this._onResize);\n        }\n        this._onResize();\n      }\n    }\n  }\n  componentWillUnmount() {\n    if (this._parentNode) {\n      if (this._detectElementResize) {\n        this._detectElementResize.removeResizeListener(this._parentNode, this._onResize);\n      }\n      if (this._timeoutId !== null) {\n        clearTimeout(this._timeoutId);\n      }\n      if (this._resizeObserver) {\n        this._resizeObserver.observe(this._parentNode);\n        this._resizeObserver.disconnect();\n      }\n    }\n  }\n  render() {\n    const {\n      children,\n      defaultHeight,\n      defaultWidth,\n      disableHeight = false,\n      disableWidth = false,\n      nonce,\n      onResize,\n      style = {},\n      tagName = \"div\",\n      ...rest\n    } = this.props;\n    const {\n      height,\n      scaledHeight,\n      scaledWidth,\n      width\n    } = this.state;\n\n    // Outer div should not force width/height since that may prevent containers from shrinking.\n    // Inner component should overflow and use calculated width/height.\n    // See issue #68 for more information.\n    const outerStyle = {\n      overflow: \"visible\"\n    };\n    const childParams = {};\n\n    // Avoid rendering children before the initial measurements have been collected.\n    // At best this would just be wasting cycles.\n    let bailoutOnChildren = false;\n    if (!disableHeight) {\n      if (height === 0) {\n        bailoutOnChildren = true;\n      }\n      outerStyle.height = 0;\n      childParams.height = height;\n      childParams.scaledHeight = scaledHeight;\n    }\n    if (!disableWidth) {\n      if (width === 0) {\n        bailoutOnChildren = true;\n      }\n      outerStyle.width = 0;\n      childParams.width = width;\n      childParams.scaledWidth = scaledWidth;\n    }\n    return createElement(tagName, {\n      ref: this._setRef,\n      style: {\n        ...outerStyle,\n        ...style\n      },\n      ...rest\n    }, !bailoutOnChildren && children(childParams));\n  }\n}\n\nfunction isHeightAndWidthProps(props) {\n  return props && props.disableHeight !== true && props.disableWidth !== true;\n}\nfunction isHeightOnlyProps(props) {\n  return props && props.disableHeight !== true && props.disableWidth === true;\n}\nfunction isWidthOnlyProps(props) {\n  return props && props.disableHeight === true && props.disableWidth !== true;\n}\n\nexport { AutoSizer as default, isHeightAndWidthProps, isHeightOnlyProps, isWidthOnlyProps };\n","import { DataQuery, DataSourceJsonData, FieldType } from '@grafana/data';\n\nexport type QueryLanguage = 'jsonpath' | 'jsonata';\n\nexport interface JsonField {\n  name?: string;\n  jsonPath: string;\n  type?: FieldType;\n  language?: QueryLanguage;\n}\n\nexport type Pair<T, K> = [T, K];\n\nexport interface JsonApiQuery extends DataQuery {\n  fields: JsonField[];\n  method: string;\n  urlPath: string;\n  queryParams: string;\n  params: Array<Pair<string, string>>;\n  headers: Array<Pair<string, string>>;\n  body: string;\n  cacheDurationSeconds: number;\n\n  // Keep for backwards compatibility with older version of variables query editor.\n  jsonPath?: string;\n\n  // Experimental\n  experimentalGroupByField?: string;\n  experimentalMetricField?: string;\n  experimentalVariableTextField?: string;\n  experimentalVariableValueField?: string;\n}\n\nexport const defaultQuery: Partial<JsonApiQuery> = {\n  cacheDurationSeconds: 300,\n  method: 'GET',\n  queryParams: '',\n  urlPath: '',\n  fields: [{ jsonPath: '' }],\n};\n\nexport interface JsonApiDataSourceOptions extends DataSourceJsonData {\n  queryParams?: string;\n}\n","import { GrafanaTheme } from '@grafana/data';\nimport { Button, Icon, stylesFactory, useTheme } from '@grafana/ui';\nimport { css } from '@emotion/css';\nimport React from 'react';\nimport { Pair } from '../types';\n\ninterface Props {\n  columns: string[];\n  values: Array<Pair<string, string>>;\n  addRowLabel: string;\n\n  onChange: (rows: Array<Pair<string, string>>) => void;\n  onBlur: () => void;\n}\n\nexport const KeyValueEditor = ({ columns, values, onChange, addRowLabel, onBlur }: Props) => {\n  const theme = useTheme();\n  const styles = getStyles(theme);\n\n  const updateCell = (colIdx: number, rowIdx: number, value: string) => {\n    onChange(\n      values.map(([key, val], idx) => {\n        if (rowIdx === idx) {\n          if (colIdx === 0) {\n            return [value, val];\n          } else if (colIdx === 1) {\n            return [key, value];\n          } else {\n            return [key, val];\n          }\n        }\n        return [key, val];\n      })\n    );\n  };\n\n  const addRow = (i: number) => {\n    onChange([...values.slice(0, i + 1), ['', ''], ...values.slice(i + 1)]);\n  };\n\n  const removeRow = (i: number) => {\n    onChange([...values.slice(0, i), ...values.slice(i + 1)]);\n  };\n\n  return values.length === 0 ? (\n    <Button\n      variant=\"secondary\"\n      onClick={() => {\n        addRow(0);\n      }}\n    >\n      {addRowLabel}\n    </Button>\n  ) : (\n    <table className={styles.root}>\n      <thead className={styles.thead}>\n        <tr className={styles.row}>\n          {columns.map((_, key) => (\n            <th key={key} className={styles.th}>\n              {_}\n            </th>\n          ))}\n          <th className={styles.th}></th>\n        </tr>\n      </thead>\n      <tbody className={styles.tbody}>\n        {values.map((row, rowIdx) => (\n          <tr key={rowIdx} className={styles.row}>\n            {row.map((cell, colIdx) => (\n              <td key={colIdx} className={styles.td}>\n                <input\n                  value={cell}\n                  onChange={(e) => updateCell(colIdx, rowIdx, e.currentTarget.value)}\n                  onBlur={onBlur}\n                  className={styles.input}\n                />\n              </td>\n            ))}\n            <td className={styles.td}>\n              <div\n                className={css`\n                  display: flex;\n                  & > * {\n                    margin-right: ${theme.spacing.xs};\n                  }\n                  & > *:last-child {\n                    margin-right: 0;\n                  }\n                `}\n              >\n                <a\n                  className={css`\n                    display: flex;\n                    background: ${theme.colors.bg2};\n                    padding: ${theme.spacing.xs} ${theme.spacing.sm};\n                    align-items: center;\n                    border-radius: ${theme.border.radius.sm};\n                  `}\n                  onClick={() => addRow(rowIdx)}\n                >\n                  <Icon name=\"plus\" />\n                </a>\n                <a\n                  className={css`\n                    display: flex;\n                    background: ${theme.colors.bg2};\n                    padding: ${theme.spacing.xs} ${theme.spacing.sm};\n                    align-items: center;\n                    border-radius: ${theme.border.radius.sm};\n                  `}\n                  onClick={() => removeRow(rowIdx)}\n                >\n                  <Icon name=\"minus\" />\n                </a>\n              </div>\n            </td>\n          </tr>\n        ))}\n      </tbody>\n    </table>\n  );\n};\n\nconst getStyles = stylesFactory((theme: GrafanaTheme) => {\n  return {\n    root: css`\n      table-layout: auto;\n      border: 1px solid ${theme.colors.formInputBorder};\n      border-collapse: separate;\n      border-radius: ${theme.border.radius.sm};\n      border-spacing: 0;\n      border-left: 0;\n      width: 100%;\n    `,\n    thead: css`\n      display: table-header-group;\n      vertical-align: middle;\n      border-color: inherit;\n      border-collapse: separate;\n\n      &:first-child tr:first-child th:first-child {\n        border-radius: ${theme.border.radius.sm} 0 0 0;\n      }\n      &:last-child tr:last-child th:first-child {\n        border-radius: 0 0 0 ${theme.border.radius.sm};\n      }\n    `,\n    tbody: css`\n      &:first-child tr:first-child td:first-child {\n        border-radius: ${theme.border.radius.sm} 0 0 0;\n      }\n\n      &:last-child tr:last-child td:first-child {\n        border-radius: 0 0 0 ${theme.border.radius.sm};\n      }\n    `,\n    input: css`\n      outline: none;\n      border: 0;\n      background: transparent;\n      width: 100%;\n    `,\n    row: css`\n      display: table-row;\n      vertical-align: inherit;\n      border-color: inherit;\n    `,\n    th: css`\n      padding: ${theme.spacing.xs} ${theme.spacing.sm};\n      border-left: solid ${theme.colors.formInputBorder} 1px;\n      font-size: ${theme.typography.size.sm};\n      color: ${theme.colors.textSemiWeak};\n      font-weight: ${theme.typography.weight.regular};\n\n      &:last-child {\n        border-left: 0;\n      }\n    `,\n    td: css`\n      padding: ${theme.spacing.xs} ${theme.spacing.sm};\n      border: 1px solid transparent;\n      border-left: solid ${theme.colors.formInputBorder} 1px;\n      border-top: solid ${theme.colors.formInputBorder} 1px;\n      background-color: ${theme.colors.formInputBg};\n      &:last-child {\n        border-left: 0;\n        width: 32px;\n        padding-left: 0;\n        padding-right: ${theme.spacing.xs};\n      }\n    `,\n  };\n});\n","import { InlineField, InlineFieldRow, Input, Select } from '@grafana/ui';\nimport React from 'react';\n\ninterface Props {\n  method: string;\n  onMethodChange: (method: string) => void;\n  path: string;\n  onPathChange: (path: string) => void;\n}\n\nexport const PathEditor = ({ method, onMethodChange, path, onPathChange }: Props) => {\n  return (\n    <InlineFieldRow>\n      <InlineField>\n        <Select\n          value={method}\n          options={[\n            { label: 'GET', value: 'GET' },\n            { label: 'POST', value: 'POST' },\n          ]}\n          onChange={(v) => onMethodChange(v.value ?? 'GET')}\n        />\n      </InlineField>\n      <InlineField grow>\n        <Input placeholder=\"/orders/${orderId}\" value={path} onChange={(e) => onPathChange(e.currentTarget.value)} />\n      </InlineField>\n    </InlineFieldRow>\n  );\n};\n","import { TimeRange } from '@grafana/data';\nimport { CodeEditor, InfoBox, InlineField, InlineFieldRow, RadioButtonGroup, Segment, useTheme } from '@grafana/ui';\nimport { JsonDataSource } from 'datasource';\nimport { css } from '@emotion/css';\nimport defaults from 'lodash/defaults';\nimport React, { useState } from 'react';\nimport AutoSizer from 'react-virtualized-auto-sizer';\nimport { defaultQuery, JsonApiQuery, Pair } from '../types';\nimport { KeyValueEditor } from './KeyValueEditor';\nimport { PathEditor } from './PathEditor';\n\n// Display a warning message when user adds any of the following headers.\nconst sensitiveHeaders = ['authorization', 'proxy-authorization', 'x-api-key'];\n\ninterface Props {\n  onChange: (query: JsonApiQuery) => void;\n  onRunQuery: () => void;\n  editorContext: string;\n  query: JsonApiQuery;\n  limitFields?: number;\n  datasource: JsonDataSource;\n  range?: TimeRange;\n\n  fieldsTab: React.ReactNode;\n  experimentalTab: React.ReactNode;\n}\n\nexport const TabbedQueryEditor = ({ query, onChange, onRunQuery, fieldsTab, experimentalTab }: Props) => {\n  const [bodyType, setBodyType] = useState('plaintext');\n  const [tabIndex, setTabIndex] = useState(0);\n  const theme = useTheme();\n\n  const q = defaults(query, defaultQuery);\n\n  const onBodyChange = (body: string) => {\n    onChange({ ...q, body });\n    onRunQuery();\n  };\n\n  const onParamsChange = (params: Array<Pair<string, string>>) => {\n    onChange({ ...q, params });\n    onRunQuery();\n  };\n\n  const onHeadersChange = (headers: Array<Pair<string, string>>) => {\n    onChange({ ...q, headers });\n    onRunQuery();\n  };\n\n  const tabs = [\n    {\n      title: 'Fields',\n      content: fieldsTab,\n    },\n    {\n      title: 'Path',\n      content: (\n        <PathEditor\n          method={q.method ?? 'GET'}\n          onMethodChange={(method) => {\n            onChange({ ...q, method });\n            onRunQuery();\n          }}\n          path={q.urlPath ?? ''}\n          onPathChange={(path) => {\n            onChange({ ...q, urlPath: path });\n            onRunQuery();\n          }}\n        />\n      ),\n    },\n    {\n      title: 'Params',\n      content: (\n        <KeyValueEditor\n          addRowLabel={'Add param'}\n          columns={['Key', 'Value']}\n          values={q.params ?? []}\n          onChange={onParamsChange}\n          onBlur={() => onRunQuery()}\n        />\n      ),\n    },\n    {\n      title: 'Headers',\n      content: (\n        <KeyValueEditor\n          addRowLabel={'Add header'}\n          columns={['Key', 'Value']}\n          values={q.headers ?? []}\n          onChange={onHeadersChange}\n          onBlur={() => onRunQuery()}\n        />\n      ),\n    },\n    {\n      title: 'Body',\n      content: (\n        <>\n          <InlineFieldRow>\n            <InlineField label=\"Syntax highlighting\">\n              <RadioButtonGroup\n                value={bodyType}\n                onChange={(v) => setBodyType(v ?? 'plaintext')}\n                options={[\n                  { label: 'Text', value: 'plaintext' },\n                  { label: 'JSON', value: 'json' },\n                  { label: 'XML', value: 'xml' },\n                ]}\n              />\n            </InlineField>\n          </InlineFieldRow>\n          <InlineFieldRow>\n            <AutoSizer\n              disableHeight\n              className={css`\n                margin-bottom: ${theme.spacing.sm};\n              `}\n            >\n              {({ width }) => (\n                <CodeEditor\n                  value={q.body || ''}\n                  language={bodyType}\n                  width={width}\n                  height=\"200px\"\n                  showMiniMap={false}\n                  showLineNumbers={true}\n                  onBlur={onBodyChange}\n                />\n              )}\n            </AutoSizer>\n          </InlineFieldRow>\n        </>\n      ),\n    },\n    {\n      title: 'Experimental',\n      content: experimentalTab,\n    },\n  ];\n\n  return (\n    <>\n      <InlineFieldRow>\n        <InlineField>\n          <RadioButtonGroup\n            onChange={(e) => setTabIndex(e ?? 0)}\n            value={tabIndex}\n            options={tabs.map((tab, idx) => ({ label: tab.title, value: idx }))}\n          />\n        </InlineField>\n        <InlineField\n          label=\"Cache Time\"\n          tooltip=\"Time in seconds that the response will be cached in Grafana after receiving it.\"\n        >\n          <Segment\n            value={{ label: formatCacheTimeLabel(q.cacheDurationSeconds), value: q.cacheDurationSeconds }}\n            options={[0, 5, 10, 30, 60, 60 * 2, 60 * 5, 60 * 10, 60 * 30, 3600, 3600 * 2, 3600 * 5].map((value) => ({\n              label: formatCacheTimeLabel(value),\n              value,\n              description: value ? '' : 'Response is not cached at all',\n            }))}\n            onChange={({ value }) => onChange({ ...q, cacheDurationSeconds: value! })}\n          />\n        </InlineField>\n      </InlineFieldRow>\n      {q.method === 'GET' && q.body && (\n        <InfoBox severity=\"warning\" style={{ maxWidth: '700px', whiteSpace: 'normal' }}>\n          {\"GET requests can't have a body. The body you've defined will be ignored.\"}\n        </InfoBox>\n      )}\n      {(q.headers ?? []).map(([key, _]) => key.toLowerCase()).find((_) => sensitiveHeaders.includes(_)) && (\n        <InfoBox severity=\"warning\" style={{ maxWidth: '700px', whiteSpace: 'normal' }}>\n          {\n            \"It looks like you're adding credentials in the header. Since queries are stored unencrypted, it's strongly recommended that you add any secrets to the data source config instead.\"\n          }\n        </InfoBox>\n      )}\n      {tabs[tabIndex].content}\n    </>\n  );\n};\n\nexport const formatCacheTimeLabel = (s: number) => {\n  if (s < 60) {\n    return s + 's';\n  } else if (s < 3600) {\n    return s / 60 + 'm';\n  }\n\n  return s / 3600 + 'h';\n};\n","import { QueryEditorProps } from '@grafana/data';\nimport { JsonDataSource } from 'datasource';\nimport React from 'react';\nimport { JsonApiDataSourceOptions, JsonApiQuery } from '../types';\nimport { ExperimentalEditor } from './ExperimentalEditor';\nimport { FieldEditor } from './FieldEditor';\nimport { TabbedQueryEditor } from './TabbedQueryEditor';\n\ninterface Props extends QueryEditorProps<JsonDataSource, JsonApiQuery, JsonApiDataSourceOptions> {\n  limitFields?: number;\n  editorContext?: string;\n}\n\nexport const QueryEditor: React.FC<Props> = (props) => {\n  const { query, editorContext, onChange, onRunQuery } = props;\n\n  return (\n    <TabbedQueryEditor\n      {...props}\n      editorContext={editorContext || 'default'}\n      fieldsTab={\n        <FieldEditor\n          value={query.fields}\n          onChange={(value) => {\n            onChange({ ...query, fields: value });\n            onRunQuery();\n          }}\n          limit={props.limitFields}\n          onComplete={() => props.datasource.metadataRequest(props.query, props.range)}\n        />\n      }\n      experimentalTab={\n        <ExperimentalEditor\n          query={query}\n          onChange={onChange}\n          onRunQuery={onRunQuery}\n          editorContext={editorContext || 'default'}\n        />\n      }\n    />\n  );\n};\n","import { BackendSrvRequest, getBackendSrv } from '@grafana/runtime';\nimport cache from 'memory-cache';\nimport { Observable } from 'rxjs';\nimport { Pair } from 'types';\n\nexport default class Api {\n  cache: any;\n  baseUrl: string;\n  params: URLSearchParams;\n  lastCacheDuration: number | undefined;\n\n  constructor(baseUrl: string, params: string) {\n    this.baseUrl = baseUrl;\n    this.params = new URLSearchParams('?' + params);\n    this.cache = new cache.Cache();\n  }\n\n  /**\n   * Queries the API and returns the response data.\n   */\n  async get(\n    method: string,\n    path: string,\n    params?: Array<Pair<string, string>>,\n    headers?: Array<Pair<string, string>>,\n    body?: string\n  ): Promise<any> {\n    const paramsData: Record<string, string> = {};\n    // In order to allow for duplicate URL params add a suffix to it to\n    // uniquify the key.  We strip this suffix off as part of\n    // constructing the final URL in _request()\n    let i = 0;\n    (params ?? []).forEach(([key, value]) => {\n      if (key) {\n        paramsData[key + '__' + i] = value;\n        i++;\n      }\n    });\n\n    this.params.forEach((value, key) => {\n      paramsData[key] = value;\n    });\n\n    const response = this._request(method, path, paramsData, headers, body);\n\n    return (await response.toPromise()).data;\n  }\n\n  /**\n   * Used as a health check.\n   */\n  async test(): Promise<any> {\n    const data: Record<string, string> = {};\n\n    this.params.forEach((value, key) => {\n      data[key] = value;\n    });\n\n    return this._request('GET', '', data).toPromise();\n  }\n\n  /**\n   * Returns a cached API response if it exists, otherwise queries the API.\n   */\n  async cachedGet(\n    cacheDurationSeconds: number,\n    method: string,\n    path: string,\n    params: Array<Pair<string, string>>,\n    headers?: Array<Pair<string, string>>,\n    body?: string\n  ): Promise<any> {\n    if (!cacheDurationSeconds) {\n      return await this.get(method, path, params, headers, body);\n    }\n\n    let cacheKey = this.baseUrl + path;\n\n    if (params && Object.keys(params).length > 0) {\n      cacheKey =\n        cacheKey +\n        (cacheKey.search(/\\?/) >= 0 ? '&' : '?') +\n        params.map(([k, v]) => `${encodeURIComponent(k)}=${encodeURIComponent(v)}`).join('&');\n    }\n\n    if (this.lastCacheDuration !== cacheDurationSeconds) {\n      this.cache.del(cacheKey);\n    }\n    this.lastCacheDuration = cacheDurationSeconds;\n\n    const cachedItem = this.cache.get(cacheKey);\n    if (cachedItem) {\n      return Promise.resolve(cachedItem);\n    }\n\n    const result = await this.get(method, path, params, headers, body);\n\n    this.cache.put(cacheKey, result, cacheDurationSeconds * 1000);\n\n    return result;\n  }\n\n  /**\n   * Make an API request using the data source configuration as defaults.\n   * Allows the user to append a path, or override query parameters.\n   *\n   * @param path to append to URL\n   * @param params to set as query parameters\n   */\n  _request(\n    method: string,\n    path: string,\n    params?: Record<string, string>,\n    headers?: Array<Pair<string, string>>,\n    data?: string\n  ): Observable<any> {\n    const recordHeaders: Record<string, any> = {};\n\n    (headers ?? [])\n      .filter(([key, _]) => key)\n      .forEach(([key, value]) => {\n        recordHeaders[key] = value;\n      });\n\n    const req: BackendSrvRequest = {\n      url: this.baseUrl + path,\n      method,\n      headers: recordHeaders,\n    };\n\n    if (req.method !== 'GET' && data) {\n      req.data = data;\n    }\n\n    // Deduplicate forward slashes, i.e. /// becomes /. This enables sensible\n    // defaults for empty variables.\n    //\n    // For example, `/orgs/${orgId}/list` becomes `/orgs/list` instead of\n    // `/orgs//list`.\n    req.url = req.url.replace(/[\\/]+/g, '/');\n\n    if (params && Object.keys(params).length > 0) {\n      req.url =\n        req.url +\n        (req.url.search(/\\?/) >= 0 ? '&' : '?') +\n        Object.entries(params)\n          .map(([k, v]) => `${encodeURIComponent(k.replace(/__\\d+$/, ''))}=${encodeURIComponent(v)}`)\n          .join('&');\n    }\n\n    return getBackendSrv().fetch(req);\n  }\n}\n","import { FieldType } from '@grafana/data';\n\nimport moment from 'moment'; // eslint-disable-line no-restricted-imports\n\n/**\n * Detects the field type from an array of values.\n */\nexport const detectFieldType = (values: any[]): FieldType => {\n  // If all values are null, default to strings.\n  if (values.every((_) => _ === null)) {\n    return FieldType.string;\n  }\n\n  // If all values are valid ISO 8601, then assume that it's a time field.\n  const isValidISO = values\n    .filter((value) => value !== null)\n    .every((value) => moment(value, [moment.defaultFormat, 'YYYY-MM-DD'], true).isValid());\n  if (isValidISO) {\n    return FieldType.time;\n  }\n\n  if (values.every((value) => typeof value === 'number')) {\n    return FieldType.number;\n  }\n\n  if (values.every((value) => typeof value === 'boolean')) {\n    return FieldType.boolean;\n  }\n\n  return FieldType.string;\n};\n","import {\n  ArrayVector,\n  DataFrame,\n  DataQueryRequest,\n  DataQueryResponse,\n  DataSourceApi,\n  DataSourceInstanceSettings,\n  Field,\n  MetricFindValue,\n  ScopedVars,\n  TimeRange,\n  toDataFrame,\n} from '@grafana/data';\nimport { getTemplateSrv } from '@grafana/runtime';\nimport jsonata from 'jsonata';\nimport { JSONPath } from 'jsonpath-plus';\nimport { jp } from './jsonpath';\nimport _ from 'lodash';\nimport API from './api';\nimport { detectFieldType } from './detectFieldType';\nimport { parseValues } from './parseValues';\nimport { JsonApiDataSourceOptions, JsonApiQuery, Pair } from './types';\nimport { trackRequest } from 'tracking';\n\nexport class JsonDataSource extends DataSourceApi<JsonApiQuery, JsonApiDataSourceOptions> {\n  api: API;\n\n  constructor(instanceSettings: DataSourceInstanceSettings<JsonApiDataSourceOptions>) {\n    super(instanceSettings);\n\n    this.api = new API(instanceSettings.url!, instanceSettings.jsonData.queryParams || '');\n  }\n\n  /**\n   * metadataRequest is used by the language provider to return the JSON\n   * document to generate suggestions for the QueryField.\n   *\n   * This is a custom method and is not part of the DataSourceApi, feel free to\n   * name it as you like.\n   */\n  async metadataRequest(query: JsonApiQuery, range?: TimeRange) {\n    return this.requestJson(query, replace({}, range));\n  }\n\n  async query(request: DataQueryRequest<JsonApiQuery>): Promise<DataQueryResponse> {\n    trackRequest(request);\n\n    const promises = await request.targets\n      .filter((query) => !query.hide)\n      .flatMap((query) => this.doRequest(query, request.range, request.scopedVars));\n\n    const res: DataFrame[][] = await Promise.all(promises);\n\n    // Wait for all queries to finish before returning the result.\n    return { data: res.flatMap((frames) => frames) };\n  }\n\n  /**\n   * Returns values for a Query variable.\n   *\n   * @param query\n   */\n  async metricFindQuery?(query: JsonApiQuery, options: Record<string, any>): Promise<MetricFindValue[]> {\n    const frames = await this.doRequest(query, options.range);\n    const frame = frames[0];\n\n    if (!frame.fields.length) {\n      return [];\n    }\n\n    const labelField =\n      frame.fields.find((field) => field.name === query.experimentalVariableTextField) ?? frame.fields[0];\n    const valueField = frame.fields.find((field) => field.name === query.experimentalVariableValueField) ?? labelField;\n\n    return Array.from({ length: frame.length }).map((_, idx) => ({\n      text: labelField.values.get(idx),\n      value: valueField.values.get(idx),\n    }));\n  }\n\n  /**\n   * This line adds support for annotation queries in >=7.2.\n   */\n  annotations = {};\n\n  /**\n   * Checks whether we can connect to the API.\n   */\n  async testDatasource() {\n    const defaultErrorMessage = 'Cannot connect to API';\n\n    try {\n      const response = await this.api.test();\n\n      if (response.status === 200) {\n        return {\n          status: 'success',\n          message: 'Success',\n        };\n      } else {\n        return {\n          status: 'error',\n          message: response.statusText ? response.statusText : defaultErrorMessage,\n        };\n      }\n    } catch (err: any) {\n      if (_.isString(err)) {\n        return {\n          status: 'error',\n          message: err,\n        };\n      } else {\n        let message = 'JSON API: ';\n        message += err.statusText ? err.statusText : defaultErrorMessage;\n        if (err.data && err.data.error && err.data.error.code) {\n          message += ': ' + err.data.error.code + '. ' + err.data.error.message;\n        }\n\n        return {\n          status: 'error',\n          message,\n        };\n      }\n    }\n  }\n\n  async doRequest(query: JsonApiQuery, range?: TimeRange, scopedVars?: ScopedVars): Promise<DataFrame[]> {\n    const replaceWithVars = replace(scopedVars, range);\n\n    const json = await this.requestJson(query, replaceWithVars);\n\n    if (!json) {\n      throw new Error('Query returned empty data');\n    }\n\n    const fields: Field[] = (query.fields ?? [])\n      .filter((field) => field.jsonPath)\n      .map((field, index) => {\n        switch (field.language) {\n          case 'jsonata':\n            const expression = jsonata(field.jsonPath);\n\n            const bindings: Record<string, any> = {};\n\n            // Bind dashboard variables to JSONata variables.\n            getTemplateSrv()\n              .getVariables()\n              .map((v) => ({ name: v.name, value: getVariable(v.name) }))\n              .forEach((v) => {\n                bindings[v.name] = v.value;\n              });\n\n            // Bind Global variables to JSONata variables.\n            globalVariables\n              .map((v) => ({ name: v, value: getVariable(v) }))\n              .forEach((v) => {\n                bindings[v.name] = v.value;\n              });\n\n            if (range) {\n              bindings['__unixEpochFrom'] = range.from.valueOf();\n              bindings['__unixEpochTo'] = range.to.valueOf();\n              bindings['__isoFrom'] = range.from.toISOString();\n              bindings['__isoTo'] = range.to.toISOString();\n            }\n\n            const result = expression.evaluate(json, bindings);\n\n            // Ensure that we always return an array.\n            const arrayResult = Array.isArray(result) ? result : [result];\n\n            return {\n              name: replaceWithVars(field.name ?? '') || (query.fields.length > 1 ? `result${index}` : 'result'),\n              type: field.type ? field.type : detectFieldType(arrayResult),\n              values: new ArrayVector(arrayResult),\n              config: {},\n            };\n          default:\n            const path = replaceWithVars(field.jsonPath);\n            const values = jp({ path, json });\n\n            // Get the path for automatic setting of the field name.\n            //\n            // Casted to any due to typing issues with JSONPath-Plus\n            const paths = (JSONPath as any).toPathArray(path);\n\n            const propertyType = field.type ? field.type : detectFieldType(values);\n            const typedValues = parseValues(values, propertyType);\n\n            return {\n              name: replaceWithVars(field.name ?? '') || paths[paths.length - 1],\n              type: propertyType,\n              values: new ArrayVector(typedValues),\n              config: {},\n            };\n        }\n      });\n\n    const fieldLengths = fields.map((field) => field.values.length);\n    const uniqueFieldLengths = Array.from(new Set(fieldLengths)).length;\n\n    // All fields need to have the same length for the data frame to be valid.\n    if (uniqueFieldLengths > 1) {\n      throw new Error('Fields have different lengths');\n    }\n\n    const frames = query.experimentalGroupByField\n      ? groupBy(\n          toDataFrame({\n            name: query.refId,\n            refId: query.refId,\n            fields: fields,\n          }),\n          query.experimentalGroupByField\n        )\n      : [\n          toDataFrame({\n            name: query.refId,\n            refId: query.refId,\n            fields: fields,\n          }),\n        ];\n\n    const res = frames.map((frame) => ({\n      ...frame,\n      fields: frame.fields.map(\n        (field: Field): Field =>\n          field.name === query.experimentalMetricField ? { ...field, config: { displayNameFromDS: frame.name } } : field\n      ),\n    }));\n\n    return res;\n  }\n\n  async requestJson(query: JsonApiQuery, interpolate: (text: string) => string) {\n    const interpolateKeyValue = ([key, value]: Pair<string, string>): Pair<string, string> => {\n      return [interpolate(key), interpolate(value)];\n    };\n\n    return await this.api.cachedGet(\n      query.cacheDurationSeconds,\n      query.method,\n      interpolate(query.urlPath),\n      (query.params ?? []).map(interpolateKeyValue),\n      (query.headers ?? []).map(interpolateKeyValue),\n      interpolate(query.body)\n    );\n  }\n}\n\nconst replace =\n  (scopedVars?: any, range?: TimeRange) =>\n  (str: string): string => {\n    return replaceMacros(getTemplateSrv().replace(str, scopedVars), range);\n  };\n\n// replaceMacros substitutes all available macros with their current value.\nexport const replaceMacros = (str: string, range?: TimeRange) => {\n  return range\n    ? str\n        .replace(/\\$__unixEpochFrom\\(\\)/g, range.from.unix().toString())\n        .replace(/\\$__unixEpochTo\\(\\)/g, range.to.unix().toString())\n        .replace(/\\$__isoFrom\\(\\)/g, range.from.toISOString())\n        .replace(/\\$__isoTo\\(\\)/g, range.to.toISOString())\n    : str;\n};\n\nexport const groupBy = (frame: DataFrame, fieldName: string): DataFrame[] => {\n  const groupByField = frame.fields.find((field) => field.name === fieldName);\n  if (!groupByField) {\n    return [frame];\n  }\n\n  const uniqueValues = new Set(groupByField.values.toArray());\n\n  const frames = [...uniqueValues].map((groupByValue) => {\n    const fields: Field[] = frame.fields\n      // Skip the field we're grouping on.\n      .filter((field) => field.name.toString() !== groupByField.name)\n      .map((field) => ({\n        ...field,\n        values: new ArrayVector(\n          field.values.toArray().filter((_, idx) => {\n            return groupByField.values.get(idx) === groupByValue;\n          })\n        ),\n      }));\n\n    return toDataFrame({\n      name: groupByValue,\n      refId: frame.refId,\n      fields,\n    });\n  });\n\n  return frames;\n};\n\n// Helper function to extract the values of a variable instead of interpolating it.\nconst getVariable = (name: any): string[] => {\n  const values: string[] = [];\n\n  // Instead of interpolating the string, we collect the values in an array.\n  getTemplateSrv().replace(`$${name}`, {}, (value: string | string[]) => {\n    if (Array.isArray(value)) {\n      values.push(...value);\n    } else {\n      values.push(value);\n    }\n\n    // We don't really care about the string here.\n    return '';\n  });\n\n  return values;\n};\n\nconst globalVariables: string[] = [\n  '__dashboard',\n  '__from',\n  '__to',\n  '__interval',\n  '__interval_ms',\n  '__name',\n  '__org',\n  '__user',\n  '__range',\n  '__rate_interval',\n  'timeFilter',\n  '__timeFilter',\n];\n","import { CoreApp, DataQueryRequest } from '@grafana/data';\nimport { reportInteraction } from '@grafana/runtime';\nimport { JsonApiQuery } from 'types';\n\nexport const trackRequest = (request: DataQueryRequest<JsonApiQuery>) => {\n  if (request.app === CoreApp.Dashboard || request.app === CoreApp.PanelViewer) {\n    return;\n  }\n\n  request.targets.forEach((target) => {\n    reportInteraction('grafana_json_query_executed', {\n      app: request.app,\n      cacheDurationSeconds: target.cacheDurationSeconds,\n      method: target.method,\n    });\n  });\n};\n","import { FieldType } from '@grafana/data';\nimport dayjs from 'dayjs';\n\n/**\n * parseValues converts values to the given field type.\n */\nexport const parseValues = (values: any[], type: FieldType): any[] => {\n  switch (type) {\n    case FieldType.time:\n      // For time field, values are expected to be numbers representing a Unix\n      // epoch in milliseconds.\n\n      if (values.filter((_) => _).every((value) => typeof value === 'string')) {\n        return values.map((_) => (_ !== null ? dayjs(_).valueOf() : _));\n      }\n\n      if (values.filter((_) => _).every((value) => typeof value === 'number')) {\n        const ms = 1_000_000_000_000;\n\n        // If there are no \"big\" numbers, assume seconds.\n        if (values.filter((_) => _).every((_) => _ < ms)) {\n          return values.map((_) => (_ !== null ? _ * 1000.0 : _));\n        }\n\n        // ... otherwise assume milliseconds.\n        return values;\n      }\n\n      throw new Error('Unsupported time property');\n    case FieldType.string:\n      return values.every((_) => typeof _ === 'string')\n        ? values\n        : values.map((_) => {\n            if (_ === null) {\n              return _;\n            } else if (typeof _ === 'object') {\n              return JSON.stringify(_);\n            } else {\n              return _.toString();\n            }\n          });\n    case FieldType.number:\n      return values.every((_) => typeof _ === 'number') ? values : values.map((_) => (_ !== null ? parseFloat(_) : _));\n    case FieldType.boolean:\n      return values.every((_) => typeof _ === 'boolean')\n        ? values\n        : values.map((_) => {\n            if (_ === null) {\n              return _;\n            }\n\n            switch (_.toString()) {\n              case '0':\n              case 'false':\n              case 'FALSE':\n              case 'False':\n                return false;\n              case '1':\n              case 'true':\n              case 'TRUE':\n              case 'True':\n                return true;\n              default:\n                throw new Error('Found non-boolean values in a field of type boolean: ' + _.toString());\n            }\n          });\n    default:\n      throw new Error('Unsupported field type');\n  }\n};\n","import { DataSourcePlugin } from '@grafana/data';\nimport { ConfigEditor } from './components/ConfigEditor';\nimport { QueryEditor } from './components/QueryEditor';\nimport { VariableQueryEditor } from './components/VariableQueryEditor';\nimport { JsonDataSource } from './datasource';\nimport { JsonApiDataSourceOptions, JsonApiQuery } from './types';\n\nexport const plugin = new DataSourcePlugin<JsonDataSource, JsonApiQuery, JsonApiDataSourceOptions>(JsonDataSource)\n  .setConfigEditor(ConfigEditor)\n  .setQueryEditor(QueryEditor)\n  .setVariableQueryEditor(VariableQueryEditor);\n","import { TimeRange } from '@grafana/data';\nimport { JsonDataSource } from 'datasource';\nimport defaults from 'lodash/defaults';\nimport React from 'react';\nimport { defaultQuery, JsonApiQuery } from '../types';\nimport { QueryEditor } from './QueryEditor';\n\ninterface VariableQueryProps {\n  query: JsonApiQuery;\n  onChange: (query: JsonApiQuery, definition: string) => void;\n  datasource: JsonDataSource;\n  range: TimeRange;\n}\n\n// VariableQueryEditor is used to query values for a dashboard variable.\nexport const VariableQueryEditor: React.FC<VariableQueryProps> = (props) => {\n  const { query, onChange } = props;\n\n  const q = defaults(query, defaultQuery);\n\n  const saveQuery = (newQuery: JsonApiQuery) => {\n    if (newQuery) {\n      onChange(newQuery, newQuery.fields[0].jsonPath);\n    }\n  };\n\n  return (\n    <QueryEditor\n      {...props}\n      onRunQuery={() => {}}\n      onChange={saveQuery}\n      query={q}\n      limitFields={2}\n      editorContext=\"variables\"\n    />\n  );\n};\n"],"names":["module","exports","e","n","r","i","s","u","a","o","c","f","h","d","l","$","y","M","name","weekdays","split","months","ordinal","t","m","String","length","Array","join","v","z","utcOffset","Math","abs","floor","date","year","month","clone","add","ceil","p","w","D","ms","Q","toLowerCase","replace","g","S","_","O","args","arguments","b","locale","$L","utc","$u","x","$x","$offset","this","parse","prototype","$d","Date","NaN","test","match","substring","UTC","init","$y","getFullYear","$M","getMonth","$D","getDate","$W","getDay","$H","getHours","$m","getMinutes","$s","getSeconds","$ms","getMilliseconds","$utils","isValid","toString","isSame","startOf","endOf","isAfter","isBefore","$g","set","unix","valueOf","getTime","toDate","apply","slice","$locale","weekStart","$set","min","daysInMonth","get","Number","round","subtract","format","invalidDate","meridiem","monthsShort","weekdaysMin","weekdaysShort","getTimezoneOffset","diff","toJSON","toISOString","toUTCString","k","forEach","extend","$i","isDayjs","en","Ls","Error","code","call","require","utils","dateTime","stringToArray","few","ordinals","decades","magnitudes","wordValues","word","index","lword","hundredth","val","pow","romanNumerals","romanValues","decimalToRoman","value","numeral","formatInteger","picture","_formatInteger","analyseIntegerPicture","formats","DECIMAL","LETTERS","ROMAN","WORDS","SEQUENCE","tcase","UPPER","LOWER","TITLE","formattedInteger","negative","primary","aChar","letters","aCode","charCodeAt","unshift","fromCharCode","decimalToLetters","case","toUpperCase","lookup","num","prev","ord","words","tens","remainder","hundreds","mag","log10","factor","mant","numberToWords","padLength","mandatoryDigits","padding","zeroCode","map","fromCodePoint","codePointAt","regular","ii","groupingSeparators","position","pos","substr","character","reverse","separator","suffix","token","decimalGroups","type","primaryFormat","formatModifier","semicolon","lastIndexOf","optionalDigits","separatorPosition","codePoint","digit","group","push","separators","sepChar","indexes","gcd","reduce","indexOf","regularRepeat","defaultPresentationModifiers","Y","F","W","X","H","P","Z","C","E","analyseDateTimePicture","spec","parts","addLiteral","start","end","literal","charAt","marker","presMod","def","component","comma","widthMod","dash","max","parseWidth","wm","parseInt","widthDef","width","presentation1","lastChar","presentation2","names","integerPattern","integerFormat","undefined","days","millisInADay","startOfFirstWeek","ym","jan1","dayOfJan1","getUTCDay","yearMonth","nextMonth","previousMonth","nextYear","previousYear","deltaWeeks","getDateTimeFragment","componentValue","getUTCFullYear","getUTCMonth","getUTCDate","thisYear","startOfWeek1","today","week","startOfPreviousYear","thisMonth","startOfPreviousMonth","startOfISOYear","endOfISOYear","now","startOfISOMonth","endOfISOMonth","getUTCHours","getUTCMinutes","getUTCSeconds","getUTCMilliseconds","iso8601Spec","formatDateTime","millis","timezone","offsetHours","offsetMinutes","offset","formatSpec","result","part","markerSpec","numDigits","formatComponent","generateRegex","matcher","res","regex","isArray","isUpper","occurrences","decimal","lettersToDecimal","roman","romanToDecimal","Object","keys","concat","text","values","segs","top","pop","wordsToNumber","digits","sep","char","parseDateTime","timestamp","matchSpec","fullRegex","info","RegExp","exec","dmA","dmB","dmC","dmD","tmA","tmB","components","mpart","getOwnPropertyNames","mask","shift","bit","isType","dateB","dateC","dateD","timeB","comps","environment","startSpecified","endSpecified","firstJan","offsetMillis","derivedDate","iso8601regex","parseInteger","fromMillis","toMillis","stack","global","functions","isNumeric","isArrayOfStrings","isArrayOfNumbers","createSequence","isSequence","isFunction","isLambda","isIterable","getFunctionArity","deepEquals","isDeepEqual","str","strArray","strLength","evaluateMatcher","groups","next","arg","precision","is","boolean","filter","hofFuncArgs","func","arg1","arg2","arg3","func_args","append","sum","total","count","average","string","prettify","isFinite","space","outerWrapper","JSON","stringify","key","toPrecision","substringBefore","chars","substringAfter","lowercase","uppercase","trim","pad","limit","matches","contains","pattern","replacement","replacer","regexMatch","substitute","dollarVal","maxDigits","log","LOG10E","isNaN","submatch","replacedWith","strs","formatNumber","options","properties","decimalDigitFamily","zeroCharCode","activeChars","subPictures","subpicture","mantissaPart","exponentPart","integerPart","fractionalPart","prefix","ch","activePart","exponentPosition","decimalPosition","error","decimalPos","percent","valid","optionalDigitPos","exponentExists","pic","adjustedNumber","mantissa","exponent","variables","getGroupingPositions","toLeft","positions","groupingPosition","charsToTheRight","integerPartGroupingPositions","regularGrouping","fractionalPartGroupingPositions","minimumIntegerPartSize","scalingFactor","fractionalPartArray","minimumFactionalPartSize","maximumFactionalPartSize","exponentPresent","minimumExponentSize","minus_sign","zero_digit","decimal_separator","grouping_separator","maxMantissa","minMantissa","makeString","dp","toFixed","stringValue","padLeft","padRight","groupCount","stringExponent","formatBase","radix","number","parseFloat","sqrt","power","exp","random","not","arr","zip","tuple","entry","single","hasFoundMatch","positiveResult","foldLeft","sequence","arity","sift","item","merge","input","exists","spread","obj","prop","each","message","assert","condition","sort","comparator","comp","msort","array","middle","left","right","merge_iter","merged","shuffle","j","distinct","results","includes","jj","base64encode","btoa","window","Buffer","from","base64decode","atob","encodeUrlComponent","returnVal","encodeURIComponent","functionName","encodeUrl","encodeURI","decodeUrlComponent","decodeURIComponent","decodeUrl","decodeURI","self","datetime","fn","parser","parseSignature","jsonata","staticFrame","createFrame","evaluate","expr","entryCallback","inputSequence","resultSequence","steps","isTupleStream","tupleBindings","step","consarray","evaluateTupleStep","evaluateStep","focus","keepSingletonArray","cons","keepSingleton","hasOwnProperty","evaluateGroupExpression","evaluatePath","lhs","op","evalrhs","rhs","lBool","boolize","evaluateBooleanExpression","err","evaluateNumericExpression","evaluateEqualityExpression","ltype","rtype","value2","evaluateComparisonExpression","lstr","rstr","evaluateStringConcat","isInteger","size","evaluateRangeExpression","evaluateIncludesExpression","evaluateBinary","expression","expressions","defineProperty","enumerable","configurable","evaluateUnary","evaluateName","evaluateLiteral","flatten","evaluateWildcard","recurseDescendants","evaluateDescendants","slot","label","then","else","evaluateCondition","frame","evaluateBlock","bind","evaluateBindExpression","re","RegexEngine","closure","fromIndex","lastIndex","source","evaluateRegex","evaluateFunction","evaluateVariable","procedure","_jsonata_lambda","signature","body","thunk","evaluateLambda","evaluatedArgs","proc","partialApplyProcedure","_jsonata_function","partialApplyNativeFunction","implementation","evaluatePartialApplication","context","chain","chainAST","evaluateApplyExpression","defineFunction","cloneFunction","update","updateType","delete","deletions","evaluateTransformExpression","async","Promise","resolve","nextFunction","predicate","evaluateFilter","exitCallback","tupleStream","keepArray","createFrameFromTuple","lastStep","evaluateSortExpression","stages","evaluateStages","ss","stage","ee","sorted","stepEnv","bb","assign","ancestor","env","ires","flattened","member","booledValue","itemIndex","pairIndex","pair","data","exprIndex","reduceTupleStream","isTupleSort","terms","term","aa","atype","btype","descending","applyto","params","procName","applyInner","validatedArgs","validate","validateArguments","param","getNativeFunctionArguments","sigArg","applyNativeFunction","applyProcedure","unboundArgs","native","sigArgs","bodyAST","definition","enclosingEnvironment","bindings","ancestry","ast","populateMessage","errorCodes","template","errors","recover","callback","exec_env","it","catchHandler","thenHandler","response","done","catch","registerFunction","operators","escapes","tokenizer","path","create","currentChar","commentStart","flags","depth","scanRegex","quoteType","qstr","octets","codepoint","node","lexer","symbol_table","remainingTokens","remaining","id","nxt","base_symbol","nud","symbol","bp","lbp","handleError","advance","infix","next_token","rbp","led","terminal","bindingPower","infixr","sigPos","sig","tok","range","objectParser","tailCallOptimize","ancestorLabel","ancestorIndex","seekParent","level","pushAncestry","seekingParent","slots","resolveAncestry","laststep","processAST","lstep","rest","lit","firststep","sortStep","argAST","arraySignatureMapping","prevParam","findClosingBracket","openSymbol","closeSymbol","contextRegex","endParen","choice","endPos","subtype","regexStr","getSymbol","suppliedSig","argIndex","contextType","arrayOK","itemType","badArgs","badSig","partialPattern","goodTo","throwValidationError","isNum","iteratorSymbol","Symbol","iterator","lkeys","rkeys","thisArg","baseTimes","isArguments","isBuffer","isIndex","isTypedArray","inherited","isArr","isArg","isBuff","skipIndexes","getRawTag","objectToString","symToStringTag","toStringTag","baseGetTag","isObjectLike","isMasked","isObject","toSource","reIsHostCtor","funcProto","Function","objectProto","funcToString","reIsNative","isLength","typedArrayTags","isPrototype","nativeKeysIn","object","isProto","identity","overRest","setToString","constant","baseSetToString","iteratee","coreJsData","getNative","freeGlobal","baseIsNative","getValue","nativeObjectToString","isOwn","tag","unmasked","reIsUint","eq","isArrayLike","uid","maskSrcKey","IE_PROTO","Ctor","constructor","freeExports","nodeType","freeModule","freeProcess","process","nodeUtil","types","binding","nativeMax","transform","otherArgs","freeSelf","root","shortOut","nativeNow","lastCalled","stamp","baseRest","isIterateeCall","keysIn","defaults","sources","guard","props","propsIndex","propsLength","other","baseIsArguments","propertyIsEnumerable","stubFalse","baseIsTypedArray","baseUnary","nodeIsTypedArray","arrayLikeKeys","baseKeysIn","Cache","_cache","_hitCount","_missCount","_size","_debug","_del","put","time","timeoutCallback","console","oldRecord","clearTimeout","timeout","record","expire","setTimeout","del","canDelete","clear","memsize","debug","bool","hits","misses","exportJson","plainJsCache","importJson","jsonToImport","cacheToImport","currTime","skipDuplicates","remainingTime","__WEBPACK_EXTERNAL_MODULE__7644__","__WEBPACK_EXTERNAL_MODULE__3305__","__WEBPACK_EXTERNAL_MODULE__3545__","__WEBPACK_EXTERNAL_MODULE__7388__","__WEBPACK_EXTERNAL_MODULE__5980__","__WEBPACK_EXTERNAL_MODULE__8283__","__WEBPACK_EXTERNAL_MODULE__2650__","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","loaded","__webpack_modules__","getter","__esModule","globalThis","nmd","paths","children","__defProp","__defProps","defineProperties","__getOwnPropDescs","getOwnPropertyDescriptors","__getOwnPropSymbols","getOwnPropertySymbols","__hasOwnProp","__propIsEnum","__defNormalProp","writable","__spreadValues","DataSourceDescription","dataSourceName","docsLink","hasRequiredFields","className","theme","useTheme2","styles","container","css","margin","marginTop","spacing","typography","color","colors","secondary","link","textDecoration","cx","href","target","rel","GenericConfigSection","title","description","isCollapsible","isInitiallyOpen","kind","isOpen","setIsOpen","useState","iconName","isSubSection","collapsibleButtonAriaLabel","header","display","justifyContent","alignItems","subtitle","fontWeight","fontWeightRegular","descriptionText","marginBottom","bodySmall","content","IconButton","onClick","ConfigSection","_a","_b","exclude","__objRest","ConnectionSettings","config","onChange","urlPlaceholder","urlTooltip","urlLabel","isValidUrl","url","maxWidth","InlineField","htmlFor","labelWidth","tooltip","grow","disabled","readOnly","required","invalid","interactive","Input","event","currentTarget","placeholder","SecretInput","isConfigured","onReset","HorizontalGroup","Button","variant","useCommonStyles","inlineFieldNoMarginRight","marginRight","inlineFieldWithSecret","flexGrow","BasicAuth","user","passwordConfigured","userTooltip","passwordTooltip","onUserChange","onPasswordChange","onPasswordReset","commonStyles","lastInlineField","ConfigSubSection","AuthMethod","AuthMethod2","defaultOptions","CrossSiteCredentials","OAuthForward","NoAuth","AuthMethodSettings","selectedMethod","mostCommonMethod","visibleMethods","visibleMethodsFromProps","extendedDefaultOptions","customMethods","onAuthMethodSelect","basicAuth","_c","_d","authMethodChanged","setAuthMethodChanged","useMemo","_a2","hasSelect","preparedOptions","customOptions","acc","method","preparedDefaultOptions","allOptions","Boolean","option","selected","AuthFieldsComponent","startsWith","find","authMethods","border","weak","selectedMethodFields","Select","getStyles","configuredStyle","height","md","SecretTextArea","useStyles2","TextArea","rows","TLSSettingsSection","enabled","tooltipText","onToggle","checkboxContainer","infoIcon","marginLeft","Checkbox","Tooltip","placement","Icon","SelfSignedCertificate","certificateConfigured","onCertificateChange","onCertificateReset","tooltips","newEnabled","certificateLabel","TLSClientAuth","serverName","clientCertificateConfigured","clientKeyConfigured","onServerNameChange","onClientCertificateChange","onClientKeyChange","onClientCertificateReset","onClientKeyReset","serverNameLabel","keyLabel","SkipTLSVerification","TLSSettings","selfSignedCertificate","TLSClientAuth$1","skipTLSVerification","CustomHeader","onBlur","onDelete","minWidth","headerNameField","paddingRight","headerValueField","removeHeaderBtn","InlineFieldRow","configured","tooltipPlacement","CustomHeaders","headers","headersFromProps","setHeaders","uniqueId","useEffect","headers2","changed","newHeaders","addHeaderButton","header2","onHeaderChange","findIndex","splice","onHeaderDelete","icon","fill","Auth","TLS","customHeaders","headerNamePrefix","headerValuePrefix","getSelectedMethod","withCredentials","jsonData","oauthPassThru","getOnAuthMethodSelectHandler","getBasicAuthProps","basicAuthUser","secureJsonFields","basicAuthPassword","password","secureJsonData","getTLSProps","tlsAuthWithCACert","tlsCACert","certificate","tlsAuth","tlsClientCert","tlsClientKey","clientCertificate","clientKey","tlsSkipVerify","getCustomHeaders","newJsonData","fromEntries","entries","newSecureJsonData","newSecureJsonFields","AdvancedHttpSettings","TagsInput","tags","keepCookies","cookies","Divider","hr","horizontalDivider","borderTop","_typeof","_getPrototypeOf","setPrototypeOf","getPrototypeOf","__proto__","_setPrototypeOf","_isNativeReflectConstruct","Reflect","construct","sham","Proxy","_construct","Parent","Class","instance","_wrapNativeSuper","Map","TypeError","has","Wrapper","_toConsumableArray","_arrayLikeToArray","_arrayWithoutHoles","iter","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","minLen","len","arr2","hasOwnProp","NewError","_Error","subClass","superClass","_inherits","Derived","hasNativeReflectConstruct","_super","Super","NewTarget","ReferenceError","_assertThisInitialized","_possibleConstructorReturn","_this","Constructor","_classCallCheck","avoidNew","JSONPath","opts","otherTypeCallback","optObj","json","resultType","wrap","sandbox","preventEval","parent","parentProperty","autostart","ret","_this2","currParent","currParentProperty","currResultType","currPreventEval","currSandbox","currOtherTypeCallback","toPathString","exprList","toPathArray","_hasParentSelector","_trace","ea","isParentSelector","hasArrExpr","rslt","valOrPath","_getPreferredOutput","pointer","toPointer","_handleCallback","fullRetObj","preferredOutput","parentPropName","literalPriority","retObj","_this3","loc","addRet","elems","_walk","_x","par","pr","cb","_slice","_eval","addType","valueType","locProp","_step","_iterator","allowArrayLike","normalCompletion","didErr","return","_createForOfIteratorHelper","rett","tmp","tl","tt","_v","_vname","_$_parentProperty","_$_parent","_$_property","_$_path","_$_root","_$_v","vm","runInNewContext","cache","pathArr","subx","$0","$1","ups","funcs","conditionCb","il","moveToAnotherArray","vr","funcString","fString","lastStatementEnd","ExperimentalEditor","query","onRunQuery","editorContext","experimentalGroupByField","groupByField","experimentalMetricField","metricField","experimentalVariableTextField","variableTextField","experimentalVariableValueField","variableValueField","fieldNames","fields","field","language","pathArray","jsonPath","InfoBox","severity","style","whiteSpace","isClearable","JsonataQueryField","plugins","BracesPlugin","SlatePrism","onlyIn","getSyntax","QueryField","additionalPlugins","portalOrigin","jp","onSuggest","onData","emptyResult","suggestions","selectedLines","document","getTextsAtRange","selection","currentLine","first","getText","toCursor","anchor","enterBrackets","items","documentation","insertText","move","JsonPathQueryField","cleanText","onTypeahead","FieldEditor","onComplete","onChangePath","onChangeType","onAliasChange","addField","removeField","div","windowObject","cancelFrame","requestFrame","clearTimeoutFn","setTimeoutFn","cancelAnimationFrameFn","cancelAnimationFrame","mozCancelAnimationFrame","webkitCancelAnimationFrame","requestAnimationFrameFn","requestAnimationFrame","mozRequestAnimationFrame","webkitRequestAnimationFrame","animationFrameID","timeoutID","AutoSizer","Component","super","state","defaultHeight","scaledHeight","scaledWidth","defaultWidth","_autoSizer","_detectElementResize","_parentNode","_resizeObserver","_timeoutId","_onResize","disableHeight","disableWidth","onResize","_style$paddingLeft","_style$paddingRight","_style$paddingTop","_style$paddingBottom","getComputedStyle","paddingLeft","paddingTop","paddingBottom","rect","getBoundingClientRect","offsetHeight","offsetWidth","setState","_setRef","autoSizer","componentDidMount","nonce","parentNode","ownerDocument","defaultView","HTMLElement","ResizeObserver","observe","animationKeyframes","animationName","animationStartEvent","animationStyle","checkTriggers","resetTriggers","scrollListener","attachEvent","element","triggers","__resizeTriggers__","expand","firstElementChild","contract","lastElementChild","expandChild","scrollLeft","scrollWidth","scrollTop","scrollHeight","__resizeLast__","__resizeRAF__","__resizeListeners__","animation","keyframeprefix","domPrefixes","startEvents","pfx","elm","createElement","addResizeListener","doc","elementStyle","getElementById","head","getElementsByTagName","setAttribute","styleSheet","cssText","appendChild","createTextNode","createStyles","expandTrigger","contractTrigger","addEventListener","__animationListener__","removeResizeListener","detachEvent","removeEventListener","removeChild","createDetectElementResize","componentWillUnmount","disconnect","render","tagName","outerStyle","overflow","childParams","bailoutOnChildren","ref","defaultQuery","cacheDurationSeconds","queryParams","urlPath","KeyValueEditor","columns","addRowLabel","useTheme","addRow","table","thead","tr","row","th","tbody","rowIdx","cell","colIdx","td","idx","updateCell","xs","bg2","sm","radius","removeRow","stylesFactory","formInputBorder","textSemiWeak","weight","formInputBg","PathEditor","onMethodChange","onPathChange","sensitiveHeaders","TabbedQueryEditor","fieldsTab","experimentalTab","bodyType","setBodyType","tabIndex","setTabIndex","q","onBodyChange","tabs","RadioButtonGroup","CodeEditor","showMiniMap","showLineNumbers","tab","Segment","formatCacheTimeLabel","QueryEditor","limitFields","datasource","metadataRequest","Api","paramsData","_request","toPromise","cacheKey","baseUrl","search","lastCacheDuration","cachedItem","recordHeaders","req","getBackendSrv","fetch","URLSearchParams","detectFieldType","every","FieldType","moment","JsonDataSource","DataSourceApi","requestJson","request","app","CoreApp","Dashboard","PanelViewer","targets","reportInteraction","trackRequest","promises","hide","flatMap","doRequest","scopedVars","all","frames","labelField","valueField","defaultErrorMessage","api","status","statusText","replaceWithVars","getTemplateSrv","getVariables","getVariable","globalVariables","to","arrayResult","ArrayVector","propertyType","typedValues","dayjs","parseValues","fieldLengths","Set","groupBy","toDataFrame","refId","displayNameFromDS","interpolate","interpolateKeyValue","cachedGet","instanceSettings","annotations","API","replaceMacros","fieldName","toArray","groupByValue","plugin","DataSourcePlugin","setConfigEditor","onOptionsChange","convertLegacyAuthProps","Field","spellCheck","setQueryEditor","setVariableQueryEditor","newQuery"],"sourceRoot":""}